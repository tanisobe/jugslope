function Game_Temp(){this.initialize.apply(this,arguments)}function Game_System(){this.initialize.apply(this,arguments)}function Game_Timer(){this.initialize.apply(this,arguments)}function Game_Message(){this.initialize.apply(this,arguments)}function Game_Switches(){this.initialize.apply(this,arguments)}function Game_Variables(){this.initialize.apply(this,arguments)}function Game_SelfSwitches(){this.initialize.apply(this,arguments)}function Game_Screen(){this.initialize.apply(this,arguments)}function Game_Picture(){this.initialize.apply(this,arguments)}function Game_Item(){this.initialize.apply(this,arguments)}function Game_Action(){this.initialize.apply(this,arguments)}function Game_ActionResult(){this.initialize.apply(this,arguments)}function Game_BattlerBase(){this.initialize.apply(this,arguments)}function Game_Battler(){this.initialize.apply(this,arguments)}function Game_Actor(){this.initialize.apply(this,arguments)}function Game_Enemy(){this.initialize.apply(this,arguments)}function Game_Actors(){this.initialize.apply(this,arguments)}function Game_Unit(){this.initialize.apply(this,arguments)}function Game_Party(){this.initialize.apply(this,arguments)}function Game_Troop(){this.initialize.apply(this,arguments)}function Game_Map(){this.initialize.apply(this,arguments)}function Game_CommonEvent(){this.initialize.apply(this,arguments)}function Game_CharacterBase(){this.initialize.apply(this,arguments)}function Game_Character(){this.initialize.apply(this,arguments)}function Game_Player(){this.initialize.apply(this,arguments)}function Game_Follower(){this.initialize.apply(this,arguments)}function Game_Followers(){this.initialize.apply(this,arguments)}function Game_Vehicle(){this.initialize.apply(this,arguments)}function Game_Event(){this.initialize.apply(this,arguments)}function Game_Interpreter(){this.initialize.apply(this,arguments)}Game_Temp.prototype.initialize=function(){this._isPlaytest=Utils.isOptionValid("test"),this._commonEventId=0,this._destinationX=null,this._destinationY=null},Game_Temp.prototype.isPlaytest=function(){return this._isPlaytest},Game_Temp.prototype.reserveCommonEvent=function(a){this._commonEventId=a},Game_Temp.prototype.clearCommonEvent=function(){this._commonEventId=0},Game_Temp.prototype.isCommonEventReserved=function(){return this._commonEventId>0},Game_Temp.prototype.reservedCommonEvent=function(){return $dataCommonEvents[this._commonEventId]},Game_Temp.prototype.setDestination=function(a,b){this._destinationX=a,this._destinationY=b},Game_Temp.prototype.clearDestination=function(){this._destinationX=null,this._destinationY=null},Game_Temp.prototype.isDestinationValid=function(){return null!==this._destinationX},Game_Temp.prototype.destinationX=function(){return this._destinationX},Game_Temp.prototype.destinationY=function(){return this._destinationY},Game_System.prototype.initialize=function(){this._saveEnabled=!0,this._menuEnabled=!0,this._encounterEnabled=!0,this._formationEnabled=!0,this._battleCount=0,this._winCount=0,this._escapeCount=0,this._saveCount=0,this._versionId=0,this._framesOnSave=0,this._bgmOnSave=null,this._bgsOnSave=null,this._windowTone=null,this._battleBgm=null,this._victoryMe=null,this._defeatMe=null,this._savedBgm=null,this._walkingBgm=null},Game_System.prototype.isJapanese=function(){return $dataSystem.locale.match(/^ja/)},Game_System.prototype.isChinese=function(){return $dataSystem.locale.match(/^zh/)},Game_System.prototype.isKorean=function(){return $dataSystem.locale.match(/^ko/)},Game_System.prototype.isCJK=function(){return $dataSystem.locale.match(/^(ja|zh|ko)/)},Game_System.prototype.isRussian=function(){return $dataSystem.locale.match(/^ru/)},Game_System.prototype.isSideView=function(){return $dataSystem.optSideView},Game_System.prototype.isSaveEnabled=function(){return this._saveEnabled},Game_System.prototype.disableSave=function(){this._saveEnabled=!1},Game_System.prototype.enableSave=function(){this._saveEnabled=!0},Game_System.prototype.isMenuEnabled=function(){return this._menuEnabled},Game_System.prototype.disableMenu=function(){this._menuEnabled=!1},Game_System.prototype.enableMenu=function(){this._menuEnabled=!0},Game_System.prototype.isEncounterEnabled=function(){return this._encounterEnabled},Game_System.prototype.disableEncounter=function(){this._encounterEnabled=!1},Game_System.prototype.enableEncounter=function(){this._encounterEnabled=!0},Game_System.prototype.isFormationEnabled=function(){return this._formationEnabled},Game_System.prototype.disableFormation=function(){this._formationEnabled=!1},Game_System.prototype.enableFormation=function(){this._formationEnabled=!0},Game_System.prototype.battleCount=function(){return this._battleCount},Game_System.prototype.winCount=function(){return this._winCount},Game_System.prototype.escapeCount=function(){return this._escapeCount},Game_System.prototype.saveCount=function(){return this._saveCount},Game_System.prototype.versionId=function(){return this._versionId},Game_System.prototype.windowTone=function(){return this._windowTone||$dataSystem.windowTone},Game_System.prototype.setWindowTone=function(a){this._windowTone=a},Game_System.prototype.battleBgm=function(){return this._battleBgm||$dataSystem.battleBgm},Game_System.prototype.setBattleBgm=function(a){this._battleBgm=a},Game_System.prototype.victoryMe=function(){return this._victoryMe||$dataSystem.victoryMe},Game_System.prototype.setVictoryMe=function(a){this._victoryMe=a},Game_System.prototype.defeatMe=function(){return this._defeatMe||$dataSystem.defeatMe},Game_System.prototype.setDefeatMe=function(a){this._defeatMe=a},Game_System.prototype.onBattleStart=function(){this._battleCount++},Game_System.prototype.onBattleWin=function(){this._winCount++},Game_System.prototype.onBattleEscape=function(){this._escapeCount++},Game_System.prototype.onBeforeSave=function(){this._saveCount++,this._versionId=$dataSystem.versionId,this._framesOnSave=Graphics.frameCount,this._bgmOnSave=AudioManager.saveBgm(),this._bgsOnSave=AudioManager.saveBgs()},Game_System.prototype.onAfterLoad=function(){Graphics.frameCount=this._framesOnSave,AudioManager.playBgm(this._bgmOnSave),AudioManager.playBgs(this._bgsOnSave)},Game_System.prototype.playtime=function(){return Math.floor(Graphics.frameCount/60)},Game_System.prototype.playtimeText=function(){var a=Math.floor(this.playtime()/60/60),b=Math.floor(this.playtime()/60)%60,c=this.playtime()%60;return a.padZero(2)+":"+b.padZero(2)+":"+c.padZero(2)},Game_System.prototype.saveBgm=function(){this._savedBgm=AudioManager.saveBgm()},Game_System.prototype.replayBgm=function(){this._savedBgm&&AudioManager.replayBgm(this._savedBgm)},Game_System.prototype.saveWalkingBgm=function(){this._walkingBgm=AudioManager.saveBgm()},Game_System.prototype.replayWalkingBgm=function(){this._walkingBgm&&AudioManager.playBgm(this._walkingBgm)},Game_Timer.prototype.initialize=function(){this._frames=0,this._working=!1},Game_Timer.prototype.update=function(a){a&&this._working&&this._frames>0&&(this._frames--,0===this._frames&&this.onExpire())},Game_Timer.prototype.start=function(a){this._frames=a,this._working=!0},Game_Timer.prototype.stop=function(){this._working=!1},Game_Timer.prototype.isWorking=function(){return this._working},Game_Timer.prototype.seconds=function(){return Math.floor(this._frames/60)},Game_Timer.prototype.onExpire=function(){BattleManager.abort()},Game_Message.prototype.initialize=function(){this.clear()},Game_Message.prototype.clear=function(){this._texts=[],this._choices=[],this._faceName="",this._faceIndex=0,this._background=0,this._positionType=2,this._choiceDefaultType=0,this._choiceCancelType=0,this._choiceBackground=0,this._choicePositionType=2,this._numInputVariableId=0,this._numInputMaxDigits=0,this._itemChoiceVariableId=0,this._itemChoiceItypeId=0,this._scrollMode=!1,this._scrollSpeed=2,this._scrollNoFast=!1,this._choiceCallback=null},Game_Message.prototype.choices=function(){return this._choices},Game_Message.prototype.faceName=function(){return this._faceName},Game_Message.prototype.faceIndex=function(){return this._faceIndex},Game_Message.prototype.background=function(){return this._background},Game_Message.prototype.positionType=function(){return this._positionType},Game_Message.prototype.choiceDefaultType=function(){return this._choiceDefaultType},Game_Message.prototype.choiceCancelType=function(){return this._choiceCancelType},Game_Message.prototype.choiceBackground=function(){return this._choiceBackground},Game_Message.prototype.choicePositionType=function(){return this._choicePositionType},Game_Message.prototype.numInputVariableId=function(){return this._numInputVariableId},Game_Message.prototype.numInputMaxDigits=function(){return this._numInputMaxDigits},Game_Message.prototype.itemChoiceVariableId=function(){return this._itemChoiceVariableId},Game_Message.prototype.itemChoiceItypeId=function(){return this._itemChoiceItypeId},Game_Message.prototype.scrollMode=function(){return this._scrollMode},Game_Message.prototype.scrollSpeed=function(){return this._scrollSpeed},Game_Message.prototype.scrollNoFast=function(){return this._scrollNoFast},Game_Message.prototype.add=function(a){this._texts.push(a)},Game_Message.prototype.setFaceImage=function(a,b){this._faceName=a,this._faceIndex=b},Game_Message.prototype.setBackground=function(a){this._background=a},Game_Message.prototype.setPositionType=function(a){this._positionType=a},Game_Message.prototype.setChoices=function(a,b,c){this._choices=a,this._choiceDefaultType=b,this._choiceCancelType=c},Game_Message.prototype.setChoiceBackground=function(a){this._choiceBackground=a},Game_Message.prototype.setChoicePositionType=function(a){this._choicePositionType=a},Game_Message.prototype.setNumberInput=function(a,b){this._numInputVariableId=a,this._numInputMaxDigits=b},Game_Message.prototype.setItemChoice=function(a,b){this._itemChoiceVariableId=a,this._itemChoiceItypeId=b},Game_Message.prototype.setScroll=function(a,b){this._scrollMode=!0,this._scrollSpeed=a,this._scrollNoFast=b},Game_Message.prototype.setChoiceCallback=function(a){this._choiceCallback=a},Game_Message.prototype.onChoice=function(a){this._choiceCallback&&(this._choiceCallback(a),this._choiceCallback=null)},Game_Message.prototype.hasText=function(){return this._texts.length>0},Game_Message.prototype.isChoice=function(){return this._choices.length>0},Game_Message.prototype.isNumberInput=function(){return this._numInputVariableId>0},Game_Message.prototype.isItemChoice=function(){return this._itemChoiceVariableId>0},Game_Message.prototype.isBusy=function(){return this.hasText()||this.isChoice()||this.isNumberInput()||this.isItemChoice()},Game_Message.prototype.newPage=function(){this._texts.length>0&&(this._texts[this._texts.length-1]+="\f")},Game_Message.prototype.allText=function(){return this._texts.reduce(function(a,b){return a+"\n"+b})},Game_Switches.prototype.initialize=function(){this.clear()},Game_Switches.prototype.clear=function(){this._data=[]},Game_Switches.prototype.value=function(a){return!!this._data[a]},Game_Switches.prototype.setValue=function(a,b){a>0&&a<$dataSystem.switches.length&&(this._data[a]=b,this.onChange())},Game_Switches.prototype.onChange=function(){$gameMap.requestRefresh()},Game_Variables.prototype.initialize=function(){this.clear()},Game_Variables.prototype.clear=function(){this._data=[]},Game_Variables.prototype.value=function(a){return this._data[a]||0},Game_Variables.prototype.setValue=function(a,b){a>0&&a<$dataSystem.variables.length&&("number"==typeof b&&(b=Math.floor(b)),this._data[a]=b,this.onChange())},Game_Variables.prototype.onChange=function(){$gameMap.requestRefresh()},Game_SelfSwitches.prototype.initialize=function(){this.clear()},Game_SelfSwitches.prototype.clear=function(){this._data={}},Game_SelfSwitches.prototype.value=function(a){return!!this._data[a]},Game_SelfSwitches.prototype.setValue=function(a,b){b?this._data[a]=!0:delete this._data[a],this.onChange()},Game_SelfSwitches.prototype.onChange=function(){$gameMap.requestRefresh()},Game_Screen.prototype.initialize=function(){this.clear()},Game_Screen.prototype.clear=function(){this.clearFade(),this.clearTone(),this.clearFlash(),this.clearShake(),this.clearZoom(),this.clearWeather(),this.clearPictures()},Game_Screen.prototype.onBattleStart=function(){this.clearFade(),this.clearFlash(),this.clearShake(),this.clearZoom(),this.eraseBattlePictures()},Game_Screen.prototype.brightness=function(){return this._brightness},Game_Screen.prototype.tone=function(){return this._tone},Game_Screen.prototype.flashColor=function(){return this._flashColor},Game_Screen.prototype.shake=function(){return this._shake},Game_Screen.prototype.zoomX=function(){return this._zoomX},Game_Screen.prototype.zoomY=function(){return this._zoomY},Game_Screen.prototype.zoomScale=function(){return this._zoomScale},Game_Screen.prototype.weatherType=function(){return this._weatherType},Game_Screen.prototype.weatherPower=function(){return this._weatherPower},Game_Screen.prototype.picture=function(a){var b=this.realPictureId(a);return this._pictures[b]},Game_Screen.prototype.realPictureId=function(a){return $gameParty.inBattle()?a+this.maxPictures():a},Game_Screen.prototype.clearFade=function(){this._brightness=255,this._fadeOutDuration=0,this._fadeInDuration=0},Game_Screen.prototype.clearTone=function(){this._tone=[0,0,0,0],this._toneTarget=[0,0,0,0],this._toneDuration=0},Game_Screen.prototype.clearFlash=function(){this._flashColor=[0,0,0,0],this._flashDuration=0},Game_Screen.prototype.clearShake=function(){this._shakePower=0,this._shakeSpeed=0,this._shakeDuration=0,this._shakeDirection=1,this._shake=0},Game_Screen.prototype.clearZoom=function(){this._zoomX=0,this._zoomY=0,this._zoomScale=1,this._zoomScaleTarget=1,this._zoomDuration=0},Game_Screen.prototype.clearWeather=function(){this._weatherType="none",this._weatherPower=0,this._weatherPowerTarget=0,this._weatherDuration=0},Game_Screen.prototype.clearPictures=function(){this._pictures=[]},Game_Screen.prototype.eraseBattlePictures=function(){this._pictures=this._pictures.slice(0,this.maxPictures()+1)},Game_Screen.prototype.maxPictures=function(){return 100},Game_Screen.prototype.startFadeOut=function(a){this._fadeOutDuration=a,this._fadeInDuration=0},Game_Screen.prototype.startFadeIn=function(a){this._fadeInDuration=a,this._fadeOutDuration=0},Game_Screen.prototype.startTint=function(a,b){this._toneTarget=a.clone(),this._toneDuration=b,0===this._toneDuration&&(this._tone=this._toneTarget.clone())},Game_Screen.prototype.startFlash=function(a,b){this._flashColor=a.clone(),this._flashDuration=b},Game_Screen.prototype.startShake=function(a,b,c){this._shakePower=a,this._shakeSpeed=b,this._shakeDuration=c},Game_Screen.prototype.startZoom=function(a,b,c,d){this._zoomX=a,this._zoomY=b,this._zoomScaleTarget=c,this._zoomDuration=d},Game_Screen.prototype.setZoom=function(a,b,c){this._zoomX=a,this._zoomY=b,this._zoomScale=c},Game_Screen.prototype.changeWeather=function(a,b,c){("none"!==a||0===c)&&(this._weatherType=a),this._weatherPowerTarget="none"===a?0:b,this._weatherDuration=c,0===c&&(this._weatherPower=this._weatherPowerTarget)},Game_Screen.prototype.update=function(){this.updateFadeOut(),this.updateFadeIn(),this.updateTone(),this.updateFlash(),this.updateShake(),this.updateZoom(),this.updateWeather(),this.updatePictures()},Game_Screen.prototype.updateFadeOut=function(){if(this._fadeOutDuration>0){var a=this._fadeOutDuration;this._brightness=this._brightness*(a-1)/a,this._fadeOutDuration--}},Game_Screen.prototype.updateFadeIn=function(){if(this._fadeInDuration>0){var a=this._fadeInDuration;this._brightness=(this._brightness*(a-1)+255)/a,this._fadeInDuration--}},Game_Screen.prototype.updateTone=function(){if(this._toneDuration>0){for(var a=this._toneDuration,b=0;4>b;b++)this._tone[b]=(this._tone[b]*(a-1)+this._toneTarget[b])/a;this._toneDuration--}},Game_Screen.prototype.updateFlash=function(){if(this._flashDuration>0){var a=this._flashDuration;this._flashColor[3]*=(a-1)/a,this._flashDuration--}},Game_Screen.prototype.updateShake=function(){if(this._shakeDuration>0||0!==this._shake){var a=this._shakePower*this._shakeSpeed*this._shakeDirection/10;this._shakeDuration<=1&&this._shake*(this._shake+a)<0?this._shake=0:this._shake+=a,this._shake>2*this._shakePower&&(this._shakeDirection=-1),this._shake<2*-this._shakePower&&(this._shakeDirection=1),this._shakeDuration--}},Game_Screen.prototype.updateZoom=function(){if(this._zoomDuration>0){var a=this._zoomDuration,b=this._zoomScaleTarget;this._zoomScale=(this._zoomScale*(a-1)+b)/a,this._zoomDuration--}},Game_Screen.prototype.updateWeather=function(){if(this._weatherDuration>0){var a=this._weatherDuration,b=this._weatherPowerTarget;this._weatherPower=(this._weatherPower*(a-1)+b)/a,this._weatherDuration--,0===this._weatherDuration&&0===this._weatherPowerTarget&&(this._weatherType="none")}},Game_Screen.prototype.updatePictures=function(){this._pictures.forEach(function(a){a&&a.update()})},Game_Screen.prototype.startFlashForDamage=function(){this.startFlash([255,0,0,128],8)},Game_Screen.prototype.showPicture=function(a,b,c,d,e,f,g,h,i){var j=this.realPictureId(a),k=new Game_Picture;k.show(b,c,d,e,f,g,h,i),this._pictures[j]=k},Game_Screen.prototype.movePicture=function(a,b,c,d,e,f,g,h,i){var j=this.picture(a);j&&j.move(b,c,d,e,f,g,h,i)},Game_Screen.prototype.rotatePicture=function(a,b){var c=this.picture(a);c&&c.rotate(b)},Game_Screen.prototype.tintPicture=function(a,b,c){var d=this.picture(a);d&&d.tint(b,c)},Game_Screen.prototype.erasePicture=function(a){var b=this.realPictureId(a);this._pictures[b]=null},Game_Picture.prototype.initialize=function(){this.initBasic(),this.initTarget(),this.initTone(),this.initRotation()},Game_Picture.prototype.name=function(){return this._name},Game_Picture.prototype.origin=function(){return this._origin},Game_Picture.prototype.x=function(){return this._x},Game_Picture.prototype.y=function(){return this._y},Game_Picture.prototype.scaleX=function(){return this._scaleX},Game_Picture.prototype.scaleY=function(){return this._scaleY},Game_Picture.prototype.opacity=function(){return this._opacity},Game_Picture.prototype.blendMode=function(){return this._blendMode},Game_Picture.prototype.tone=function(){return this._tone},Game_Picture.prototype.angle=function(){return this._angle},Game_Picture.prototype.initBasic=function(){this._name="",this._origin=0,this._x=0,this._y=0,this._scaleX=100,this._scaleY=100,this._opacity=255,this._blendMode=0},Game_Picture.prototype.initTarget=function(){this._targetX=this._x,this._targetY=this._y,this._targetScaleX=this._scaleX,this._targetScaleY=this._scaleY,this._targetOpacity=this._opacity,this._duration=0},Game_Picture.prototype.initTone=function(){this._tone=null,this._toneTarget=null,this._toneDuration=0},Game_Picture.prototype.initRotation=function(){this._angle=0,this._rotationSpeed=0},Game_Picture.prototype.show=function(a,b,c,d,e,f,g,h){this._name=a,this._origin=b,this._x=c,this._y=d,this._scaleX=e,this._scaleY=f,this._opacity=g,this._blendMode=h,this.initTarget(),this.initTone(),this.initRotation()},Game_Picture.prototype.move=function(a,b,c,d,e,f,g,h){this._origin=a,this._targetX=b,this._targetY=c,this._targetScaleX=d,this._targetScaleY=e,this._targetOpacity=f,this._blendMode=g,this._duration=h},Game_Picture.prototype.rotate=function(a){this._rotationSpeed=a},Game_Picture.prototype.tint=function(a,b){this._tone||(this._tone=[0,0,0,0]),this._toneTarget=a.clone(),this._toneDuration=b,0===this._toneDuration&&(this._tone=this._toneTarget.clone())},Game_Picture.prototype.erase=function(){this._name="",this._origin=0,this.initTarget(),this.initTone(),this.initRotation()},Game_Picture.prototype.update=function(){this.updateMove(),this.updateTone(),this.updateRotation()},Game_Picture.prototype.updateMove=function(){if(this._duration>0){var a=this._duration;this._x=(this._x*(a-1)+this._targetX)/a,this._y=(this._y*(a-1)+this._targetY)/a,this._scaleX=(this._scaleX*(a-1)+this._targetScaleX)/a,this._scaleY=(this._scaleY*(a-1)+this._targetScaleY)/a,this._opacity=(this._opacity*(a-1)+this._targetOpacity)/a,this._duration--}},Game_Picture.prototype.updateTone=function(){if(this._toneDuration>0){for(var a=this._toneDuration,b=0;4>b;b++)this._tone[b]=(this._tone[b]*(a-1)+this._toneTarget[b])/a;this._toneDuration--}},Game_Picture.prototype.updateRotation=function(){this._rotationSpeed>0&&(this._angle+=this._rotationSpeed/2)},Game_Item.prototype.initialize=function(a){this._dataClass="",this._itemId=0,a&&this.setObject(a)},Game_Item.prototype.isSkill=function(){return"skill"===this._dataClass},Game_Item.prototype.isItem=function(){return"item"===this._dataClass},Game_Item.prototype.isUsableItem=function(){return this.isSkill()||this.isItem()},Game_Item.prototype.isWeapon=function(){return"weapon"===this._dataClass},Game_Item.prototype.isArmor=function(){return"armor"===this._dataClass},Game_Item.prototype.isEquipItem=function(){return this.isWeapon()||this.isArmor()},Game_Item.prototype.isNull=function(){return""===this._dataClass},Game_Item.prototype.itemId=function(){return this._itemId},Game_Item.prototype.object=function(){return this.isSkill()?$dataSkills[this._itemId]:this.isItem()?$dataItems[this._itemId]:this.isWeapon()?$dataWeapons[this._itemId]:this.isArmor()?$dataArmors[this._itemId]:null},Game_Item.prototype.setObject=function(a){DataManager.isSkill(a)?this._dataClass="skill":DataManager.isItem(a)?this._dataClass="item":DataManager.isWeapon(a)?this._dataClass="weapon":DataManager.isArmor(a)?this._dataClass="armor":this._dataClass="",this._itemId=a?a.id:0},Game_Item.prototype.setEquip=function(a,b){this._dataClass=a?"weapon":"armor",this._itemId=b},Game_Action.EFFECT_RECOVER_HP=11,Game_Action.EFFECT_RECOVER_MP=12,Game_Action.EFFECT_GAIN_TP=13,Game_Action.EFFECT_ADD_STATE=21,Game_Action.EFFECT_REMOVE_STATE=22,Game_Action.EFFECT_ADD_BUFF=31,Game_Action.EFFECT_ADD_DEBUFF=32,Game_Action.EFFECT_REMOVE_BUFF=33,Game_Action.EFFECT_REMOVE_DEBUFF=34,Game_Action.EFFECT_SPECIAL=41,Game_Action.EFFECT_GROW=42,Game_Action.EFFECT_LEARN_SKILL=43,Game_Action.EFFECT_COMMON_EVENT=44,Game_Action.SPECIAL_EFFECT_ESCAPE=0,Game_Action.HITTYPE_CERTAIN=0,Game_Action.HITTYPE_PHYSICAL=1,Game_Action.HITTYPE_MAGICAL=2,Game_Action.prototype.initialize=function(a,b){this._subjectActorId=0,this._subjectEnemyIndex=-1,this._forcing=b||!1,this.setSubject(a),this.clear()},Game_Action.prototype.clear=function(){this._item=new Game_Item,this._targetIndex=-1},Game_Action.prototype.setSubject=function(a){a.isActor()?(this._subjectActorId=a.actorId(),this._subjectEnemyIndex=-1):(this._subjectEnemyIndex=a.index(),this._subjectActorId=0)},Game_Action.prototype.subject=function(){return this._subjectActorId>0?$gameActors.actor(this._subjectActorId):$gameTroop.members()[this._subjectEnemyIndex]},Game_Action.prototype.friendsUnit=function(){return this.subject().friendsUnit()},Game_Action.prototype.opponentsUnit=function(){return this.subject().opponentsUnit()},Game_Action.prototype.setEnemyAction=function(a){a?this.setSkill(a.skillId):this.clear()},Game_Action.prototype.setAttack=function(){this.setSkill(this.subject().attackSkillId())},Game_Action.prototype.setGuard=function(){this.setSkill(this.subject().guardSkillId())},Game_Action.prototype.setSkill=function(a){this._item.setObject($dataSkills[a])},Game_Action.prototype.setItem=function(a){this._item.setObject($dataItems[a])},Game_Action.prototype.setItemObject=function(a){this._item.setObject(a)},Game_Action.prototype.setTarget=function(a){this._targetIndex=a},Game_Action.prototype.item=function(){return this._item.object()},Game_Action.prototype.isSkill=function(){return this._item.isSkill()},Game_Action.prototype.isItem=function(){return this._item.isItem()},Game_Action.prototype.numRepeats=function(){var a=this.item().repeats;return this.isAttack()&&(a+=this.subject().attackTimesAdd()),Math.floor(a)},Game_Action.prototype.checkItemScope=function(a){return a.contains(this.item().scope)},Game_Action.prototype.isForOpponent=function(){return this.checkItemScope([1,2,3,4,5,6])},Game_Action.prototype.isForFriend=function(){return this.checkItemScope([7,8,9,10,11])},Game_Action.prototype.isForDeadFriend=function(){return this.checkItemScope([9,10])},Game_Action.prototype.isForUser=function(){return this.checkItemScope([11])},Game_Action.prototype.isForOne=function(){return this.checkItemScope([1,3,7,9,11])},Game_Action.prototype.isForRandom=function(){return this.checkItemScope([3,4,5,6])},Game_Action.prototype.isForAll=function(){return this.checkItemScope([2,8,10])},Game_Action.prototype.needsSelection=function(){return this.checkItemScope([1,7,9])},Game_Action.prototype.numTargets=function(){return this.isForRandom()?this.item().scope-2:0},Game_Action.prototype.checkDamageType=function(a){return a.contains(this.item().damage.type)},Game_Action.prototype.isHpEffect=function(){return this.checkDamageType([1,3,5])},Game_Action.prototype.isMpEffect=function(){return this.checkDamageType([2,4,6])},Game_Action.prototype.isDamage=function(){return this.checkDamageType([1,2])},Game_Action.prototype.isRecover=function(){return this.checkDamageType([3,4])},Game_Action.prototype.isDrain=function(){return this.checkDamageType([5,6])},Game_Action.prototype.isHpRecover=function(){return this.checkDamageType([3])},Game_Action.prototype.isMpRecover=function(){return this.checkDamageType([4])},Game_Action.prototype.isCertainHit=function(){return this.item().hitType===Game_Action.HITTYPE_CERTAIN},Game_Action.prototype.isPhysical=function(){return this.item().hitType===Game_Action.HITTYPE_PHYSICAL},Game_Action.prototype.isMagical=function(){return this.item().hitType===Game_Action.HITTYPE_MAGICAL},Game_Action.prototype.isAttack=function(){return this.item()===$dataSkills[this.subject().attackSkillId()]},Game_Action.prototype.isGuard=function(){return this.item()===$dataSkills[this.subject().guardSkillId()]},Game_Action.prototype.isMagicSkill=function(){return this.isSkill()?$dataSystem.magicSkills.contains(this.item().stypeId):!1},Game_Action.prototype.decideRandomTarget=function(){var a;a=this.isForDeadFriend()?this.friendsUnit().randomDeadTarget():this.isForFriend()?this.friendsUnit().randomTarget():this.opponentsUnit().randomTarget(),a?this._targetIndex=a.index:this.clear()},Game_Action.prototype.setConfusion=function(){this.setAttack()},Game_Action.prototype.prepare=function(){this.subject().isConfused()&&!this._forcing&&this.setConfusion()},Game_Action.prototype.isValid=function(){return this._forcing&&this.item()||this.subject().canUse(this.item())},Game_Action.prototype.speed=function(){var a=this.subject().agi,b=a+Math.randomInt(Math.floor(5+a/4));return this.item()&&(b+=this.item().speed),this.isAttack()&&(b+=this.subject().attackSpeed()),b},Game_Action.prototype.makeTargets=function(){var a=[];return!this._forcing&&this.subject().isConfused()?a=[this.confusionTarget()]:this.isForOpponent()?a=this.targetsForOpponents():this.isForFriend()&&(a=this.targetsForFriends()),this.repeatTargets(a)},Game_Action.prototype.repeatTargets=function(a){for(var b=[],c=this.numRepeats(),d=0;d<a.length;d++){var e=a[d];if(e)for(var f=0;c>f;f++)b.push(e)}return b},Game_Action.prototype.confusionTarget=function(){switch(this.subject().confusionLevel()){case 1:return this.opponentsUnit().randomTarget();case 2:return 0===Math.randomInt(2)?this.opponentsUnit().randomTarget():this.friendsUnit().randomTarget();default:return this.friendsUnit().randomTarget()}},Game_Action.prototype.targetsForOpponents=function(){var a=[],b=this.opponentsUnit();if(this.isForRandom())for(var c=0;c<this.numTargets();c++)a.push(b.randomTarget());else this.isForOne()?this._targetIndex<0?a.push(b.randomTarget()):a.push(b.smoothTarget(this._targetIndex)):a=b.aliveMembers();return a},Game_Action.prototype.targetsForFriends=function(){var a=[],b=this.friendsUnit();return this.isForUser()?[this.subject()]:(this.isForDeadFriend()?this.isForOne()?a.push(b.smoothDeadTarget(this._targetIndex)):a=b.deadMembers():this.isForOne()?this._targetIndex<0?a.push(b.randomTarget()):a.push(b.smoothTarget(this._targetIndex)):a=b.aliveMembers(),a)},Game_Action.prototype.evaluate=function(){var a=0;return this.itemTargetCandidates().forEach(function(b){var c=this.evaluateWithTarget(b);this.isForAll()?a+=c:c>a&&(a=c,this._targetIndex=b.index)},this),a*=this.numRepeats(),a>0&&(a+=Math.random()),a},Game_Action.prototype.itemTargetCandidates=function(){return this.isValid()?this.isForOpponent()?this.opponentsUnit().aliveMembers():this.isForUser()?[this.subject()]:this.isForDeadFriend()?this.friendsUnit().deadMembers():this.friendsUnit().aliveMembers():[]},Game_Action.prototype.evaluateWithTarget=function(a){if(this.isHpEffect()){var b=this.makeDamageValue(a,!1);if(this.isForOpponent())return b/Math.max(a.hp,1);var c=Math.min(-b,a.mhp-a.hp);return c/a.mhp}},Game_Action.prototype.testApply=function(a){return this.isForDeadFriend()===a.isDead()&&($gameParty.inBattle()||this.isForOpponent()||this.isHpRecover()&&a.hp<a.mhp||this.isMpRecover()&&a.mp<a.mmp||this.hasItemAnyValidEffects(a))},Game_Action.prototype.hasItemAnyValidEffects=function(a){return this.item().effects.some(function(b){return this.testItemEffect(a,b)},this)},Game_Action.prototype.testItemEffect=function(a,b){switch(b.code){case Game_Action.EFFECT_RECOVER_HP:return a.hp<a.mhp||b.value1<0||b.value2<0;case Game_Action.EFFECT_RECOVER_MP:return a.mp<a.mmp||b.value1<0||b.value2<0;case Game_Action.EFFECT_ADD_STATE:return!a.isStateAffected(b.dataId);case Game_Action.EFFECT_REMOVE_STATE:return a.isStateAffected(b.dataId);case Game_Action.EFFECT_ADD_BUFF:return!a.isMaxBuffAffected(b.dataId);case Game_Action.EFFECT_ADD_DEBUFF:return!a.isMaxDebuffAffected(b.dataId);case Game_Action.EFFECT_REMOVE_BUFF:return a.isBuffAffected(b.dataId);case Game_Action.EFFECT_REMOVE_DEBUFF:return a.isDebuffAffected(b.dataId);case Game_Action.EFFECT_LEARN_SKILL:return a.isActor()&&!a.isLearnedSkill(b.dataId);default:return!0}},Game_Action.prototype.itemCnt=function(a){return this.isPhysical()&&a.canMove()?a.cnt:0},Game_Action.prototype.itemMrf=function(a){return this.isMagical()?a.mrf:0},Game_Action.prototype.itemHit=function(a){return this.isPhysical()?.01*this.item().successRate*this.subject().hit:.01*this.item().successRate},Game_Action.prototype.itemEva=function(a){return this.isPhysical()?a.eva:this.isMagical()?a.mev:0},Game_Action.prototype.itemCri=function(a){return this.item().damage.critical?this.subject().cri*(1-a.cev):0},Game_Action.prototype.apply=function(a){var b=a.result();if(this.subject().clearResult(),b.clear(),b.used=this.testApply(a),b.missed=b.used&&Math.random()>=this.itemHit(a),b.evaded=!b.missed&&Math.random()<this.itemEva(a),b.physical=this.isPhysical(),b.drain=this.isDrain(),b.isHit()){if(this.item().damage.type>0){b.critical=Math.random()<this.itemCri(a);var c=this.makeDamageValue(a,b.critical);this.executeDamage(a,c)}this.item().effects.forEach(function(b){this.applyItemEffect(a,b)},this),this.applyItemUserEffect(a)}},Game_Action.prototype.makeDamageValue=function(a,b){var c=this.item(),d=this.evalDamageFormula(a),e=d*this.calcElementRate(a);return this.isPhysical()&&(e*=a.pdr),this.isMagical()&&(e*=a.mdr),0>d&&(e*=a.rec),b&&(e=this.applyCritical(e)),e=this.applyVariance(e,c.damage.variance),e=this.applyGuard(e,a),e=Math.round(e)},Game_Action.prototype.evalDamageFormula=function(target){try{var item=this.item(),a=this.subject(),b=target,v=$gameVariables._data,sign=[3,4].contains(item.damage.type)?-1:1;return Math.max(eval(item.damage.formula),0)*sign}catch(e){return 0}},Game_Action.prototype.calcElementRate=function(a){return this.item().damage.elementId<0?this.elementsMaxRate(a,this.subject().attackElements()):a.elementRate(this.item().damage.elementId)},Game_Action.prototype.elementsMaxRate=function(a,b){return b.length>0?Math.max.apply(null,b.map(function(b){return a.elementRate(b)},this)):1},Game_Action.prototype.applyCritical=function(a){return 3*a},Game_Action.prototype.applyVariance=function(a,b){
var c=Math.floor(Math.max(Math.abs(a)*b/100,0)),d=Math.randomInt(c+1)+Math.randomInt(c+1)-c;return a>=0?a+d:a-d},Game_Action.prototype.applyGuard=function(a,b){return a/(a>0&&b.isGuard()?2*b.grd:1)},Game_Action.prototype.executeDamage=function(a,b){var c=a.result();0===b&&(c.critical=!1),this.isHpEffect()&&this.executeHpDamage(a,b),this.isMpEffect()&&this.executeMpDamage(a,b)},Game_Action.prototype.executeHpDamage=function(a,b){this.isDrain()&&(b=Math.min(a.hp,b)),this.makeSuccess(a),a.gainHp(-b),b>0&&a.onDamage(b),this.gainDrainedHp(b)},Game_Action.prototype.executeMpDamage=function(a,b){this.isMpRecover()||(b=Math.min(a.mp,b)),0!==b&&this.makeSuccess(a),a.gainMp(-b),this.gainDrainedMp(b)},Game_Action.prototype.gainDrainedHp=function(a){this.isDrain()&&this.subject().gainHp(a)},Game_Action.prototype.gainDrainedMp=function(a){this.isDrain()&&this.subject().gainMp(a)},Game_Action.prototype.applyItemEffect=function(a,b){switch(b.code){case Game_Action.EFFECT_RECOVER_HP:this.itemEffectRecoverHp(a,b);break;case Game_Action.EFFECT_RECOVER_MP:this.itemEffectRecoverMp(a,b);break;case Game_Action.EFFECT_GAIN_TP:this.itemEffectGainTp(a,b);break;case Game_Action.EFFECT_ADD_STATE:this.itemEffectAddState(a,b);break;case Game_Action.EFFECT_REMOVE_STATE:this.itemEffectRemoveState(a,b);break;case Game_Action.EFFECT_ADD_BUFF:this.itemEffectAddBuff(a,b);break;case Game_Action.EFFECT_ADD_DEBUFF:this.itemEffectAddDebuff(a,b);break;case Game_Action.EFFECT_REMOVE_BUFF:this.itemEffectRemoveBuff(a,b);break;case Game_Action.EFFECT_REMOVE_DEBUFF:this.itemEffectRemoveDebuff(a,b);break;case Game_Action.EFFECT_SPECIAL:this.itemEffectSpecial(a,b);break;case Game_Action.EFFECT_GROW:this.itemEffectGrow(a,b);break;case Game_Action.EFFECT_LEARN_SKILL:this.itemEffectLearnSkill(a,b);break;case Game_Action.EFFECT_COMMON_EVENT:this.itemEffectCommonEvent(a,b)}},Game_Action.prototype.itemEffectRecoverHp=function(a,b){var c=(a.mhp*b.value1+b.value2)*a.rec;this.isItem()&&(c*=this.subject().pha),c=Math.floor(c),0!==c&&(a.gainHp(c),this.makeSuccess(a))},Game_Action.prototype.itemEffectRecoverMp=function(a,b){var c=(a.mmp*b.value1+b.value2)*a.rec;this.isItem()&&(c*=this.subject().pha),c=Math.floor(c),0!==c&&(a.gainMp(c),this.makeSuccess(a))},Game_Action.prototype.itemEffectGainTp=function(a,b){var c=Math.floor(b.value1);0!==c&&(a.gainTp(c),this.makeSuccess(a))},Game_Action.prototype.itemEffectAddState=function(a,b){0===b.dataId?this.itemEffectAddAttackState(a,b):this.itemEffectAddNormalState(a,b)},Game_Action.prototype.itemEffectAddAttackState=function(a,b){this.subject().attackStates().forEach(function(c){var d=b.value1;d*=a.stateRate(c),d*=this.subject().attackStatesRate(c),d*=this.lukEffectRate(a),Math.random()<d&&(a.addState(c),this.makeSuccess(a))}.bind(this),a)},Game_Action.prototype.itemEffectAddNormalState=function(a,b){var c=b.value1;this.isCertainHit()||(c*=a.stateRate(b.dataId),c*=this.lukEffectRate(a)),Math.random()<c&&(a.addState(b.dataId),this.makeSuccess(a))},Game_Action.prototype.itemEffectRemoveState=function(a,b){var c=b.value1;Math.random()<c&&(a.removeState(b.dataId),this.makeSuccess(a))},Game_Action.prototype.itemEffectAddBuff=function(a,b){a.addBuff(b.dataId,b.value1),this.makeSuccess(a)},Game_Action.prototype.itemEffectAddDebuff=function(a,b){var c=a.debuffRate(b.dataId)*this.lukEffectRate(a);Math.random()<c&&(a.addDebuff(b.dataId,b.value1),this.makeSuccess(a))},Game_Action.prototype.itemEffectRemoveBuff=function(a,b){a.isBuffAffected(b.dataId)&&(a.removeBuff(b.dataId),this.makeSuccess(a))},Game_Action.prototype.itemEffectRemoveDebuff=function(a,b){a.isDebuffAffected(b.dataId)&&(a.removeBuff(b.dataId),this.makeSuccess(a))},Game_Action.prototype.itemEffectSpecial=function(a,b){b.dataId===Game_Action.SPECIAL_EFFECT_ESCAPE&&(a.escape(),this.makeSuccess(a))},Game_Action.prototype.itemEffectGrow=function(a,b){a.addParam(b.dataId,Math.floor(b.value1)),this.makeSuccess(a)},Game_Action.prototype.itemEffectLearnSkill=function(a,b){a.isActor()&&(a.learnSkill(b.dataId),this.makeSuccess(a))},Game_Action.prototype.itemEffectCommonEvent=function(a,b){},Game_Action.prototype.makeSuccess=function(a){a.result().success=!0},Game_Action.prototype.applyItemUserEffect=function(a){var b=Math.floor(this.item().tpGain*this.subject().tcr);this.subject().gainSilentTp(b)},Game_Action.prototype.lukEffectRate=function(a){return Math.max(1+.001*(this.subject().luk-a.luk),0)},Game_Action.prototype.applyGlobal=function(){this.item().effects.forEach(function(a){a.code===Game_Action.EFFECT_COMMON_EVENT&&$gameTemp.reserveCommonEvent(a.dataId)},this)},Game_ActionResult.prototype.initialize=function(){this.clear()},Game_ActionResult.prototype.clear=function(){this.used=!1,this.missed=!1,this.evaded=!1,this.physical=!1,this.drain=!1,this.critical=!1,this.success=!1,this.hpAffected=!1,this.hpDamage=0,this.mpDamage=0,this.tpDamage=0,this.addedStates=[],this.removedStates=[],this.addedBuffs=[],this.addedDebuffs=[],this.removedBuffs=[]},Game_ActionResult.prototype.addedStateObjects=function(){return this.addedStates.map(function(a){return $dataStates[a]})},Game_ActionResult.prototype.removedStateObjects=function(){return this.removedStates.map(function(a){return $dataStates[a]})},Game_ActionResult.prototype.isStatusAffected=function(){return this.addedStates.length>0||this.removedStates.length>0||this.addedBuffs.length>0||this.addedDebuffs.length>0||this.removedBuffs.length>0},Game_ActionResult.prototype.isHit=function(){return this.used&&!this.missed&&!this.evaded},Game_ActionResult.prototype.isStateAdded=function(a){return this.addedStates.contains(a)},Game_ActionResult.prototype.pushAddedState=function(a){this.isStateAdded(a)||this.addedStates.push(a)},Game_ActionResult.prototype.isStateRemoved=function(a){return this.removedStates.contains(a)},Game_ActionResult.prototype.pushRemovedState=function(a){this.isStateRemoved(a)||this.removedStates.push(a)},Game_ActionResult.prototype.isBuffAdded=function(a){return this.addedBuffs.contains(a)},Game_ActionResult.prototype.pushAddedBuff=function(a){this.isBuffAdded(a)||this.addedBuffs.push(a)},Game_ActionResult.prototype.isDebuffAdded=function(a){return this.addedDebuffs.contains(a)},Game_ActionResult.prototype.pushAddedDebuff=function(a){this.isDebuffAdded(a)||this.addedDebuffs.push(a)},Game_ActionResult.prototype.isBuffRemoved=function(a){return this.removedBuffs.contains(a)},Game_ActionResult.prototype.pushRemovedBuff=function(a){this.isBuffRemoved(a)||this.removedBuffs.push(a)},Game_BattlerBase.TRAIT_ELEMENT_RATE=11,Game_BattlerBase.TRAIT_DEBUFF_RATE=12,Game_BattlerBase.TRAIT_STATE_RATE=13,Game_BattlerBase.TRAIT_STATE_RESIST=14,Game_BattlerBase.TRAIT_PARAM=21,Game_BattlerBase.TRAIT_XPARAM=22,Game_BattlerBase.TRAIT_SPARAM=23,Game_BattlerBase.TRAIT_ATTACK_ELEMENT=31,Game_BattlerBase.TRAIT_ATTACK_STATE=32,Game_BattlerBase.TRAIT_ATTACK_SPEED=33,Game_BattlerBase.TRAIT_ATTACK_TIMES=34,Game_BattlerBase.TRAIT_STYPE_ADD=41,Game_BattlerBase.TRAIT_STYPE_SEAL=42,Game_BattlerBase.TRAIT_SKILL_ADD=43,Game_BattlerBase.TRAIT_SKILL_SEAL=44,Game_BattlerBase.TRAIT_EQUIP_WTYPE=51,Game_BattlerBase.TRAIT_EQUIP_ATYPE=52,Game_BattlerBase.TRAIT_EQUIP_LOCK=53,Game_BattlerBase.TRAIT_EQUIP_SEAL=54,Game_BattlerBase.TRAIT_SLOT_TYPE=55,Game_BattlerBase.TRAIT_ACTION_PLUS=61,Game_BattlerBase.TRAIT_SPECIAL_FLAG=62,Game_BattlerBase.TRAIT_COLLAPSE_TYPE=63,Game_BattlerBase.TRAIT_PARTY_ABILITY=64,Game_BattlerBase.FLAG_ID_AUTO_BATTLE=0,Game_BattlerBase.FLAG_ID_GUARD=1,Game_BattlerBase.FLAG_ID_SUBSTITUTE=2,Game_BattlerBase.FLAG_ID_PRESERVE_TP=3,Game_BattlerBase.ICON_BUFF_START=32,Game_BattlerBase.ICON_DEBUFF_START=48,Object.defineProperties(Game_BattlerBase.prototype,{hp:{get:function(){return this._hp},configurable:!0},mp:{get:function(){return this._mp},configurable:!0},tp:{get:function(){return this._tp},configurable:!0},mhp:{get:function(){return this.param(0)},configurable:!0},mmp:{get:function(){return this.param(1)},configurable:!0},atk:{get:function(){return this.param(2)},configurable:!0},def:{get:function(){return this.param(3)},configurable:!0},mat:{get:function(){return this.param(4)},configurable:!0},mdf:{get:function(){return this.param(5)},configurable:!0},agi:{get:function(){return this.param(6)},configurable:!0},luk:{get:function(){return this.param(7)},configurable:!0},hit:{get:function(){return this.xparam(0)},configurable:!0},eva:{get:function(){return this.xparam(1)},configurable:!0},cri:{get:function(){return this.xparam(2)},configurable:!0},cev:{get:function(){return this.xparam(3)},configurable:!0},mev:{get:function(){return this.xparam(4)},configurable:!0},mrf:{get:function(){return this.xparam(5)},configurable:!0},cnt:{get:function(){return this.xparam(6)},configurable:!0},hrg:{get:function(){return this.xparam(7)},configurable:!0},mrg:{get:function(){return this.xparam(8)},configurable:!0},trg:{get:function(){return this.xparam(9)},configurable:!0},tgr:{get:function(){return this.sparam(0)},configurable:!0},grd:{get:function(){return this.sparam(1)},configurable:!0},rec:{get:function(){return this.sparam(2)},configurable:!0},pha:{get:function(){return this.sparam(3)},configurable:!0},mcr:{get:function(){return this.sparam(4)},configurable:!0},tcr:{get:function(){return this.sparam(5)},configurable:!0},pdr:{get:function(){return this.sparam(6)},configurable:!0},mdr:{get:function(){return this.sparam(7)},configurable:!0},fdr:{get:function(){return this.sparam(8)},configurable:!0},exr:{get:function(){return this.sparam(9)},configurable:!0}}),Game_BattlerBase.prototype.initialize=function(){this.initMembers()},Game_BattlerBase.prototype.initMembers=function(){this._hp=1,this._mp=0,this._tp=0,this._hidden=!1,this.clearParamPlus(),this.clearStates(),this.clearBuffs()},Game_BattlerBase.prototype.clearParamPlus=function(){this._paramPlus=[0,0,0,0,0,0,0,0]},Game_BattlerBase.prototype.clearStates=function(){this._states=[],this._stateTurns={}},Game_BattlerBase.prototype.eraseState=function(a){var b=this._states.indexOf(a);b>=0&&this._states.splice(b,1),delete this._stateTurns[a]},Game_BattlerBase.prototype.isStateAffected=function(a){return this._states.contains(a)},Game_BattlerBase.prototype.isDeathStateAffected=function(){return this.isStateAffected(this.deathStateId())},Game_BattlerBase.prototype.deathStateId=function(){return 1},Game_BattlerBase.prototype.resetStateCounts=function(a){var b=$dataStates[a],c=1+Math.max(b.maxTurns-b.minTurns,0);this._stateTurns[a]=b.minTurns+Math.randomInt(c)},Game_BattlerBase.prototype.isStateExpired=function(a){return 0===this._stateTurns[a]},Game_BattlerBase.prototype.updateStateTurns=function(){this._states.forEach(function(a){this._stateTurns[a]>0&&this._stateTurns[a]--},this)},Game_BattlerBase.prototype.clearBuffs=function(){this._buffs=[0,0,0,0,0,0,0,0],this._buffTurns=[0,0,0,0,0,0,0,0]},Game_BattlerBase.prototype.eraseBuff=function(a){this._buffs[a]=0,this._buffTurns[a]=0},Game_BattlerBase.prototype.buffLength=function(){return this._buffs.length},Game_BattlerBase.prototype.buff=function(a){return this._buffs[a]},Game_BattlerBase.prototype.isBuffAffected=function(a){return this._buffs[a]>0},Game_BattlerBase.prototype.isDebuffAffected=function(a){return this._buffs[a]<0},Game_BattlerBase.prototype.isBuffOrDebuffAffected=function(a){return 0!==this._buffs[a]},Game_BattlerBase.prototype.isMaxBuffAffected=function(a){return 2===this._buffs[a]},Game_BattlerBase.prototype.isMaxDebuffAffected=function(a){return-2===this._buffs[a]},Game_BattlerBase.prototype.increaseBuff=function(a){this.isMaxBuffAffected(a)||this._buffs[a]++},Game_BattlerBase.prototype.decreaseBuff=function(a){this.isMaxDebuffAffected(a)||this._buffs[a]--},Game_BattlerBase.prototype.overwriteBuffTurns=function(a,b){this._buffTurns[a]<b&&(this._buffTurns[a]=b)},Game_BattlerBase.prototype.isBuffExpired=function(a){return 0===this._buffTurns[a]},Game_BattlerBase.prototype.updateBuffTurns=function(){for(var a=0;a<this._buffTurns.length;a++)this._buffTurns[a]>0&&this._buffTurns[a]--},Game_BattlerBase.prototype.die=function(){this._hp=0,this.clearStates(),this.clearBuffs()},Game_BattlerBase.prototype.revive=function(){0===this._hp&&(this._hp=1)},Game_BattlerBase.prototype.states=function(){return this._states.map(function(a){return $dataStates[a]})},Game_BattlerBase.prototype.stateIcons=function(){return this.states().map(function(a){return a.iconIndex}).filter(function(a){return a>0})},Game_BattlerBase.prototype.buffIcons=function(){for(var a=[],b=0;b<this._buffs.length;b++)0!==this._buffs[b]&&a.push(this.buffIconIndex(this._buffs[b],b));return a},Game_BattlerBase.prototype.buffIconIndex=function(a,b){return a>0?Game_BattlerBase.ICON_BUFF_START+8*(a-1)+b:0>a?Game_BattlerBase.ICON_DEBUFF_START+8*(-a-1)+b:0},Game_BattlerBase.prototype.allIcons=function(){return this.stateIcons().concat(this.buffIcons())},Game_BattlerBase.prototype.traitObjects=function(){return this.states()},Game_BattlerBase.prototype.allTraits=function(){return this.traitObjects().reduce(function(a,b){return a.concat(b.traits)},[])},Game_BattlerBase.prototype.traits=function(a){return this.allTraits().filter(function(b){return b.code===a})},Game_BattlerBase.prototype.traitsWithId=function(a,b){return this.allTraits().filter(function(c){return c.code===a&&c.dataId===b})},Game_BattlerBase.prototype.traitsPi=function(a,b){return this.traitsWithId(a,b).reduce(function(a,b){return a*b.value},1)},Game_BattlerBase.prototype.traitsSum=function(a,b){return this.traitsWithId(a,b).reduce(function(a,b){return a+b.value},0)},Game_BattlerBase.prototype.traitsSumAll=function(a){return this.traits(a).reduce(function(a,b){return a+b.value},0)},Game_BattlerBase.prototype.traitsSet=function(a){return this.traits(a).reduce(function(a,b){return a.concat(b.dataId)},[])},Game_BattlerBase.prototype.paramBase=function(a){return 0},Game_BattlerBase.prototype.paramPlus=function(a){return this._paramPlus[a]},Game_BattlerBase.prototype.paramMin=function(a){return 1===a?0:1},Game_BattlerBase.prototype.paramMax=function(a){return 0===a?999999:1===a?9999:999},Game_BattlerBase.prototype.paramRate=function(a){return this.traitsPi(Game_BattlerBase.TRAIT_PARAM,a)},Game_BattlerBase.prototype.paramBuffRate=function(a){return.25*this._buffs[a]+1},Game_BattlerBase.prototype.param=function(a){var b=this.paramBase(a)+this.paramPlus(a);b*=this.paramRate(a)*this.paramBuffRate(a);var c=this.paramMax(a),d=this.paramMin(a);return Math.round(b.clamp(d,c))},Game_BattlerBase.prototype.xparam=function(a){return this.traitsSum(Game_BattlerBase.TRAIT_XPARAM,a)},Game_BattlerBase.prototype.sparam=function(a){return this.traitsPi(Game_BattlerBase.TRAIT_SPARAM,a)},Game_BattlerBase.prototype.elementRate=function(a){return this.traitsPi(Game_BattlerBase.TRAIT_ELEMENT_RATE,a)},Game_BattlerBase.prototype.debuffRate=function(a){return this.traitsPi(Game_BattlerBase.TRAIT_DEBUFF_RATE,a)},Game_BattlerBase.prototype.stateRate=function(a){return this.traitsPi(Game_BattlerBase.TRAIT_STATE_RATE,a)},Game_BattlerBase.prototype.stateResistSet=function(){return this.traitsSet(Game_BattlerBase.TRAIT_STATE_RESIST)},Game_BattlerBase.prototype.isStateResist=function(a){return this.stateResistSet().contains(a)},Game_BattlerBase.prototype.attackElements=function(){return this.traitsSet(Game_BattlerBase.TRAIT_ATTACK_ELEMENT)},Game_BattlerBase.prototype.attackStates=function(){return this.traitsSet(Game_BattlerBase.TRAIT_ATTACK_STATE)},Game_BattlerBase.prototype.attackStatesRate=function(a){return this.traitsSum(Game_BattlerBase.TRAIT_ATTACK_STATE,a)},Game_BattlerBase.prototype.attackSpeed=function(){return this.traitsSumAll(Game_BattlerBase.TRAIT_ATTACK_SPEED)},Game_BattlerBase.prototype.attackTimesAdd=function(){return Math.max(this.traitsSumAll(Game_BattlerBase.TRAIT_ATTACK_TIMES),0)},Game_BattlerBase.prototype.addedSkillTypes=function(){return this.traitsSet(Game_BattlerBase.TRAIT_STYPE_ADD)},Game_BattlerBase.prototype.isSkillTypeSealed=function(a){return this.traitsSet(Game_BattlerBase.TRAIT_STYPE_SEAL).contains(a)},Game_BattlerBase.prototype.addedSkills=function(){return this.traitsSet(Game_BattlerBase.TRAIT_SKILL_ADD)},Game_BattlerBase.prototype.isSkillSealed=function(a){return this.traitsSet(Game_BattlerBase.TRAIT_SKILL_SEAL).contains(a)},Game_BattlerBase.prototype.isEquipWtypeOk=function(a){return this.traitsSet(Game_BattlerBase.TRAIT_EQUIP_WTYPE).contains(a)},Game_BattlerBase.prototype.isEquipAtypeOk=function(a){return this.traitsSet(Game_BattlerBase.TRAIT_EQUIP_ATYPE).contains(a)},Game_BattlerBase.prototype.isEquipTypeLocked=function(a){return this.traitsSet(Game_BattlerBase.TRAIT_EQUIP_LOCK).contains(a)},Game_BattlerBase.prototype.isEquipTypeSealed=function(a){return this.traitsSet(Game_BattlerBase.TRAIT_EQUIP_SEAL).contains(a)},Game_BattlerBase.prototype.slotType=function(){var a=this.traitsSet(Game_BattlerBase.TRAIT_SLOT_TYPE);return a.length>0?Math.max.apply(null,a):0},Game_BattlerBase.prototype.isDualWield=function(){return 1===this.slotType()},Game_BattlerBase.prototype.actionPlusSet=function(){return this.traits(Game_BattlerBase.TRAIT_ACTION_PLUS).map(function(a){return a.value})},Game_BattlerBase.prototype.specialFlag=function(a){return this.traits(Game_BattlerBase.TRAIT_SPECIAL_FLAG).some(function(b){return b.dataId===a})},Game_BattlerBase.prototype.collapseType=function(){var a=this.traitsSet(Game_BattlerBase.TRAIT_COLLAPSE_TYPE);return a.length>0?Math.max.apply(null,a):0},Game_BattlerBase.prototype.partyAbility=function(a){return this.traits(Game_BattlerBase.TRAIT_PARTY_ABILITY).some(function(b){return b.dataId===a})},Game_BattlerBase.prototype.isAutoBattle=function(){return this.specialFlag(Game_BattlerBase.FLAG_ID_AUTO_BATTLE)},Game_BattlerBase.prototype.isGuard=function(){return this.specialFlag(Game_BattlerBase.FLAG_ID_GUARD)&&this.canMove()},Game_BattlerBase.prototype.isSubstitute=function(){return this.specialFlag(Game_BattlerBase.FLAG_ID_SUBSTITUTE)&&this.canMove()},Game_BattlerBase.prototype.isPreserveTp=function(){return this.specialFlag(Game_BattlerBase.FLAG_ID_PRESERVE_TP)},Game_BattlerBase.prototype.addParam=function(a,b){this._paramPlus[a]+=b,this.refresh()},Game_BattlerBase.prototype.setHp=function(a){this._hp=a,this.refresh()},Game_BattlerBase.prototype.setMp=function(a){this._mp=a,this.refresh()},Game_BattlerBase.prototype.setTp=function(a){this._tp=a,this.refresh()},Game_BattlerBase.prototype.maxTp=function(){return 100},Game_BattlerBase.prototype.refresh=function(){this.stateResistSet().forEach(function(a){this.eraseState(a)},this),this._hp=this._hp.clamp(0,this.mhp),this._mp=this._mp.clamp(0,this.mmp),this._tp=this._tp.clamp(0,this.maxTp())},Game_BattlerBase.prototype.recoverAll=function(){this.clearStates(),this._hp=this.mhp,this._mp=this.mmp},Game_BattlerBase.prototype.hpRate=function(){return this.hp/this.mhp},Game_BattlerBase.prototype.mpRate=function(){return this.mmp>0?this.mp/this.mmp:0},Game_BattlerBase.prototype.tpRate=function(){return this.tp/100},Game_BattlerBase.prototype.hide=function(){this._hidden=!0},Game_BattlerBase.prototype.appear=function(){this._hidden=!1},Game_BattlerBase.prototype.isHidden=function(){return this._hidden},Game_BattlerBase.prototype.isAppeared=function(){return!this.isHidden()},Game_BattlerBase.prototype.isDead=function(){return this.isAppeared()&&this.isDeathStateAffected()},Game_BattlerBase.prototype.isAlive=function(){return this.isAppeared()&&!this.isDeathStateAffected()},Game_BattlerBase.prototype.isDying=function(){return this.isAlive()&&this._hp<this.mhp/4},Game_BattlerBase.prototype.isRestricted=function(){return this.isAppeared()&&this.restriction()>0},Game_BattlerBase.prototype.canInput=function(){return this.isAppeared()&&!this.isRestricted()&&!this.isAutoBattle()},Game_BattlerBase.prototype.canMove=function(){return this.isAppeared()&&this.restriction()<4},Game_BattlerBase.prototype.isConfused=function(){return this.isAppeared()&&this.restriction()>=1&&this.restriction()<=3},Game_BattlerBase.prototype.confusionLevel=function(){return this.isConfused()?this.restriction():0},Game_BattlerBase.prototype.isActor=function(){return!1},Game_BattlerBase.prototype.isEnemy=function(){return!1},Game_BattlerBase.prototype.sortStates=function(){this._states.sort(function(a,b){var c=$dataStates[a].priority,d=$dataStates[b].priority;return c!==d?d-c:a-b})},Game_BattlerBase.prototype.restriction=function(){return Math.max.apply(null,this.states().map(function(a){return a.restriction}).concat(0))},Game_BattlerBase.prototype.addNewState=function(a){a===this.deathStateId()&&this.die();var b=this.isRestricted();this._states.push(a),this.sortStates(),!b&&this.isRestricted()&&this.onRestrict()},Game_BattlerBase.prototype.onRestrict=function(){},Game_BattlerBase.prototype.mostImportantStateText=function(){for(var a=this.states(),b=0;b<a.length;b++)if(a[b].message3)return a[b].message3;return""},Game_BattlerBase.prototype.stateMotionIndex=function(){var a=this.states();return a.length>0?a[0].motion:0},Game_BattlerBase.prototype.stateOverlayIndex=function(){var a=this.states();return a.length>0?a[0].overlay:0},Game_BattlerBase.prototype.isSkillWtypeOk=function(a){return!0},Game_BattlerBase.prototype.skillMpCost=function(a){return Math.floor(a.mpCost*this.mcr)},Game_BattlerBase.prototype.skillTpCost=function(a){return a.tpCost},Game_BattlerBase.prototype.canPaySkillCost=function(a){return this._tp>=this.skillTpCost(a)&&this._mp>=this.skillMpCost(a)},Game_BattlerBase.prototype.paySkillCost=function(a){this._mp-=this.skillMpCost(a),this._tp-=this.skillTpCost(a)},Game_BattlerBase.prototype.isOccasionOk=function(a){return $gameParty.inBattle()?0===a.occasion||1===a.occasion:0===a.occasion||2===a.occasion},Game_BattlerBase.prototype.meetsUsableItemConditions=function(a){return this.canMove()&&this.isOccasionOk(a)},Game_BattlerBase.prototype.meetsSkillConditions=function(a){return this.meetsUsableItemConditions(a)&&this.isSkillWtypeOk(a)&&this.canPaySkillCost(a)&&!this.isSkillSealed(a.id)&&!this.isSkillTypeSealed(a.stypeId)},Game_BattlerBase.prototype.meetsItemConditions=function(a){return this.meetsUsableItemConditions(a)&&$gameParty.hasItem(a)},Game_BattlerBase.prototype.canUse=function(a){return a?DataManager.isSkill(a)?this.meetsSkillConditions(a):DataManager.isItem(a)?this.meetsItemConditions(a):!1:!1},Game_BattlerBase.prototype.canEquip=function(a){return a?DataManager.isWeapon(a)?this.canEquipWeapon(a):DataManager.isArmor(a)?this.canEquipArmor(a):!1:!1},Game_BattlerBase.prototype.canEquipWeapon=function(a){return this.isEquipWtypeOk(a.wtypeId)&&!this.isEquipTypeSealed(a.etypeId)},Game_BattlerBase.prototype.canEquipArmor=function(a){return this.isEquipAtypeOk(a.atypeId)&&!this.isEquipTypeSealed(a.etypeId)},Game_BattlerBase.prototype.attackSkillId=function(){return 1},Game_BattlerBase.prototype.guardSkillId=function(){return 2},Game_BattlerBase.prototype.canAttack=function(){return this.canUse($dataSkills[this.attackSkillId()])},Game_BattlerBase.prototype.canGuard=function(){return this.canUse($dataSkills[this.guardSkillId()])},Game_Battler.prototype=Object.create(Game_BattlerBase.prototype),Game_Battler.prototype.constructor=Game_Battler,Game_Battler.prototype.initialize=function(){Game_BattlerBase.prototype.initialize.call(this)},Game_Battler.prototype.initMembers=function(){Game_BattlerBase.prototype.initMembers.call(this),this._actions=[],this._speed=0,this._result=new Game_ActionResult,this._actionState="",this._lastTargetIndex=0,this._animations=[],this._damagePopup=!1,this._effectType=null,this._motionType=null,this._weaponImageId=0,this._motionRefresh=!1,this._selected=!1},Game_Battler.prototype.clearAnimations=function(){this._animations=[]},Game_Battler.prototype.clearDamagePopup=function(){this._damagePopup=!1},Game_Battler.prototype.clearWeaponAnimation=function(){this._weaponImageId=0},Game_Battler.prototype.clearEffect=function(){this._effectType=null},Game_Battler.prototype.clearMotion=function(){this._motionType=null,this._motionRefresh=!1},Game_Battler.prototype.requestEffect=function(a){this._effectType=a},Game_Battler.prototype.requestMotion=function(a){this._motionType=a},Game_Battler.prototype.requestMotionRefresh=function(){this._motionRefresh=!0},Game_Battler.prototype.select=function(){this._selected=!0},Game_Battler.prototype.deselect=function(){this._selected=!1},Game_Battler.prototype.isAnimationRequested=function(){return this._animations.length>0},Game_Battler.prototype.isDamagePopupRequested=function(){return this._damagePopup},Game_Battler.prototype.isEffectRequested=function(){return!!this._effectType},Game_Battler.prototype.isMotionRequested=function(){return!!this._motionType},Game_Battler.prototype.isWeaponAnimationRequested=function(){return this._weaponImageId>0},Game_Battler.prototype.isMotionRefreshRequested=function(){return this._motionRefresh},Game_Battler.prototype.isSelected=function(){return this._selected},Game_Battler.prototype.effectType=function(){return this._effectType},Game_Battler.prototype.motionType=function(){return this._motionType},Game_Battler.prototype.weaponImageId=function(){return this._weaponImageId},Game_Battler.prototype.shiftAnimation=function(){return this._animations.shift()},Game_Battler.prototype.startAnimation=function(a,b,c){var d={animationId:a,mirror:b,delay:c};this._animations.push(d)},Game_Battler.prototype.startDamagePopup=function(){this._damagePopup=!0},Game_Battler.prototype.startWeaponAnimation=function(a){this._weaponImageId=a},Game_Battler.prototype.action=function(a){return this._actions[a]},Game_Battler.prototype.setAction=function(a,b){this._actions[a]=b},Game_Battler.prototype.numActions=function(){return this._actions.length},Game_Battler.prototype.clearActions=function(){this._actions=[]},Game_Battler.prototype.result=function(){return this._result},Game_Battler.prototype.clearResult=function(){this._result.clear()},Game_Battler.prototype.refresh=function(){Game_BattlerBase.prototype.refresh.call(this),0===this.hp?this.addState(this.deathStateId()):this.removeState(this.deathStateId())},Game_Battler.prototype.addState=function(a){this.isStateAddable(a)&&(this.isStateAffected(a)||(this.addNewState(a),this.refresh()),this.resetStateCounts(a),this._result.pushAddedState(a))},Game_Battler.prototype.isStateAddable=function(a){return this.isAlive()&&$dataStates[a]&&!this.isStateResist(a)&&!this._result.isStateRemoved(a)&&!this.isStateRestrict(a)},Game_Battler.prototype.isStateRestrict=function(a){return $dataStates[a].removeByRestriction&&this.isRestricted()},Game_Battler.prototype.onRestrict=function(){Game_BattlerBase.prototype.onRestrict.call(this),this.clearActions(),this.states().forEach(function(a){a.removeByRestriction&&this.removeState(a.id)},this)},Game_Battler.prototype.removeState=function(a){this.isStateAffected(a)&&(a===this.deathStateId()&&this.revive(),this.eraseState(a),this.refresh(),this._result.pushRemovedState(a))},Game_Battler.prototype.escape=function(){$gameParty.inBattle()&&this.hide(),this.clearActions(),this.clearStates(),SoundManager.playEscape()},Game_Battler.prototype.addBuff=function(a,b){this.isAlive()&&(this.increaseBuff(a),this.isBuffAffected(a)&&this.overwriteBuffTurns(a,b),this._result.pushAddedBuff(a),this.refresh())},Game_Battler.prototype.addDebuff=function(a,b){this.isAlive()&&(this.decreaseBuff(a),this.isDebuffAffected(a)&&this.overwriteBuffTurns(a,b),this._result.pushAddedDebuff(a),this.refresh())},Game_Battler.prototype.removeBuff=function(a){this.isAlive()&&this.isBuffOrDebuffAffected(a)&&(this.eraseBuff(a),this._result.pushRemovedBuff(a),this.refresh())},Game_Battler.prototype.removeBattleStates=function(){this.states().forEach(function(a){a.removeAtBattleEnd&&this.removeState(a.id)},this)},Game_Battler.prototype.removeAllBuffs=function(){for(var a=0;a<this.buffLength();a++)this.removeBuff(a)},Game_Battler.prototype.removeStatesAuto=function(a){this.states().forEach(function(b){this.isStateExpired(b.id)&&b.autoRemovalTiming===a&&this.removeState(b.id)},this)},Game_Battler.prototype.removeBuffsAuto=function(){for(var a=0;a<this.buffLength();a++)this.isBuffExpired(a)&&this.removeBuff(a)},Game_Battler.prototype.removeStatesByDamage=function(){this.states().forEach(function(a){a.removeByDamage&&Math.randomInt(100)<a.chanceByDamage&&this.removeState(a.id)},this)},Game_Battler.prototype.makeActionTimes=function(){return this.actionPlusSet().reduce(function(a,b){return Math.random()<b?a+1:a},1)},Game_Battler.prototype.makeActions=function(){if(this.clearActions(),this.canMove()){var a=this.makeActionTimes();this._actions=[];for(var b=0;a>b;b++)this._actions.push(new Game_Action(this))}},Game_Battler.prototype.speed=function(){return this._speed},Game_Battler.prototype.makeSpeed=function(){this._speed=Math.min.apply(null,this._actions.map(function(a){return a.speed()}))||0},Game_Battler.prototype.currentAction=function(){return this._actions[0]},Game_Battler.prototype.removeCurrentAction=function(){this._actions.shift()},Game_Battler.prototype.setLastTarget=function(a){a?this._lastTargetIndex=a.index():this._lastTargetIndex=0},Game_Battler.prototype.forceAction=function(a,b){this.clearActions();var c=new Game_Action(this,!0);c.setSkill(a),-2===b?c.setTarget(this._lastTargetIndex):-1===b?c.decideRandomTarget():c.setTarget(b),this._actions.push(c)},Game_Battler.prototype.useItem=function(a){DataManager.isSkill(a)?this.paySkillCost(a):DataManager.isItem(a)&&this.consumeItem(a)},Game_Battler.prototype.consumeItem=function(a){$gameParty.consumeItem(a)},Game_Battler.prototype.gainHp=function(a){this._result.hpDamage=-a,this._result.hpAffected=!0,this.setHp(this.hp+a)},Game_Battler.prototype.gainMp=function(a){this._result.mpDamage=-a,this.setMp(this.mp+a)},Game_Battler.prototype.gainTp=function(a){this._result.tpDamage=-a,this.setTp(this.tp+a)},Game_Battler.prototype.gainSilentTp=function(a){this.setTp(this.tp+a)},Game_Battler.prototype.initTp=function(){this.setTp(Math.randomInt(25))},Game_Battler.prototype.clearTp=function(){this.setTp(0)},Game_Battler.prototype.chargeTpByDamage=function(a){var b=Math.floor(50*a*this.tcr);this.gainSilentTp(b)},Game_Battler.prototype.regenerateHp=function(){var a=Math.floor(this.mhp*this.hrg);a=Math.max(a,-this.maxSlipDamage()),0!==a&&this.gainHp(a)},Game_Battler.prototype.maxSlipDamage=function(){return $dataSystem.optSlipDeath?this.hp:Math.max(this.hp-1,0)},Game_Battler.prototype.regenerateMp=function(){var a=Math.floor(this.mmp*this.mrg);0!==a&&this.gainMp(a)},Game_Battler.prototype.regenerateTp=function(){var a=Math.floor(100*this.trg);this.gainSilentTp(a)},Game_Battler.prototype.regenerateAll=function(){this.isAlive()&&(this.regenerateHp(),this.regenerateMp(),this.regenerateTp())},Game_Battler.prototype.onBattleStart=function(){this.setActionState("undecided"),this.clearMotion(),this.isPreserveTp()||this.initTp()},Game_Battler.prototype.onAllActionsEnd=function(){this.clearResult(),this.removeStatesAuto(1),this.removeBuffsAuto()},Game_Battler.prototype.onTurnEnd=function(){this.clearResult(),this.regenerateAll(),this.updateStateTurns(),this.updateBuffTurns(),this.removeStatesAuto(2)},Game_Battler.prototype.onBattleEnd=function(){this.clearResult(),this.removeBattleStates(),this.removeAllBuffs(),this.clearActions(),this.isPreserveTp()||this.clearTp(),this.appear()},Game_Battler.prototype.onDamage=function(a){this.removeStatesByDamage(),this.chargeTpByDamage(a/this.mhp)},Game_Battler.prototype.setActionState=function(a){this._actionState=a,this.requestMotionRefresh()},Game_Battler.prototype.isUndecided=function(){return"undecided"===this._actionState},Game_Battler.prototype.isInputting=function(){return"inputting"===this._actionState},Game_Battler.prototype.isWaiting=function(){return"waiting"===this._actionState},Game_Battler.prototype.isActing=function(){return"acting"===this._actionState},Game_Battler.prototype.isChanting=function(){return this.isWaiting()?this._actions.some(function(a){return a.isMagicSkill()}):!1},Game_Battler.prototype.isGuardWaiting=function(){return this.isWaiting()?this._actions.some(function(a){
return a.isGuard()}):!1},Game_Battler.prototype.performActionStart=function(a){a.isGuard()||this.setActionState("acting")},Game_Battler.prototype.performAction=function(a){},Game_Battler.prototype.performActionEnd=function(){this.setActionState("done")},Game_Battler.prototype.performDamage=function(){},Game_Battler.prototype.performMiss=function(){SoundManager.playMiss()},Game_Battler.prototype.performRecovery=function(){SoundManager.playRecovery()},Game_Battler.prototype.performEvasion=function(){SoundManager.playEvasion()},Game_Battler.prototype.performMagicEvasion=function(){SoundManager.playMagicEvasion()},Game_Battler.prototype.performCounter=function(){SoundManager.playEvasion()},Game_Battler.prototype.performReflection=function(){SoundManager.playReflection()},Game_Battler.prototype.performSubstitute=function(a){},Game_Battler.prototype.performCollapse=function(){},Game_Actor.prototype=Object.create(Game_Battler.prototype),Game_Actor.prototype.constructor=Game_Actor,Object.defineProperty(Game_Actor.prototype,"level",{get:function(){return this._level},configurable:!0}),Game_Actor.prototype.initialize=function(a){Game_Battler.prototype.initialize.call(this),this.setup(a)},Game_Actor.prototype.initMembers=function(){Game_Battler.prototype.initMembers.call(this),this._actorId=0,this._name="",this._nickname="",this._classId=0,this._level=0,this._characterName="",this._characterIndex=0,this._faceName="",this._faceIndex=0,this._battlerName="",this._exp={},this._skills=[],this._equips=[],this._actionInputIndex=0,this._lastMenuSkill=new Game_Item,this._lastBattleSkill=new Game_Item,this._lastCommandSymbol=""},Game_Actor.prototype.setup=function(a){var b=$dataActors[a];this._actorId=a,this._name=b.name,this._nickname=b.nickname,this._profile=b.profile,this._classId=b.classId,this._level=b.initialLevel,this.initImages(),this.initExp(),this.initSkills(),this.initEquips(b.equips),this.clearParamPlus(),this.recoverAll()},Game_Actor.prototype.actorId=function(){return this._actorId},Game_Actor.prototype.actor=function(){return $dataActors[this._actorId]},Game_Actor.prototype.name=function(){return this._name},Game_Actor.prototype.setName=function(a){this._name=a},Game_Actor.prototype.nickname=function(){return this._nickname},Game_Actor.prototype.setNickname=function(a){this._nickname=a},Game_Actor.prototype.profile=function(){return this._profile},Game_Actor.prototype.setProfile=function(a){this._profile=a},Game_Actor.prototype.characterName=function(){return this._characterName},Game_Actor.prototype.characterIndex=function(){return this._characterIndex},Game_Actor.prototype.faceName=function(){return this._faceName},Game_Actor.prototype.faceIndex=function(){return this._faceIndex},Game_Actor.prototype.battlerName=function(){return this._battlerName},Game_Actor.prototype.clearStates=function(){Game_Battler.prototype.clearStates.call(this),this._stateSteps={}},Game_Actor.prototype.eraseState=function(a){Game_Battler.prototype.eraseState.call(this,a),delete this._stateSteps[a]},Game_Actor.prototype.resetStateCounts=function(a){Game_Battler.prototype.resetStateCounts.call(this,a),this._stateSteps[a]=$dataStates[a].stepsToRemove},Game_Actor.prototype.initImages=function(){var a=this.actor();this._characterName=a.characterName,this._characterIndex=a.characterIndex,this._faceName=a.faceName,this._faceIndex=a.faceIndex,this._battlerName=a.battlerName},Game_Actor.prototype.expForLevel=function(a){var b=this.currentClass(),c=b.expParams[0],d=b.expParams[1],e=b.expParams[2],f=b.expParams[3];return Math.round(c*Math.pow(a-1,.9+e/250)*a*(a+1)/(6+Math.pow(a,2)/50/f)+(a-1)*d)},Game_Actor.prototype.initExp=function(){this._exp[this._classId]=this.currentLevelExp()},Game_Actor.prototype.currentExp=function(){return this._exp[this._classId]},Game_Actor.prototype.currentLevelExp=function(){return this.expForLevel(this._level)},Game_Actor.prototype.nextLevelExp=function(){return this.expForLevel(this._level+1)},Game_Actor.prototype.nextRequiredExp=function(){return this.nextLevelExp()-this.currentExp()},Game_Actor.prototype.maxLevel=function(){return this.actor().maxLevel},Game_Actor.prototype.isMaxLevel=function(){return this._level>=this.maxLevel()},Game_Actor.prototype.initSkills=function(){this._skills=[],this.currentClass().learnings.forEach(function(a){a.level<=this._level&&this.learnSkill(a.skillId)},this)},Game_Actor.prototype.initEquips=function(a){var b=this.equipSlots(),c=b.length;this._equips=[];for(var d=0;c>d;d++)this._equips[d]=new Game_Item;for(var e=0;e<a.length;e++)c>e&&this._equips[e].setEquip(1===b[e],a[e]);this.releaseUnequippableItems(!0),this.refresh()},Game_Actor.prototype.equipSlots=function(){for(var a=[],b=1;b<$dataSystem.equipTypes.length;b++)a.push(b);return a.length>=2&&this.isDualWield()&&(a[1]=1),a},Game_Actor.prototype.equips=function(){return this._equips.map(function(a){return a.object()})},Game_Actor.prototype.weapons=function(){return this.equips().filter(function(a){return a&&DataManager.isWeapon(a)})},Game_Actor.prototype.armors=function(){return this.equips().filter(function(a){return a&&DataManager.isArmor(a)})},Game_Actor.prototype.hasWeapon=function(a){return this.weapons().contains(a)},Game_Actor.prototype.hasArmor=function(a){return this.armors().contains(a)},Game_Actor.prototype.isEquipChangeOk=function(a){return!this.isEquipTypeLocked(this.equipSlots()[a])&&!this.isEquipTypeSealed(this.equipSlots()[a])},Game_Actor.prototype.changeEquip=function(a,b){!this.tradeItemWithParty(b,this.equips()[a])||b&&this.equipSlots()[a]!==b.etypeId||(this._equips[a].setObject(b),this.refresh())},Game_Actor.prototype.forceChangeEquip=function(a,b){this._equips[a].setObject(b),this.releaseUnequippableItems(!0),this.refresh()},Game_Actor.prototype.tradeItemWithParty=function(a,b){return a&&!$gameParty.hasItem(a)?!1:($gameParty.gainItem(b,1),$gameParty.loseItem(a,1),!0)},Game_Actor.prototype.changeEquipById=function(a,b){var c=a-1;1===this.equipSlots()[c]?this.changeEquip(c,$dataWeapons[b]):this.changeEquip(c,$dataArmors[b])},Game_Actor.prototype.isEquipped=function(a){return this.equips().contains(a)},Game_Actor.prototype.discardEquip=function(a){var b=this.equips().indexOf(a);b>=0&&this._equips[b].setObject(null)},Game_Actor.prototype.releaseUnequippableItems=function(a){for(;;){for(var b=this.equipSlots(),c=this.equips(),d=!1,e=0;e<c.length;e++){var f=c[e];!f||this.canEquip(f)&&f.etypeId===b[e]||(a||this.tradeItemWithParty(null,f),this._equips[e].setObject(null),d=!0)}if(!d)break}},Game_Actor.prototype.clearEquipments=function(){for(var a=this.equipSlots().length,b=0;a>b;b++)this.isEquipChangeOk(b)&&this.changeEquip(b,null)},Game_Actor.prototype.optimizeEquipments=function(){var a=this.equipSlots().length;this.clearEquipments();for(var b=0;a>b;b++)this.isEquipChangeOk(b)&&this.changeEquip(b,this.bestEquipItem(b))},Game_Actor.prototype.bestEquipItem=function(a){for(var b=this.equipSlots()[a],c=$gameParty.equipItems().filter(function(a){return a.etypeId===b&&this.canEquip(a)},this),d=null,e=-1e3,f=0;f<c.length;f++){var g=this.calcEquipItemPerformance(c[f]);g>e&&(e=g,d=c[f])}return d},Game_Actor.prototype.calcEquipItemPerformance=function(a){return a.params.reduce(function(a,b){return a+b})},Game_Actor.prototype.isSkillWtypeOk=function(a){var b=a.requiredWtypeId1,c=a.requiredWtypeId2;return 0===b&&0===c||b>0&&this.isWtypeEquipped(b)||c>0&&this.isWtypeEquipped(c)?!0:!1},Game_Actor.prototype.isWtypeEquipped=function(a){return this.weapons().some(function(b){return b.wtypeId===a})},Game_Actor.prototype.refresh=function(){this.releaseUnequippableItems(!1),Game_Battler.prototype.refresh.call(this)},Game_Actor.prototype.isActor=function(){return!0},Game_Actor.prototype.friendsUnit=function(){return $gameParty},Game_Actor.prototype.opponentsUnit=function(){return $gameTroop},Game_Actor.prototype.index=function(){return $gameParty.members().indexOf(this)},Game_Actor.prototype.isBattleMember=function(){return $gameParty.battleMembers().contains(this)},Game_Actor.prototype.isFormationChangeOk=function(){return!0},Game_Actor.prototype.currentClass=function(){return $dataClasses[this._classId]},Game_Actor.prototype.isClass=function(a){return a&&this._classId===a.id},Game_Actor.prototype.skills=function(){var a=[];return this._skills.concat(this.addedSkills()).forEach(function(b){a.contains($dataSkills[b])||a.push($dataSkills[b])}),a},Game_Actor.prototype.usableSkills=function(){return this.skills().filter(function(a){return this.canUse(a)},this)},Game_Actor.prototype.traitObjects=function(){var a=Game_Battler.prototype.traitObjects.call(this);a=a.concat([this.actor(),this.currentClass()]);for(var b=this.equips(),c=0;c<b.length;c++){var d=b[c];d&&a.push(d)}return a},Game_Actor.prototype.attackElements=function(){var a=Game_Battler.prototype.attackElements.call(this);return this.hasNoWeapons()&&!a.contains(this.bareHandsElementId())&&a.push(this.bareHandsElementId()),a},Game_Actor.prototype.hasNoWeapons=function(){return 0===this.weapons().length},Game_Actor.prototype.bareHandsElementId=function(){return 1},Game_Actor.prototype.paramMax=function(a){return 0===a?9999:Game_Battler.prototype.paramMax.call(this,a)},Game_Actor.prototype.paramBase=function(a){return this.currentClass().params[a][this._level]},Game_Actor.prototype.paramPlus=function(a){for(var b=Game_Battler.prototype.paramPlus.call(this,a),c=this.equips(),d=0;d<c.length;d++){var e=c[d];e&&(b+=e.params[a])}return b},Game_Actor.prototype.attackAnimationId1=function(){if(this.hasNoWeapons())return this.bareHandsAnimationId();var a=this.weapons();return a[0]?a[0].animationId:0},Game_Actor.prototype.attackAnimationId2=function(){var a=this.weapons();return a[1]?a[1].animationId:0},Game_Actor.prototype.bareHandsAnimationId=function(){return 1},Game_Actor.prototype.changeExp=function(a,b){this._exp[this._classId]=Math.max(a,0);for(var c=this._level,d=this.skills();!this.isMaxLevel()&&this.currentExp()>=this.nextLevelExp();)this.levelUp();for(;this.currentExp()<this.currentLevelExp();)this.levelDown();b&&this._level>c&&this.displayLevelUp(this.findNewSkills(d)),this.refresh()},Game_Actor.prototype.levelUp=function(){this._level++,this.currentClass().learnings.forEach(function(a){a.level===this._level&&this.learnSkill(a.skillId)},this)},Game_Actor.prototype.levelDown=function(){this._level--},Game_Actor.prototype.findNewSkills=function(a){for(var b=this.skills(),c=0;c<a.length;c++){var d=b.indexOf(a[c]);d>=0&&b.splice(d,1)}return b},Game_Actor.prototype.displayLevelUp=function(a){var b=TextManager.levelUp.format(this._name,TextManager.level,this._level);$gameMessage.newPage(),$gameMessage.add(b),a.forEach(function(a){$gameMessage.add(TextManager.obtainSkill.format(a.name))})},Game_Actor.prototype.gainExp=function(a){var b=this.currentExp()+Math.round(a*this.finalExpRate());this.changeExp(b,this.shouldDisplayLevelUp())},Game_Actor.prototype.finalExpRate=function(){return this.exr*(this.isBattleMember()?1:this.benchMembersExpRate())},Game_Actor.prototype.benchMembersExpRate=function(){return $dataSystem.optExtraExp?1:0},Game_Actor.prototype.shouldDisplayLevelUp=function(){return!0},Game_Actor.prototype.changeLevel=function(a,b){a=a.clamp(1,this.maxLevel()),this.changeExp(this.expForLevel(a),b)},Game_Actor.prototype.learnSkill=function(a){this.isLearnedSkill(a)||(this._skills.push(a),this._skills.sort(function(a,b){return a-b}))},Game_Actor.prototype.forgetSkill=function(a){var b=this._skills.indexOf(a);b>=0&&this._skills.splice(b,1)},Game_Actor.prototype.isLearnedSkill=function(a){return this._skills.contains(a)},Game_Actor.prototype.changeClass=function(a,b){b&&(this._exp[a]=this.currentExp()),this._classId=a,this.changeExp(this._exp[this._classId]||0,!1),this.refresh()},Game_Actor.prototype.setCharacterImage=function(a,b){this._characterName=a,this._characterIndex=b},Game_Actor.prototype.setFaceImage=function(a,b){this._faceName=a,this._faceIndex=b},Game_Actor.prototype.setBattlerImage=function(a){this._battlerName=a},Game_Actor.prototype.isSpriteVisible=function(){return $gameSystem.isSideView()},Game_Actor.prototype.startAnimation=function(a,b,c){b=!b,Game_Battler.prototype.startAnimation.call(this,a,b,c)},Game_Actor.prototype.performActionStart=function(a){Game_Battler.prototype.performActionStart.call(this,a)},Game_Actor.prototype.performAction=function(a){Game_Battler.prototype.performAction.call(this,a),a.isAttack()?this.performAttack():a.isGuard()?this.requestMotion("guard"):a.isMagicSkill()?this.requestMotion("spell"):a.isSkill()?this.requestMotion("skill"):a.isItem()&&this.requestMotion("item")},Game_Actor.prototype.performActionEnd=function(){Game_Battler.prototype.performActionEnd.call(this)},Game_Actor.prototype.performAttack=function(){var a=this.weapons(),b=a[0]?a[0].wtypeId:0,c=$dataSystem.attackMotions[b];c&&(0===c.type?this.requestMotion("thrust"):1===c.type?this.requestMotion("swing"):2===c.type&&this.requestMotion("missile"),this.startWeaponAnimation(c.weaponImageId))},Game_Actor.prototype.performDamage=function(){Game_Battler.prototype.performDamage.call(this),this.isSpriteVisible()?this.requestMotion("damage"):$gameScreen.startShake(5,5,10),SoundManager.playActorDamage()},Game_Actor.prototype.performEvasion=function(){Game_Battler.prototype.performEvasion.call(this),this.requestMotion("evade")},Game_Actor.prototype.performMagicEvasion=function(){Game_Battler.prototype.performMagicEvasion.call(this),this.requestMotion("evade")},Game_Actor.prototype.performCounter=function(){Game_Battler.prototype.performCounter.call(this),this.performAttack()},Game_Actor.prototype.performCollapse=function(){Game_Battler.prototype.performCollapse.call(this),$gameParty.inBattle()&&SoundManager.playActorCollapse()},Game_Actor.prototype.performVictory=function(){this.canMove()&&this.requestMotion("victory")},Game_Actor.prototype.performEscape=function(){this.canMove()&&this.requestMotion("escape")},Game_Actor.prototype.makeActionList=function(){var a=[],b=new Game_Action(this);return b.setAttack(),a.push(b),this.usableSkills().forEach(function(c){b=new Game_Action(this),b.setSkill(c.id),a.push(b)},this),a},Game_Actor.prototype.makeAutoBattleActions=function(){for(var a=0;a<this.numActions();a++)for(var b=this.makeActionList(),c=Number.MIN_VALUE,d=0;d<b.length;d++){var e=b[d].evaluate();e>c&&(c=e,this.setAction(a,b[d]))}this.setActionState("waiting")},Game_Actor.prototype.makeConfusionActions=function(){for(var a=0;a<this.numActions();a++)this.action(a).setConfusion();this.setActionState("waiting")},Game_Actor.prototype.makeActions=function(){Game_Battler.prototype.makeActions.call(this),this.numActions()>0?this.setActionState("undecided"):this.setActionState("waiting"),this.isAutoBattle()?this.makeAutoBattleActions():this.isConfused()&&this.makeConfusionActions()},Game_Actor.prototype.onPlayerWalk=function(){this.clearResult(),this.checkFloorEffect(),$gamePlayer.isNormal()&&(this.turnEndOnMap(),this.states().forEach(function(a){this.updateStateSteps(a)},this),this.showAddedStates(),this.showRemovedStates())},Game_Actor.prototype.updateStateSteps=function(a){a.removeByWalking&&this._stateSteps[a.id]>0&&0===--this._stateSteps[a.id]&&this.removeState(a.id)},Game_Actor.prototype.showAddedStates=function(){this.result().addedStateObjects().forEach(function(a){a.message1&&$gameMessage.add(this._name+a.message1)},this)},Game_Actor.prototype.showRemovedStates=function(){this.result().removedStateObjects().forEach(function(a){a.message4&&$gameMessage.add(this._name+a.message4)},this)},Game_Actor.prototype.stepsForTurn=function(){return 20},Game_Actor.prototype.turnEndOnMap=function(){$gameParty.steps()%this.stepsForTurn()===0&&(this.onTurnEnd(),this.result().hpDamage>0&&this.performMapDamage())},Game_Actor.prototype.checkFloorEffect=function(){$gamePlayer.isOnDamageFloor()&&this.executeFloorDamage()},Game_Actor.prototype.executeFloorDamage=function(){var a=Math.floor(this.basicFloorDamage()*this.fdr);a=Math.min(a,this.maxFloorDamage()),this.gainHp(-a),a>0&&this.performMapDamage()},Game_Actor.prototype.basicFloorDamage=function(){return 10},Game_Actor.prototype.maxFloorDamage=function(){return $dataSystem.optFloorDeath?this.hp:Math.max(this.hp-1,0)},Game_Actor.prototype.performMapDamage=function(){$gameParty.inBattle()||$gameScreen.startFlashForDamage()},Game_Actor.prototype.clearActions=function(){Game_Battler.prototype.clearActions.call(this),this._actionInputIndex=0},Game_Actor.prototype.inputtingAction=function(){return this.action(this._actionInputIndex)},Game_Actor.prototype.selectNextCommand=function(){return this._actionInputIndex<this.numActions()-1?(this._actionInputIndex++,!0):!1},Game_Actor.prototype.selectPreviousCommand=function(){return this._actionInputIndex>0?(this._actionInputIndex--,!0):!1},Game_Actor.prototype.lastMenuSkill=function(){return this._lastMenuSkill.object()},Game_Actor.prototype.setLastMenuSkill=function(a){this._lastMenuSkill.setObject(a)},Game_Actor.prototype.lastBattleSkill=function(){return this._lastBattleSkill.object()},Game_Actor.prototype.setLastBattleSkill=function(a){this._lastBattleSkill.setObject(a)},Game_Actor.prototype.lastCommandSymbol=function(){return this._lastCommandSymbol},Game_Actor.prototype.setLastCommandSymbol=function(a){this._lastCommandSymbol=a},Game_Enemy.prototype=Object.create(Game_Battler.prototype),Game_Enemy.prototype.constructor=Game_Enemy,Game_Enemy.prototype.initialize=function(a,b,c){Game_Battler.prototype.initialize.call(this),this.setup(a,b,c)},Game_Enemy.prototype.initMembers=function(){Game_Battler.prototype.initMembers.call(this),this._enemyId=0,this._letter="",this._plural=!1,this._screenX=0,this._screenY=0},Game_Enemy.prototype.setup=function(a,b,c){this._enemyId=a,this._screenX=b,this._screenY=c,this.recoverAll()},Game_Enemy.prototype.isEnemy=function(){return!0},Game_Enemy.prototype.friendsUnit=function(){return $gameTroop},Game_Enemy.prototype.opponentsUnit=function(){return $gameParty},Game_Enemy.prototype.index=function(){return $gameTroop.members().indexOf(this)},Game_Enemy.prototype.isBattleMember=function(){return this.index()>=0},Game_Enemy.prototype.enemyId=function(){return this._enemyId},Game_Enemy.prototype.enemy=function(){return $dataEnemies[this._enemyId]},Game_Enemy.prototype.traitObjects=function(){return Game_Battler.prototype.traitObjects.call(this).concat(this.enemy())},Game_Enemy.prototype.paramBase=function(a){return this.enemy().params[a]},Game_Enemy.prototype.exp=function(){return this.enemy().exp},Game_Enemy.prototype.gold=function(){return this.enemy().gold},Game_Enemy.prototype.makeDropItems=function(){return this.enemy().dropItems.reduce(function(a,b){return b.kind>0&&Math.random()*b.denominator<this.dropItemRate()?a.concat(this.itemObject(b.kind,b.dataId)):a}.bind(this),[])},Game_Enemy.prototype.dropItemRate=function(){return $gameParty.hasDropItemDouble()?2:1},Game_Enemy.prototype.itemObject=function(a,b){return 1===a?$dataItems[b]:2===a?$dataWeapons[b]:3===a?$dataArmors[b]:null},Game_Enemy.prototype.isSpriteVisible=function(){return!0},Game_Enemy.prototype.screenX=function(){return this._screenX},Game_Enemy.prototype.screenY=function(){return this._screenY},Game_Enemy.prototype.battlerName=function(){return this.enemy().battlerName},Game_Enemy.prototype.battlerHue=function(){return this.enemy().battlerHue},Game_Enemy.prototype.originalName=function(){return this.enemy().name},Game_Enemy.prototype.name=function(){return this.originalName()+(this._plural?this._letter:"")},Game_Enemy.prototype.isLetterEmpty=function(){return""===this._letter},Game_Enemy.prototype.setLetter=function(a){this._letter=a},Game_Enemy.prototype.setPlural=function(a){this._plural=a},Game_Enemy.prototype.performActionStart=function(a){Game_Battler.prototype.performActionStart.call(this,a),this.requestEffect("whiten")},Game_Enemy.prototype.performAction=function(a){Game_Battler.prototype.performAction.call(this,a)},Game_Enemy.prototype.performActionEnd=function(){Game_Battler.prototype.performActionEnd.call(this)},Game_Enemy.prototype.performDamage=function(){Game_Battler.prototype.performDamage.call(this),SoundManager.playEnemyDamage(),this.requestEffect("blink")},Game_Enemy.prototype.performCollapse=function(){switch(Game_Battler.prototype.performCollapse.call(this),this.collapseType()){case 0:this.requestEffect("collapse"),SoundManager.playEnemyCollapse();break;case 1:this.requestEffect("bossCollapse"),SoundManager.playBossCollapse1();break;case 2:this.requestEffect("instantCollapse")}},Game_Enemy.prototype.transform=function(a){var b=this.originalName();this._enemyId=a,this.originalName()!==b&&(this._letter="",this._plural=!1),this.refresh(),this.numActions()>0&&this.makeActions()},Game_Enemy.prototype.meetsCondition=function(a){var b=a.conditionParam1,c=a.conditionParam2;switch(a.conditionType){case 1:return this.meetsTurnCondition(b,c);case 2:return this.meetsHpCondition(b,c);case 3:return this.meetsMpCondition(b,c);case 4:return this.meetsStateCondition(b);case 5:return this.meetsPartyLevelCondition(b);case 6:return this.meetsSwitchCondition(b);default:return!0}},Game_Enemy.prototype.meetsTurnCondition=function(a,b){var c=$gameTroop.turnCount();return 0===b?c===a:c>0&&c>=a&&c%b===a%b},Game_Enemy.prototype.meetsHpCondition=function(a,b){return this.hpRate()>=a&&this.hpRate()<=b},Game_Enemy.prototype.meetsMpCondition=function(a,b){return this.mpRate()>=a&&this.mpRate()<=b},Game_Enemy.prototype.meetsStateCondition=function(a){return this.isStateAffected(a)},Game_Enemy.prototype.meetsPartyLevelCondition=function(a){return $gameParty.highestLevel()>=a},Game_Enemy.prototype.meetsSwitchCondition=function(a){return $gameSwitches.value(a)},Game_Enemy.prototype.isActionValid=function(a){return this.meetsCondition(a)&&this.canUse($dataSkills[a.skillId])},Game_Enemy.prototype.selectAction=function(a,b){var c=a.reduce(function(a,c){return a+c.rating-b},0);if(!(c>0))return null;for(var d=Math.randomInt(c),e=0;e<a.length;e++){var f=a[e];if(d-=f.rating-b,0>d)return f}},Game_Enemy.prototype.selectAllActions=function(a){var b=Math.max.apply(null,a.map(function(a){return a.rating})),c=b-3;a=a.filter(function(a){return a.rating>c});for(var d=0;d<this.numActions();d++)this.action(d).setEnemyAction(this.selectAction(a,c))},Game_Enemy.prototype.makeActions=function(){if(Game_Battler.prototype.makeActions.call(this),this.numActions()>0){var a=this.enemy().actions.filter(function(a){return this.isActionValid(a)},this);a.length>0&&this.selectAllActions(a)}this.setActionState("waiting")},Game_Actors.prototype.initialize=function(){this._data=[]},Game_Actors.prototype.actor=function(a){return $dataActors[a]?(this._data[a]||(this._data[a]=new Game_Actor(a)),this._data[a]):null},Game_Unit.prototype.initialize=function(){this._inBattle=!1},Game_Unit.prototype.inBattle=function(){return this._inBattle},Game_Unit.prototype.members=function(){return[]},Game_Unit.prototype.aliveMembers=function(){return this.members().filter(function(a){return a.isAlive()})},Game_Unit.prototype.deadMembers=function(){return this.members().filter(function(a){return a.isDead()})},Game_Unit.prototype.movableMembers=function(){return this.members().filter(function(a){return a.canMove()})},Game_Unit.prototype.clearActions=function(){return this.members().forEach(function(a){return a.clearActions()})},Game_Unit.prototype.agility=function(){var a=this.members();if(0===a.length)return 1;var b=a.reduce(function(a,b){return a+b.agi},0);return b/a.length},Game_Unit.prototype.tgrSum=function(){return this.aliveMembers().reduce(function(a,b){return a+b.tgr},0)},Game_Unit.prototype.randomTarget=function(){var a=Math.random()*this.tgrSum(),b=null;return this.aliveMembers().forEach(function(c){a-=c.tgr,0>=a&&!b&&(b=c)}),b},Game_Unit.prototype.randomDeadTarget=function(){var a=this.deadMembers();return 0===a.length?null:a[Math.floor(Math.random()*a.length)]},Game_Unit.prototype.smoothTarget=function(a){0>a&&(a=0);var b=this.members()[a];return b&&b.isAlive()?b:this.aliveMembers()[0]},Game_Unit.prototype.smoothDeadTarget=function(a){0>a&&(a=0);var b=this.members()[a];return b&&b.isDead()?b:this.deadMembers()[0]},Game_Unit.prototype.clearResults=function(){this.members().forEach(function(a){a.clearResult()})},Game_Unit.prototype.onBattleStart=function(){this.members().forEach(function(a){a.onBattleStart()}),this._inBattle=!0},Game_Unit.prototype.onBattleEnd=function(){this._inBattle=!1,this.members().forEach(function(a){a.onBattleEnd()})},Game_Unit.prototype.makeActions=function(){this.members().forEach(function(a){a.makeActions()})},Game_Unit.prototype.select=function(a){this.members().forEach(function(b){b===a?b.select():b.deselect()})},Game_Unit.prototype.isAllDead=function(){return 0===this.aliveMembers().length},Game_Unit.prototype.substituteBattler=function(){for(var a=this.members(),b=0;b<a.length;b++)if(a[b].isSubstitute())return a[b]},Game_Party.prototype=Object.create(Game_Unit.prototype),Game_Party.prototype.constructor=Game_Party,Game_Party.ABILITY_ENCOUNTER_HALF=0,Game_Party.ABILITY_ENCOUNTER_NONE=1,Game_Party.ABILITY_CANCEL_SURPRISE=2,Game_Party.ABILITY_RAISE_PREEMPTIVE=3,Game_Party.ABILITY_GOLD_DOUBLE=4,Game_Party.ABILITY_DROP_ITEM_DOUBLE=5,Game_Party.prototype.initialize=function(){Game_Unit.prototype.initialize.call(this),this._gold=0,this._steps=0,this._lastItem=new Game_Item,this._menuActorId=0,this._targetActorId=0,this._actors=[],this.initAllItems()},Game_Party.prototype.initAllItems=function(){this._items={},this._weapons={},this._armors={}},Game_Party.prototype.exists=function(){return this._actors.length>0},Game_Party.prototype.size=function(){return this.members().length},Game_Party.prototype.isEmpty=function(){return 0===this.size()},Game_Party.prototype.members=function(){return this.inBattle()?this.battleMembers():this.allMembers()},Game_Party.prototype.allMembers=function(){return this._actors.map(function(a){return $gameActors.actor(a)})},Game_Party.prototype.battleMembers=function(){return this.allMembers().slice(0,this.maxBattleMembers()).filter(function(a){return a.isAppeared()})},Game_Party.prototype.maxBattleMembers=function(){return 4},Game_Party.prototype.leader=function(){return this.battleMembers()[0]},Game_Party.prototype.reviveBattleMembers=function(){this.battleMembers().forEach(function(a){a.isDead()&&a.setHp(1)})},Game_Party.prototype.items=function(){var a=[];for(var b in this._items)a.push($dataItems[b]);return a},Game_Party.prototype.weapons=function(){var a=[];for(var b in this._weapons)a.push($dataWeapons[b]);return a},Game_Party.prototype.armors=function(){var a=[];for(var b in this._armors)a.push($dataArmors[b]);return a},Game_Party.prototype.equipItems=function(){return this.weapons().concat(this.armors())},Game_Party.prototype.allItems=function(){return this.items().concat(this.equipItems())},Game_Party.prototype.itemContainer=function(a){return a?DataManager.isItem(a)?this._items:DataManager.isWeapon(a)?this._weapons:DataManager.isArmor(a)?this._armors:null:null},Game_Party.prototype.setupStartingMembers=function(){this._actors=[],$dataSystem.partyMembers.forEach(function(a){$gameActors.actor(a)&&this._actors.push(a)},this)},Game_Party.prototype.name=function(){var a=this.battleMembers().length;return 0===a?"":1===a?this.leader().name():TextManager.partyName.format(this.leader().name())},Game_Party.prototype.setupBattleTest=function(){this.setupBattleTestMembers(),this.setupBattleTestItems()},Game_Party.prototype.setupBattleTestMembers=function(){$dataSystem.testBattlers.forEach(function(a){var b=$gameActors.actor(a.actorId);b&&(b.changeLevel(a.level,!1),b.initEquips(a.equips),b.recoverAll(),this.addActor(a.actorId))},this)},Game_Party.prototype.setupBattleTestItems=function(){$dataItems.forEach(function(a){a&&a.name.length>0&&this.gainItem(a,this.maxItems(a))},this)},Game_Party.prototype.highestLevel=function(){return Math.max.apply(null,this.members().map(function(a){return a.level}))},Game_Party.prototype.addActor=function(a){this._actors.contains(a)||(this._actors.push(a),$gamePlayer.refresh(),$gameMap.requestRefresh())},Game_Party.prototype.removeActor=function(a){this._actors.contains(a)&&(this._actors.splice(this._actors.indexOf(a),1),$gamePlayer.refresh(),$gameMap.requestRefresh())},Game_Party.prototype.gold=function(){return this._gold},Game_Party.prototype.gainGold=function(a){this._gold=(this._gold+a).clamp(0,this.maxGold())},Game_Party.prototype.loseGold=function(a){this.gainGold(-a)},Game_Party.prototype.maxGold=function(){return 99999999},Game_Party.prototype.steps=function(){return this._steps},Game_Party.prototype.increaseSteps=function(){this._steps++},Game_Party.prototype.numItems=function(a){var b=this.itemContainer(a);return b?b[a.id]||0:0},Game_Party.prototype.maxItems=function(a){return 99},Game_Party.prototype.hasMaxItems=function(a){return this.numItems(a)>=this.maxItems(a)},Game_Party.prototype.hasItem=function(a,b){return void 0===b&&(b=!1),this.numItems(a)>0?!0:b&&this.isAnyMemberEquipped(a)?!0:!1},Game_Party.prototype.isAnyMemberEquipped=function(a){return this.members().some(function(b){return b.equips().contains(a)})},Game_Party.prototype.gainItem=function(a,b,c){var d=this.itemContainer(a);if(d){var e=this.numItems(a),f=e+b;d[a.id]=f.clamp(0,this.maxItems(a)),0===d[a.id]&&delete d[a.id],c&&0>f&&this.discardMembersEquip(a,-f),$gameMap.requestRefresh()}},Game_Party.prototype.discardMembersEquip=function(a,b){var c=b;this.members().forEach(function(b){for(;c>0&&b.isEquipped(a);)b.discardEquip(a),c--})},Game_Party.prototype.loseItem=function(a,b,c){this.gainItem(a,-b,c)},Game_Party.prototype.consumeItem=function(a){DataManager.isItem(a)&&a.consumable&&this.loseItem(a,1)},Game_Party.prototype.canUse=function(a){return this.members().some(function(b){return b.canUse(a)})},Game_Party.prototype.canInput=function(){return this.members().some(function(a){return a.canInput()})},Game_Party.prototype.isAllDead=function(){return Game_Unit.prototype.isAllDead.call(this)?this.inBattle()||!this.isEmpty():!1},Game_Party.prototype.onPlayerWalk=function(){this.members().forEach(function(a){return a.onPlayerWalk()})},Game_Party.prototype.menuActor=function(){var a=$gameActors.actor(this._menuActorId);return this.members().contains(a)||(a=this.members()[0]),a},Game_Party.prototype.setMenuActor=function(a){this._menuActorId=a.actorId()},Game_Party.prototype.makeMenuActorNext=function(){var a=this.members().indexOf(this.menuActor());a>=0?(a=(a+1)%this.members().length,this.setMenuActor(this.members()[a])):this.setMenuActor(this.members()[0])},Game_Party.prototype.makeMenuActorPrevious=function(){var a=this.members().indexOf(this.menuActor());a>=0?(a=(a+this.members().length-1)%this.members().length,this.setMenuActor(this.members()[a])):this.setMenuActor(this.members()[0])},Game_Party.prototype.targetActor=function(){var a=$gameActors.actor(this._targetActorId);return this.members().contains(a)||(a=this.members()[0]),a},Game_Party.prototype.setTargetActor=function(a){this._targetActorId=a.actorId()},Game_Party.prototype.lastItem=function(){return this._lastItem.object()},Game_Party.prototype.setLastItem=function(a){this._lastItem.setObject(a)},Game_Party.prototype.swapOrder=function(a,b){var c=this._actors[a];this._actors[a]=this._actors[b],this._actors[b]=c,$gamePlayer.refresh()},Game_Party.prototype.charactersForSavefile=function(){return this.battleMembers().map(function(a){return[a.characterName(),a.characterIndex()]})},Game_Party.prototype.facesForSavefile=function(){return this.battleMembers().map(function(a){return[a.faceName(),a.faceIndex()]})},Game_Party.prototype.partyAbility=function(a){return this.battleMembers().some(function(b){return b.partyAbility(a)})},Game_Party.prototype.hasEncounterHalf=function(){return this.partyAbility(Game_Party.ABILITY_ENCOUNTER_HALF)},Game_Party.prototype.hasEncounterNone=function(){return this.partyAbility(Game_Party.ABILITY_ENCOUNTER_NONE)},Game_Party.prototype.hasCancelSurprise=function(){return this.partyAbility(Game_Party.ABILITY_CANCEL_SURPRISE);
},Game_Party.prototype.hasRaisePreemptive=function(){return this.partyAbility(Game_Party.ABILITY_RAISE_PREEMPTIVE)},Game_Party.prototype.hasGoldDouble=function(){return this.partyAbility(Game_Party.ABILITY_GOLD_DOUBLE)},Game_Party.prototype.hasDropItemDouble=function(){return this.partyAbility(Game_Party.ABILITY_DROP_ITEM_DOUBLE)},Game_Party.prototype.ratePreemptive=function(a){var b=this.agility()>=a?.05:.03;return this.hasRaisePreemptive()&&(b*=4),b},Game_Party.prototype.rateSurprise=function(a){var b=this.agility()>=a?.03:.05;return this.hasCancelSurprise()&&(b=0),b},Game_Party.prototype.performVictory=function(){this.members().forEach(function(a){a.performVictory()})},Game_Party.prototype.performEscape=function(){this.members().forEach(function(a){a.performEscape()})},Game_Party.prototype.removeBattleStates=function(){this.members().forEach(function(a){a.removeBattleStates()})},Game_Party.prototype.requestMotionRefresh=function(){this.members().forEach(function(a){a.requestMotionRefresh()})},Game_Troop.prototype=Object.create(Game_Unit.prototype),Game_Troop.prototype.constructor=Game_Troop,Game_Troop.LETTER_TABLE_HALF=[" A"," B"," C"," D"," E"," F"," G"," H"," I"," J"," K"," L"," M"," N"," O"," P"," Q"," R"," S"," T"," U"," V"," W"," X"," Y"," Z"],Game_Troop.LETTER_TABLE_FULL=["","","","","","","","","","","","","","","","","","","","","","","","","",""],Game_Troop.prototype.initialize=function(){Game_Unit.prototype.initialize.call(this),this._interpreter=new Game_Interpreter,this.clear()},Game_Troop.prototype.isEventRunning=function(){return this._interpreter.isRunning()},Game_Troop.prototype.updateInterpreter=function(){this._interpreter.update()},Game_Troop.prototype.turnCount=function(){return this._turnCount},Game_Troop.prototype.members=function(){return this._enemies},Game_Troop.prototype.clear=function(){this._interpreter.clear(),this._troopId=0,this._eventFlags={},this._enemies=[],this._turnCount=0,this._namesCount={}},Game_Troop.prototype.troop=function(){return $dataTroops[this._troopId]},Game_Troop.prototype.setup=function(a){this.clear(),this._troopId=a,this._enemies=[],this.troop().members.forEach(function(a){if($dataEnemies[a.enemyId]){var b=a.enemyId,c=a.x,d=a.y,e=new Game_Enemy(b,c,d);a.hidden&&e.hide(),this._enemies.push(e)}},this),this.makeUniqueNames()},Game_Troop.prototype.makeUniqueNames=function(){var a=this.letterTable();this.members().forEach(function(b){if(b.isAlive()&&b.isLetterEmpty()){var c=b.originalName(),d=this._namesCount[c]||0;b.setLetter(a[d%a.length]),this._namesCount[c]=d+1}},this),this.members().forEach(function(a){var b=a.originalName();this._namesCount[b]>=2&&a.setPlural(!0)},this)},Game_Troop.prototype.letterTable=function(){return $gameSystem.isCJK()?Game_Troop.LETTER_TABLE_FULL:Game_Troop.LETTER_TABLE_HALF},Game_Troop.prototype.enemyNames=function(){var a=[];return this.members().forEach(function(b){var c=b.originalName();b.isAlive()&&!a.contains(c)&&a.push(c)}),a},Game_Troop.prototype.meetsConditions=function(a){var b=a.conditions;if(!(b.turnEnding||b.turnValid||b.enemyValid||b.actorValid||b.switchValid))return!1;if(b.turnEnding&&!BattleManager.isTurnEnd())return!1;if(b.turnValid){var c=this._turnCount,d=b.turnA,e=b.turnB;if(0===e&&c!==d)return!1;if(e>0&&(1>c||d>c||c%e!==d%e))return!1}if(b.enemyValid){var f=$gameTroop.members()[b.enemyIndex];if(!f||100*f.hpRate()>b.enemyHp)return!1}if(b.actorValid){var g=$gameActors.actor(b.actorId);if(!g||100*g.hpRate()>b.actorHp)return!1}return b.switchValid&&!$gameSwitches.value(b.switchId)?!1:!0},Game_Troop.prototype.setupBattleEvent=function(){if(!this._interpreter.isRunning()){if(this._interpreter.setupReservedCommonEvent())return;for(var a=this.troop().pages,b=0;b<a.length;b++){var c=a[b];if(this.meetsConditions(c)&&!this._eventFlags[b]){this._interpreter.setup(c.list),c.span<=1&&(this._eventFlags[b]=!0);break}}}},Game_Troop.prototype.increaseTurn=function(){for(var a=this.troop().pages,b=0;b<a.length;b++){var c=a[b];1===c.span&&(this._eventFlags[b]=!1)}this._turnCount++},Game_Troop.prototype.expTotal=function(){return this.deadMembers().reduce(function(a,b){return a+b.exp()},0)},Game_Troop.prototype.goldTotal=function(){return this.deadMembers().reduce(function(a,b){return a+b.gold()},0)*this.goldRate()},Game_Troop.prototype.goldRate=function(){return $gameParty.hasGoldDouble()?2:1},Game_Troop.prototype.makeDropItems=function(){return this.deadMembers().reduce(function(a,b){return a.concat(b.makeDropItems())},[])},Game_Map.prototype.initialize=function(){this._interpreter=new Game_Interpreter,this._mapId=0,this._tilesetId=0,this._events=[],this._commonEvents=[],this._vehicles=[],this._displayX=0,this._displayY=0,this._nameDisplay=!0,this._scrollDirection=2,this._scrollRest=0,this._scrollSpeed=4,this._parallaxName="",this._parallaxZero=!1,this._parallaxLoopX=!1,this._parallaxLoopY=!1,this._parallaxSx=0,this._parallaxSy=0,this._parallaxX=0,this._parallaxY=0,this._battleback1Name=null,this._battleback2Name=null,this.createVehicles()},Game_Map.prototype.setup=function(a){if(!$dataMap)throw new Error("The map data is not available");this._mapId=a,this._tilesetId=$dataMap.tilesetId,this._displayX=0,this._displayY=0,this.refereshVehicles(),this.setupEvents(),this.setupScroll(),this.setupParallax(),this.setupBattleback(),this._needsRefresh=!1},Game_Map.prototype.isEventRunning=function(){return this._interpreter.isRunning()||this.isAnyEventStarting()},Game_Map.prototype.tileWidth=function(){return 48},Game_Map.prototype.tileHeight=function(){return 48},Game_Map.prototype.mapId=function(){return this._mapId},Game_Map.prototype.tilesetId=function(){return this._tilesetId},Game_Map.prototype.displayX=function(){return this._displayX},Game_Map.prototype.displayY=function(){return this._displayY},Game_Map.prototype.parallaxName=function(){return this._parallaxName},Game_Map.prototype.battleback1Name=function(){return this._battleback1Name},Game_Map.prototype.battleback2Name=function(){return this._battleback2Name},Game_Map.prototype.requestRefresh=function(a){this._needsRefresh=!0},Game_Map.prototype.isNameDisplayEnabled=function(){return this._nameDisplay},Game_Map.prototype.disableNameDisplay=function(){this._nameDisplay=!1},Game_Map.prototype.enableNameDisplay=function(){this._nameDisplay=!0},Game_Map.prototype.createVehicles=function(){this._vehicles=[],this._vehicles[0]=new Game_Vehicle("boat"),this._vehicles[1]=new Game_Vehicle("ship"),this._vehicles[2]=new Game_Vehicle("airship")},Game_Map.prototype.refereshVehicles=function(){this._vehicles.forEach(function(a){a.refresh()})},Game_Map.prototype.vehicles=function(){return this._vehicles},Game_Map.prototype.vehicle=function(a){return 0===a||"boat"===a?this.boat():1===a||"ship"===a?this.ship():2===a||"airship"===a?this.airship():null},Game_Map.prototype.boat=function(){return this._vehicles[0]},Game_Map.prototype.ship=function(){return this._vehicles[1]},Game_Map.prototype.airship=function(){return this._vehicles[2]},Game_Map.prototype.setupEvents=function(){this._events=[];for(var a=0;a<$dataMap.events.length;a++)$dataMap.events[a]&&(this._events[a]=new Game_Event(this._mapId,a));this._commonEvents=this.parallelCommonEvents().map(function(a){return new Game_CommonEvent(a.id)}),this.refreshTileEvents()},Game_Map.prototype.events=function(){return this._events.filter(function(a){return!!a})},Game_Map.prototype.event=function(a){return this._events[a]},Game_Map.prototype.eraseEvent=function(a){this._events[a].erase()},Game_Map.prototype.parallelCommonEvents=function(){return $dataCommonEvents.filter(function(a){return a&&2===a.trigger})},Game_Map.prototype.setupScroll=function(){this._scrollDirection=2,this._scrollRest=0,this._scrollSpeed=4},Game_Map.prototype.setupParallax=function(){this._parallaxName=$dataMap.parallaxName||"",this._parallaxZero=ImageManager.isZeroParallax(this._parallaxName),this._parallaxLoopX=$dataMap.parallaxLoopX,this._parallaxLoopY=$dataMap.parallaxLoopY,this._parallaxSx=$dataMap.parallaxSx,this._parallaxSy=$dataMap.parallaxSy,this._parallaxX=0,this._parallaxY=0},Game_Map.prototype.setupBattleback=function(){$dataMap.specifyBattleback?(this._battleback1Name=$dataMap.battleback1Name,this._battleback2Name=$dataMap.battleback2Name):(this._battleback1Name=null,this._battleback2Name=null)},Game_Map.prototype.setDisplayPos=function(a,b){if(this.isLoopHorizontal())this._displayX=a.mod(this.width()),this._parallaxX=a;else{var c=this.width()-this.screenTileX();this._displayX=0>c?c/2:a.clamp(0,c),this._parallaxX=this._displayX}if(this.isLoopVertical())this._displayY=b.mod(this.height()),this._parallaxY=b;else{var d=this.height()-this.screenTileY();this._displayY=0>d?d/2:b.clamp(0,d),this._parallaxY=this._displayY}},Game_Map.prototype.parallaxOx=function(){return this._parallaxZero?this._parallaxX*this.tileWidth():this._parallaxLoopX?this._parallaxX*this.tileWidth()/2:0},Game_Map.prototype.parallaxOy=function(){return this._parallaxZero?this._parallaxY*this.tileHeight():this._parallaxLoopY?this._parallaxY*this.tileHeight()/2:0},Game_Map.prototype.tileset=function(){return $dataTilesets[this._tilesetId]},Game_Map.prototype.tilesetFlags=function(){var a=this.tileset();return a?a.flags:[]},Game_Map.prototype.displayName=function(){return $dataMap.displayName},Game_Map.prototype.width=function(){return $dataMap.width},Game_Map.prototype.height=function(){return $dataMap.height},Game_Map.prototype.data=function(){return $dataMap.data},Game_Map.prototype.isLoopHorizontal=function(){return 2===$dataMap.scrollType||3===$dataMap.scrollType},Game_Map.prototype.isLoopVertical=function(){return 1===$dataMap.scrollType||3===$dataMap.scrollType},Game_Map.prototype.isDashDisabled=function(){return $dataMap.disableDashing},Game_Map.prototype.encounterList=function(){return $dataMap.encounterList},Game_Map.prototype.encounterStep=function(){return $dataMap.encounterStep},Game_Map.prototype.isOverworld=function(){return this.tileset()&&0===this.tileset().mode},Game_Map.prototype.screenTileX=function(){return Graphics.width/this.tileWidth()},Game_Map.prototype.screenTileY=function(){return Graphics.height/this.tileHeight()},Game_Map.prototype.adjustX=function(a){return this.isLoopHorizontal()&&a<this._displayX-(this.width()-this.screenTileX())/2?a-this._displayX+$dataMap.width:a-this._displayX},Game_Map.prototype.adjustY=function(a){return this.isLoopVertical()&&a<this._displayY-(this.height()-this.screenTileY())/2?a-this._displayY+$dataMap.height:a-this._displayY},Game_Map.prototype.roundX=function(a){return this.isLoopHorizontal()?a.mod(this.width()):a},Game_Map.prototype.roundY=function(a){return this.isLoopVertical()?a.mod(this.height()):a},Game_Map.prototype.xWithDirection=function(a,b){return a+(6===b?1:4===b?-1:0)},Game_Map.prototype.yWithDirection=function(a,b){return a+(2===b?1:8===b?-1:0)},Game_Map.prototype.roundXWithDirection=function(a,b){return this.roundX(a+(6===b?1:4===b?-1:0))},Game_Map.prototype.roundYWithDirection=function(a,b){return this.roundY(a+(2===b?1:8===b?-1:0))},Game_Map.prototype.deltaX=function(a,b){var c=a-b;return this.isLoopHorizontal()&&Math.abs(c)>this.width()/2&&(0>c?c+=this.width():c-=this.width()),c},Game_Map.prototype.deltaY=function(a,b){var c=a-b;return this.isLoopVertical()&&Math.abs(c)>this.height()/2&&(0>c?c+=this.height():c-=this.height()),c},Game_Map.prototype.distance=function(a,b,c,d){return Math.abs(this.deltaX(a,c))+Math.abs(this.deltaY(b,d))},Game_Map.prototype.canvasToMapX=function(a){var b=this.tileWidth(),c=this._displayX*b,d=Math.floor((c+a)/b);return this.roundX(d)},Game_Map.prototype.canvasToMapY=function(a){var b=this.tileHeight(),c=this._displayY*b,d=Math.floor((c+a)/b);return this.roundY(d)},Game_Map.prototype.autoplay=function(){$dataMap.autoplayBgm&&AudioManager.playBgm($dataMap.bgm),$dataMap.autoplayBgs&&AudioManager.playBgs($dataMap.bgs)},Game_Map.prototype.refreshIfNeeded=function(){this._needsRefresh&&this.refresh()},Game_Map.prototype.refresh=function(){this.events().forEach(function(a){a.refresh()}),this._commonEvents.forEach(function(a){a.refresh()}),this.refreshTileEvents(),this._needsRefresh=!1},Game_Map.prototype.refreshTileEvents=function(){this.tileEvents=this.events().filter(function(a){return a.isTile()})},Game_Map.prototype.eventsXy=function(a,b){return this.events().filter(function(c){return c.pos(a,b)})},Game_Map.prototype.eventsXyNt=function(a,b){return this.events().filter(function(c){return c.posNt(a,b)})},Game_Map.prototype.tileEventsXy=function(a,b){return this.tileEvents.filter(function(c){return c.posNt(a,b)})},Game_Map.prototype.eventIdXy=function(a,b){var c=this.eventsXy(a,b);return 0===c.length?0:c[0].eventId()},Game_Map.prototype.scrollDown=function(a){if(this.isLoopVertical())this._displayY+=a,this._displayY%=$dataMap.height,this._parallaxLoopY&&(this._parallaxY+=a);else if(this.height()>=this.screenTileY()){var b=this._displayY;this._displayY=Math.min(this._displayY+a,this.height()-this.screenTileY()),this._parallaxY+=this._displayY-b}},Game_Map.prototype.scrollLeft=function(a){if(this.isLoopHorizontal())this._displayX+=$dataMap.width-a,this._displayX%=$dataMap.width,this._parallaxLoopX&&(this._parallaxX-=a);else if(this.width()>=this.screenTileX()){var b=this._displayX;this._displayX=Math.max(this._displayX-a,0),this._parallaxX+=this._displayX-b}},Game_Map.prototype.scrollRight=function(a){if(this.isLoopHorizontal())this._displayX+=a,this._displayX%=$dataMap.width,this._parallaxLoopX&&(this._parallaxX+=a);else if(this.width()>=this.screenTileX()){var b=this._displayX;this._displayX=Math.min(this._displayX+a,this.width()-this.screenTileX()),this._parallaxX+=this._displayX-b}},Game_Map.prototype.scrollUp=function(a){if(this.isLoopVertical())this._displayY+=$dataMap.height-a,this._displayY%=$dataMap.height,this._parallaxLoopY&&(this._parallaxY-=a);else if(this.height()>=this.screenTileY()){var b=this._displayY;this._displayY=Math.max(this._displayY-a,0),this._parallaxY+=this._displayY-b}},Game_Map.prototype.isValid=function(a,b){return a>=0&&a<this.width()&&b>=0&&b<this.height()},Game_Map.prototype.checkPassage=function(a,b,c){for(var d=this.tilesetFlags(),e=this.allTiles(a,b),f=0;f<e.length;f++){var g=d[e[f]];if(0===(16&g)){if(0===(g&c))return!0;if((g&c)===c)return!1}}return!1},Game_Map.prototype.tileId=function(a,b,c){var d=$dataMap.width,e=$dataMap.height;return $dataMap.data[(c*e+b)*d+a]||0},Game_Map.prototype.layeredTiles=function(a,b){for(var c=[],d=0;4>d;d++)c.push(this.tileId(a,b,3-d));return c},Game_Map.prototype.allTiles=function(a,b){var c=this.tileEventsXy(a,b).map(function(a){return a.tileId()});return c.concat(this.layeredTiles(a,b))},Game_Map.prototype.autotileType=function(a,b,c){var d=this.tileId(a,b,c);return d>=2048?Math.floor((d-2048)/48):-1},Game_Map.prototype.isPassable=function(a,b,c){return this.checkPassage(a,b,1<<c/2-1&15)},Game_Map.prototype.isBoatPassable=function(a,b){return this.checkPassage(a,b,512)},Game_Map.prototype.isShipPassable=function(a,b){return this.checkPassage(a,b,1024)},Game_Map.prototype.isAirshipLandOk=function(a,b){return this.checkPassage(a,b,2048)&&this.checkPassage(a,b,15)},Game_Map.prototype.checkLayeredTilesFlags=function(a,b,c){var d=this.tilesetFlags();return this.layeredTiles(a,b).some(function(a){return 0!==(d[a]&c)})},Game_Map.prototype.isLadder=function(a,b){return this.isValid(a,b)&&this.checkLayeredTilesFlags(a,b,32)},Game_Map.prototype.isBush=function(a,b){return this.isValid(a,b)&&this.checkLayeredTilesFlags(a,b,64)},Game_Map.prototype.isCounter=function(a,b){return this.isValid(a,b)&&this.checkLayeredTilesFlags(a,b,128)},Game_Map.prototype.isDamageFloor=function(a,b){return this.isValid(a,b)&&this.checkLayeredTilesFlags(a,b,256)},Game_Map.prototype.terrainTag=function(a,b){if(this.isValid(a,b))for(var c=this.tilesetFlags(),d=this.layeredTiles(a,b),e=0;e<d.length;e++){var f=c[d[e]]>>12;if(f>0)return f}return 0},Game_Map.prototype.regionId=function(a,b){return this.isValid(a,b)?this.tileId(a,b,5):0},Game_Map.prototype.startScroll=function(a,b,c){this._scrollDirection=a,this._scrollRest=b,this._scrollSpeed=c},Game_Map.prototype.isScrolling=function(){return this._scrollRest>0},Game_Map.prototype.update=function(a){this.refreshIfNeeded(),a&&this.updateInterpreter(),this.updateScroll(),this.updateEvents(),this.updateVehicles(),this.updateParallax()},Game_Map.prototype.updateScroll=function(){if(this.isScrolling()){var a=this._displayX,b=this._displayY;this.doScroll(this._scrollDirection,this.scrollDistance()),this._displayX===a&&this._displayY===b?this._scrollRest=0:this._scrollRest-=this.scrollDistance()}},Game_Map.prototype.scrollDistance=function(){return Math.pow(2,this._scrollSpeed)/256},Game_Map.prototype.doScroll=function(a,b){switch(a){case 2:this.scrollDown(b);break;case 4:this.scrollLeft(b);break;case 6:this.scrollRight(b);break;case 8:this.scrollUp(b)}},Game_Map.prototype.updateEvents=function(){this.events().forEach(function(a){a.update()}),this._commonEvents.forEach(function(a){a.update()})},Game_Map.prototype.updateVehicles=function(){this._vehicles.forEach(function(a){a.update()})},Game_Map.prototype.updateParallax=function(){this._parallaxLoopX&&(this._parallaxX+=this._parallaxSx/this.tileWidth()/2),this._parallaxLoopY&&(this._parallaxY+=this._parallaxSy/this.tileHeight()/2)},Game_Map.prototype.changeTileset=function(a){this._tilesetId=a,this.refresh()},Game_Map.prototype.changeBattleback=function(a,b){this._battleback1Name=a,this._battleback2Name=b},Game_Map.prototype.changeParallax=function(a,b,c,d,e){this._parallaxName=a,this._parallaxZero=ImageManager.isZeroParallax(this._parallaxName),this._parallaxLoopX&&!b&&(this._parallaxX=0),this._parallaxLoopY&&!c&&(this._parallaxY=0),this._parallaxLoopX=b,this._parallaxLoopY=c,this._parallaxSx=d,this._parallaxSy=e},Game_Map.prototype.updateInterpreter=function(){for(;;){if(this._interpreter.update(),this._interpreter.isRunning())return;if(this._interpreter.eventId()>0&&(this.unlockEvent(this._interpreter.eventId()),this._interpreter.clear()),!this.setupStartingEvent())return}},Game_Map.prototype.unlockEvent=function(a){this._events[a]&&this._events[a].unlock()},Game_Map.prototype.setupStartingEvent=function(){return this.refreshIfNeeded(),this._interpreter.setupReservedCommonEvent()?!0:this.setupTestEvent()?!0:this.setupStartingMapEvent()?!0:this.setupAutorunCommonEvent()?!0:!1},Game_Map.prototype.setupTestEvent=function(){return $testEvent?(this._interpreter.setup($testEvent,0),$testEvent=null,!0):!1},Game_Map.prototype.setupStartingMapEvent=function(){for(var a=this.events(),b=0;b<a.length;b++){var c=a[b];if(c.isStarting())return c.clearStartingFlag(),this._interpreter.setup(c.list(),c.eventId()),!0}return!1},Game_Map.prototype.setupAutorunCommonEvent=function(){for(var a=0;a<$dataCommonEvents.length;a++){var b=$dataCommonEvents[a];if(b&&1===b.trigger&&$gameSwitches.value(b.switchId))return this._interpreter.setup(b.list),!0}return!1},Game_Map.prototype.isAnyEventStarting=function(){return this.events().some(function(a){return a.isStarting()})},Game_CommonEvent.prototype.initialize=function(a){this._commonEventId=a,this.refresh()},Game_CommonEvent.prototype.event=function(){return $dataCommonEvents[this._commonEventId]},Game_CommonEvent.prototype.list=function(){return this.event().list},Game_CommonEvent.prototype.refresh=function(){this.isActive()?this._interpreter||(this._interpreter=new Game_Interpreter):this._interpreter=null},Game_CommonEvent.prototype.isActive=function(){var a=this.event();return 2===a.trigger&&$gameSwitches.value(a.switchId)},Game_CommonEvent.prototype.update=function(){this._interpreter&&(this._interpreter.isRunning()||this._interpreter.setup(this.list()),this._interpreter.update())},Object.defineProperties(Game_CharacterBase.prototype,{x:{get:function(){return this._x},configurable:!0},y:{get:function(){return this._y},configurable:!0}}),Game_CharacterBase.prototype.initialize=function(){this.initMembers()},Game_CharacterBase.prototype.initMembers=function(){this._x=0,this._y=0,this._realX=0,this._realY=0,this._moveSpeed=4,this._moveFrequency=6,this._opacity=255,this._blendMode=0,this._direction=2,this._pattern=1,this._priorityType=1,this._tileId=0,this._characterName="",this._characterIndex=0,this._isObjectCharacter=!1,this._walkAnime=!0,this._stepAnime=!1,this._directionFix=!1,this._through=!1,this._transparent=!1,this._bushDepth=0,this._animationId=0,this._balloonId=0,this._animationPlaying=!1,this._balloonPlaying=!1,this._animationCount=0,this._stopCount=0,this._jumpCount=0,this._jumpPeak=0,this._movementSuccess=!0},Game_CharacterBase.prototype.pos=function(a,b){return this._x===a&&this._y===b},Game_CharacterBase.prototype.posNt=function(a,b){return this.pos(a,b)&&!this.isThrough()},Game_CharacterBase.prototype.moveSpeed=function(){return this._moveSpeed},Game_CharacterBase.prototype.setMoveSpeed=function(a){this._moveSpeed=a},Game_CharacterBase.prototype.moveFrequency=function(){return this._moveFrequency},Game_CharacterBase.prototype.setMoveFrequency=function(a){this._moveFrequency=a},Game_CharacterBase.prototype.opacity=function(){return this._opacity},Game_CharacterBase.prototype.setOpacity=function(a){this._opacity=a},Game_CharacterBase.prototype.blendMode=function(){return this._blendMode},Game_CharacterBase.prototype.setBlendMode=function(a){this._blendMode=a},Game_CharacterBase.prototype.isNormalPriority=function(){return 1===this._priorityType},Game_CharacterBase.prototype.setPriorityType=function(a){this._priorityType=a},Game_CharacterBase.prototype.isMoving=function(){return this._realX!==this._x||this._realY!==this._y},Game_CharacterBase.prototype.isJumping=function(){return this._jumpCount>0},Game_CharacterBase.prototype.jumpHeight=function(){return(this._jumpPeak*this._jumpPeak-Math.pow(Math.abs(this._jumpCount-this._jumpPeak),2))/2},Game_CharacterBase.prototype.isStopping=function(){return!this.isMoving()&&!this.isJumping()},Game_CharacterBase.prototype.checkStop=function(a){return this._stopCount>a},Game_CharacterBase.prototype.resetStopCount=function(){this._stopCount=0},Game_CharacterBase.prototype.realMoveSpeed=function(){return this._moveSpeed+(this.isDashing()?1:0)},Game_CharacterBase.prototype.distancePerFrame=function(){return Math.pow(2,this.realMoveSpeed())/256},Game_CharacterBase.prototype.isDashing=function(){return!1},Game_CharacterBase.prototype.isDebugThrough=function(){return!1},Game_CharacterBase.prototype.straighten=function(){(this.hasWalkAnime()||this.hasStepAnime())&&(this._pattern=1),this._animationCount=0},Game_CharacterBase.prototype.reverseDir=function(a){return 10-a},Game_CharacterBase.prototype.canPass=function(a,b,c){var d=$gameMap.roundXWithDirection(a,c),e=$gameMap.roundYWithDirection(b,c);return $gameMap.isValid(d,e)?this.isThrough()||this.isDebugThrough()?!0:this.isMapPassable(a,b,c)?this.isCollidedWithCharacters(d,e)?!1:!0:!1:!1},Game_CharacterBase.prototype.canPassDiagonally=function(a,b,c,d){var e=$gameMap.roundXWithDirection(a,c),f=$gameMap.roundYWithDirection(b,d);return this.canPass(a,b,d)&&this.canPass(a,f,c)?!0:this.canPass(a,b,c)&&this.canPass(e,b,d)?!0:!1},Game_CharacterBase.prototype.isMapPassable=function(a,b,c){var d=$gameMap.roundXWithDirection(a,c),e=$gameMap.roundYWithDirection(b,c),f=this.reverseDir(c);return $gameMap.isPassable(a,b,c)&&$gameMap.isPassable(d,e,f)},Game_CharacterBase.prototype.isCollidedWithCharacters=function(a,b){return this.isCollidedWithEvents(a,b)||this.isCollidedWithVehicles(a,b)},Game_CharacterBase.prototype.isCollidedWithEvents=function(a,b){var c=$gameMap.eventsXyNt(a,b);return c.some(function(a){return a.isNormalPriority()})},Game_CharacterBase.prototype.isCollidedWithVehicles=function(a,b){return $gameMap.boat().posNt(a,b)||$gameMap.ship().posNt(a,b)},Game_CharacterBase.prototype.setPosition=function(a,b){this._x=Math.round(a),this._y=Math.round(b),this._realX=a,this._realY=b},Game_CharacterBase.prototype.copyPosition=function(a){this._x=a._x,this._y=a._y,this._realX=a._realX,this._realY=a._realY,this._direction=a._direction},Game_CharacterBase.prototype.locate=function(a,b){this.setPosition(a,b),this.straighten(),this.refreshBushDepth()},Game_CharacterBase.prototype.direction=function(){return this._direction},Game_CharacterBase.prototype.setDirection=function(a){!this.isDirectionFixed()&&a&&(this._direction=a),this.resetStopCount()},Game_CharacterBase.prototype.isTile=function(){return this._tileId>0&&0===this._priorityType},Game_CharacterBase.prototype.isObjectCharacter=function(){return this._isObjectCharacter},Game_CharacterBase.prototype.shiftY=function(){return this.isObjectCharacter()?0:6},Game_CharacterBase.prototype.scrolledX=function(){return $gameMap.adjustX(this._realX)},Game_CharacterBase.prototype.scrolledY=function(){return $gameMap.adjustY(this._realY)},Game_CharacterBase.prototype.screenX=function(){var a=$gameMap.tileWidth();return Math.round(this.scrolledX()*a+a/2)},Game_CharacterBase.prototype.screenY=function(){var a=$gameMap.tileHeight();return Math.round(this.scrolledY()*a+a-this.shiftY()-this.jumpHeight())},Game_CharacterBase.prototype.screenZ=function(){return 2*this._priorityType+1},Game_CharacterBase.prototype.isNearTheScreen=function(){var a=Graphics.width,b=Graphics.height,c=$gameMap.tileWidth(),d=$gameMap.tileHeight(),e=this.scrolledX()*c+c/2-a/2,f=this.scrolledY()*d+d/2-b/2;return e>=-a&&a>=e&&f>=-b&&b>=f},Game_CharacterBase.prototype.update=function(){this.isStopping()&&this.updateStop(),this.isJumping()?this.updateJump():this.isMoving()&&this.updateMove(),this.updateAnimation()},Game_CharacterBase.prototype.updateStop=function(){this._stopCount++},Game_CharacterBase.prototype.updateJump=function(){this._jumpCount--,this._realX=(this._realX*this._jumpCount+this._x)/(this._jumpCount+1),this._realY=(this._realY*this._jumpCount+this._y)/(this._jumpCount+1),this.refreshBushDepth(),0===this._jumpCount&&(this._realX=this._x=$gameMap.roundX(this._x),this._realY=this._y=$gameMap.roundY(this._y))},Game_CharacterBase.prototype.updateMove=function(){this._x<this._realX&&(this._realX=Math.max(this._realX-this.distancePerFrame(),this._x)),this._x>this._realX&&(this._realX=Math.min(this._realX+this.distancePerFrame(),this._x)),this._y<this._realY&&(this._realY=Math.max(this._realY-this.distancePerFrame(),this._y)),this._y>this._realY&&(this._realY=Math.min(this._realY+this.distancePerFrame(),this._y)),this.isMoving()||this.refreshBushDepth()},Game_CharacterBase.prototype.updateAnimation=function(){this.updateAnimationCount(),this._animationCount>=this.animationWait()&&(this.updatePattern(),this._animationCount=0)},Game_CharacterBase.prototype.animationWait=function(){return 3*(9-this.realMoveSpeed())},Game_CharacterBase.prototype.updateAnimationCount=function(){this.isMoving()&&this.hasWalkAnime()?this._animationCount+=1.5:(this.hasStepAnime()||!this.isOriginalPattern())&&this._animationCount++},Game_CharacterBase.prototype.updatePattern=function(){!this.hasStepAnime()&&this._stopCount>0?this.resetPattern():this._pattern=(this._pattern+1)%this.maxPattern()},Game_CharacterBase.prototype.maxPattern=function(){return 4},Game_CharacterBase.prototype.pattern=function(){return this._pattern<3?this._pattern:1},Game_CharacterBase.prototype.setPattern=function(a){this._pattern=a},Game_CharacterBase.prototype.isOriginalPattern=function(){return 1===this.pattern()},Game_CharacterBase.prototype.resetPattern=function(){this.setPattern(1)},Game_CharacterBase.prototype.refreshBushDepth=function(){this.isNormalPriority()&&!this.isObjectCharacter()&&this.isOnBush()&&!this.isJumping()?this.isMoving()||(this._bushDepth=12):this._bushDepth=0},Game_CharacterBase.prototype.isOnLadder=function(){return $gameMap.isLadder(this._x,this._y)},Game_CharacterBase.prototype.isOnBush=function(){return $gameMap.isBush(this._x,this._y)},Game_CharacterBase.prototype.terrainTag=function(){return $gameMap.terrainTag(this._x,this._y)},Game_CharacterBase.prototype.regionId=function(){return $gameMap.regionId(this._x,this._y)},Game_CharacterBase.prototype.increaseSteps=function(){this.isOnLadder()&&this.setDirection(8),this.resetStopCount(),this.refreshBushDepth()},Game_CharacterBase.prototype.tileId=function(){return this._tileId},Game_CharacterBase.prototype.characterName=function(){return this._characterName},Game_CharacterBase.prototype.characterIndex=function(){return this._characterIndex},Game_CharacterBase.prototype.setImage=function(a,b){this._tileId=0,this._characterName=a,this._characterIndex=b,this._isObjectCharacter=ImageManager.isObjectCharacter(a)},Game_CharacterBase.prototype.setTileImage=function(a){this._tileId=a,this._characterName="",this._characterIndex=0,this._isObjectCharacter=!0},Game_CharacterBase.prototype.checkEventTriggerTouchFront=function(a){var b=$gameMap.roundXWithDirection(this._x,a),c=$gameMap.roundYWithDirection(this._y,a);this.checkEventTriggerTouch(b,c)},Game_CharacterBase.prototype.checkEventTriggerTouch=function(a,b){return!1},Game_CharacterBase.prototype.isMovementSucceeded=function(a,b){return this._movementSuccess},Game_CharacterBase.prototype.setMovementSuccess=function(a){this._movementSuccess=a},Game_CharacterBase.prototype.moveStraight=function(a){this.setMovementSuccess(this.canPass(this._x,this._y,a)),this.isMovementSucceeded()?(this.setDirection(a),this._x=$gameMap.roundXWithDirection(this._x,a),this._y=$gameMap.roundYWithDirection(this._y,a),this._realX=$gameMap.xWithDirection(this._x,this.reverseDir(a)),this._realY=$gameMap.yWithDirection(this._y,this.reverseDir(a)),this.increaseSteps()):(this.setDirection(a),this.checkEventTriggerTouchFront(a))},Game_CharacterBase.prototype.moveDiagonally=function(a,b){this.setMovementSuccess(this.canPassDiagonally(this._x,this._y,a,b)),this.isMovementSucceeded()&&(this._x=$gameMap.roundXWithDirection(this._x,a),this._y=$gameMap.roundYWithDirection(this._y,b),this._realX=$gameMap.xWithDirection(this._x,this.reverseDir(a)),this._realY=$gameMap.yWithDirection(this._y,this.reverseDir(b)),this.increaseSteps()),this._direction===this.reverseDir(a)&&this.setDirection(a),this._direction===this.reverseDir(b)&&this.setDirection(b)},Game_CharacterBase.prototype.jump=function(a,b){Math.abs(a)>Math.abs(b)?0!==a&&this.setDirection(0>a?4:6):0!==b&&this.setDirection(0>b?8:2),this._x+=a,this._y+=b;var c=Math.round(Math.sqrt(a*a+b*b));this._jumpPeak=10+c-this._moveSpeed,this._jumpCount=2*this._jumpPeak,this.resetStopCount(),this.straighten()},Game_CharacterBase.prototype.hasWalkAnime=function(){return this._walkAnime},Game_CharacterBase.prototype.setWalkAnime=function(a){this._walkAnime=a},Game_CharacterBase.prototype.hasStepAnime=function(){return this._stepAnime},Game_CharacterBase.prototype.setStepAnime=function(a){this._stepAnime=a},Game_CharacterBase.prototype.isDirectionFixed=function(){return this._directionFix},Game_CharacterBase.prototype.setDirectionFix=function(a){this._directionFix=a},Game_CharacterBase.prototype.isThrough=function(){return this._through},Game_CharacterBase.prototype.setThrough=function(a){this._through=a},Game_CharacterBase.prototype.isTransparent=function(){return this._transparent},Game_CharacterBase.prototype.bushDepth=function(){return this._bushDepth},Game_CharacterBase.prototype.setTransparent=function(a){this._transparent=a},Game_CharacterBase.prototype.requestAnimation=function(a){this._animationId=a},Game_CharacterBase.prototype.requestBalloon=function(a){this._balloonId=a},Game_CharacterBase.prototype.animationId=function(){return this._animationId},Game_CharacterBase.prototype.balloonId=function(){return this._balloonId},Game_CharacterBase.prototype.startAnimation=function(){this._animationId=0,this._animationPlaying=!0},Game_CharacterBase.prototype.startBalloon=function(){this._balloonId=0,this._balloonPlaying=!0},Game_CharacterBase.prototype.isAnimationPlaying=function(){return this._animationId>0||this._animationPlaying},Game_CharacterBase.prototype.isBalloonPlaying=function(){return this._balloonId>0||this._balloonPlaying;
},Game_CharacterBase.prototype.endAnimation=function(){this._animationPlaying=!1},Game_CharacterBase.prototype.endBalloon=function(){this._balloonPlaying=!1},Game_Character.prototype=Object.create(Game_CharacterBase.prototype),Game_Character.prototype.constructor=Game_Character,Game_Character.ROUTE_END=0,Game_Character.ROUTE_MOVE_DOWN=1,Game_Character.ROUTE_MOVE_LEFT=2,Game_Character.ROUTE_MOVE_RIGHT=3,Game_Character.ROUTE_MOVE_UP=4,Game_Character.ROUTE_MOVE_LOWER_L=5,Game_Character.ROUTE_MOVE_LOWER_R=6,Game_Character.ROUTE_MOVE_UPPER_L=7,Game_Character.ROUTE_MOVE_UPPER_R=8,Game_Character.ROUTE_MOVE_RANDOM=9,Game_Character.ROUTE_MOVE_TOWARD=10,Game_Character.ROUTE_MOVE_AWAY=11,Game_Character.ROUTE_MOVE_FORWARD=12,Game_Character.ROUTE_MOVE_BACKWARD=13,Game_Character.ROUTE_JUMP=14,Game_Character.ROUTE_WAIT=15,Game_Character.ROUTE_TURN_DOWN=16,Game_Character.ROUTE_TURN_LEFT=17,Game_Character.ROUTE_TURN_RIGHT=18,Game_Character.ROUTE_TURN_UP=19,Game_Character.ROUTE_TURN_90D_R=20,Game_Character.ROUTE_TURN_90D_L=21,Game_Character.ROUTE_TURN_180D=22,Game_Character.ROUTE_TURN_90D_R_L=23,Game_Character.ROUTE_TURN_RANDOM=24,Game_Character.ROUTE_TURN_TOWARD=25,Game_Character.ROUTE_TURN_AWAY=26,Game_Character.ROUTE_SWITCH_ON=27,Game_Character.ROUTE_SWITCH_OFF=28,Game_Character.ROUTE_CHANGE_SPEED=29,Game_Character.ROUTE_CHANGE_FREQ=30,Game_Character.ROUTE_WALK_ANIME_ON=31,Game_Character.ROUTE_WALK_ANIME_OFF=32,Game_Character.ROUTE_STEP_ANIME_ON=33,Game_Character.ROUTE_STEP_ANIME_OFF=34,Game_Character.ROUTE_DIR_FIX_ON=35,Game_Character.ROUTE_DIR_FIX_OFF=36,Game_Character.ROUTE_THROUGH_ON=37,Game_Character.ROUTE_THROUGH_OFF=38,Game_Character.ROUTE_TRANSPARENT_ON=39,Game_Character.ROUTE_TRANSPARENT_OFF=40,Game_Character.ROUTE_CHANGE_IMAGE=41,Game_Character.ROUTE_CHANGE_OPACITY=42,Game_Character.ROUTE_CHANGE_BLEND_MODE=43,Game_Character.ROUTE_PLAY_SE=44,Game_Character.ROUTE_SCRIPT=45,Game_Character.prototype.initialize=function(){Game_CharacterBase.prototype.initialize.call(this)},Game_Character.prototype.initMembers=function(){Game_CharacterBase.prototype.initMembers.call(this),this._moveRouteForcing=!1,this._moveRoute=null,this._moveRouteIndex=0,this._originalMoveRoute=null,this._originalMoveRouteIndex=0,this._waitCount=0},Game_Character.prototype.memorizeMoveRoute=function(){this._originalMoveRoute=this._moveRoute,this._originalMoveRouteIndex=this._moveRouteIndex},Game_Character.prototype.restoreMoveRoute=function(){this._moveRoute=this._originalMoveRoute,this._moveRouteIndex=this._originalMoveRouteIndex,this._originalMoveRoute=null},Game_Character.prototype.isMoveRouteForcing=function(){return this._moveRouteForcing},Game_Character.prototype.setMoveRoute=function(a){this._moveRoute=a,this._moveRouteIndex=0,this._moveRouteForcing=!1},Game_Character.prototype.forceMoveRoute=function(a){this._originalMoveRoute||this.memorizeMoveRoute(),this._moveRoute=a,this._moveRouteIndex=0,this._moveRouteForcing=!0,this._waitCount=0},Game_Character.prototype.updateStop=function(){Game_CharacterBase.prototype.updateStop.call(this),this._moveRouteForcing&&this.updateRoutineMove()},Game_Character.prototype.updateRoutineMove=function(){if(this._waitCount>0)this._waitCount--;else{this.setMovementSuccess(!0);var a=this._moveRoute.list[this._moveRouteIndex];a&&(this.processMoveCommand(a),this.advanceMoveRouteIndex())}},Game_Character.prototype.processMoveCommand=function(command){var gc=Game_Character,params=command.parameters;switch(command.code){case gc.ROUTE_END:this.processRouteEnd();break;case gc.ROUTE_MOVE_DOWN:this.moveStraight(2);break;case gc.ROUTE_MOVE_LEFT:this.moveStraight(4);break;case gc.ROUTE_MOVE_RIGHT:this.moveStraight(6);break;case gc.ROUTE_MOVE_UP:this.moveStraight(8);break;case gc.ROUTE_MOVE_LOWER_L:this.moveDiagonally(4,2);break;case gc.ROUTE_MOVE_LOWER_R:this.moveDiagonally(6,2);break;case gc.ROUTE_MOVE_UPPER_L:this.moveDiagonally(4,8);break;case gc.ROUTE_MOVE_UPPER_R:this.moveDiagonally(6,8);break;case gc.ROUTE_MOVE_RANDOM:this.moveRandom();break;case gc.ROUTE_MOVE_TOWARD:this.moveTowardPlayer();break;case gc.ROUTE_MOVE_AWAY:this.moveAwayFromPlayer();break;case gc.ROUTE_MOVE_FORWARD:this.moveForward();break;case gc.ROUTE_MOVE_BACKWARD:this.moveBackward();break;case gc.ROUTE_JUMP:this.jump(params[0],params[1]);break;case gc.ROUTE_WAIT:this._waitCount=params[0]-1;break;case gc.ROUTE_TURN_DOWN:this.setDirection(2);break;case gc.ROUTE_TURN_LEFT:this.setDirection(4);break;case gc.ROUTE_TURN_RIGHT:this.setDirection(6);break;case gc.ROUTE_TURN_UP:this.setDirection(8);break;case gc.ROUTE_TURN_90D_R:this.turnRight90();break;case gc.ROUTE_TURN_90D_L:this.turnLeft90();break;case gc.ROUTE_TURN_180D:this.turn180();break;case gc.ROUTE_TURN_90D_R_L:this.turnRightOrLeft90();break;case gc.ROUTE_TURN_RANDOM:this.turnRandom();break;case gc.ROUTE_TURN_TOWARD:this.turnTowardPlayer();break;case gc.ROUTE_TURN_AWAY:this.turnAwayFromPlayer();break;case gc.ROUTE_SWITCH_ON:$gameSwitches.setValue(params[0],!0);break;case gc.ROUTE_SWITCH_OFF:$gameSwitches.setValue(params[0],!1);break;case gc.ROUTE_CHANGE_SPEED:this.setMoveSpeed(params[0]);break;case gc.ROUTE_CHANGE_FREQ:this.setMoveFrequency(params[0]);break;case gc.ROUTE_WALK_ANIME_ON:this.setWalkAnime(!0);break;case gc.ROUTE_WALK_ANIME_OFF:this.setWalkAnime(!1);break;case gc.ROUTE_STEP_ANIME_ON:this.setStepAnime(!0);break;case gc.ROUTE_STEP_ANIME_OFF:this.setStepAnime(!1);break;case gc.ROUTE_DIR_FIX_ON:this.setDirectionFix(!0);break;case gc.ROUTE_DIR_FIX_OFF:this.setDirectionFix(!1);break;case gc.ROUTE_THROUGH_ON:this.setThrough(!0);break;case gc.ROUTE_THROUGH_OFF:this.setThrough(!1);break;case gc.ROUTE_TRANSPARENT_ON:this.setTransparent(!0);break;case gc.ROUTE_TRANSPARENT_OFF:this.setTransparent(!1);break;case gc.ROUTE_CHANGE_IMAGE:this.setImage(params[0],params[1]);break;case gc.ROUTE_CHANGE_OPACITY:this.setOpacity(params[0]);break;case gc.ROUTE_CHANGE_BLEND_MODE:this.setBlendMode(params[0]);break;case gc.ROUTE_PLAY_SE:AudioManager.playSe(params[0]);break;case gc.ROUTE_SCRIPT:eval(params[0])}},Game_Character.prototype.deltaXFrom=function(a){return $gameMap.deltaX(this.x,a)},Game_Character.prototype.deltaYFrom=function(a){return $gameMap.deltaY(this.y,a)},Game_Character.prototype.moveRandom=function(){var a=2+2*Math.randomInt(4);this.canPass(this.x,this.y,a)&&this.moveStraight(a)},Game_Character.prototype.moveTowardCharacter=function(a){var b=this.deltaXFrom(a.x),c=this.deltaYFrom(a.y);Math.abs(b)>Math.abs(c)?(this.moveStraight(b>0?4:6),this.isMovementSucceeded()||0===c||this.moveStraight(c>0?8:2)):0!==c&&(this.moveStraight(c>0?8:2),this.isMovementSucceeded()||0===b||this.moveStraight(b>0?4:6))},Game_Character.prototype.moveAwayFromCharacter=function(a){var b=this.deltaXFrom(a.x),c=this.deltaYFrom(a.y);Math.abs(b)>Math.abs(c)?(this.moveStraight(b>0?6:4),this.isMovementSucceeded()||0===c||this.moveStraight(c>0?2:8)):0!==c&&(this.moveStraight(c>0?2:8),this.isMovementSucceeded()||0===b||this.moveStraight(b>0?6:4))},Game_Character.prototype.turnTowardCharacter=function(a){var b=this.deltaXFrom(a.x),c=this.deltaYFrom(a.y);Math.abs(b)>Math.abs(c)?this.setDirection(b>0?4:6):0!==c&&this.setDirection(c>0?8:2)},Game_Character.prototype.turnAwayFromCharacter=function(a){var b=this.deltaXFrom(a.x),c=this.deltaYFrom(a.y);Math.abs(b)>Math.abs(c)?this.setDirection(b>0?6:4):0!==c&&this.setDirection(c>0?2:8)},Game_Character.prototype.turnTowardPlayer=function(){this.turnTowardCharacter($gamePlayer)},Game_Character.prototype.turnAwayFromPlayer=function(){this.turnAwayFromCharacter($gamePlayer)},Game_Character.prototype.moveTowardPlayer=function(){this.moveTowardCharacter($gamePlayer)},Game_Character.prototype.moveAwayFromPlayer=function(){this.moveAwayFromCharacter($gamePlayer)},Game_Character.prototype.moveForward=function(){this.moveStraight(this.direction())},Game_Character.prototype.moveBackward=function(){var a=this.isDirectionFixed();this.setDirectionFix(!0),this.moveStraight(this.reverseDir(this.direction())),this.setDirectionFix(a)},Game_Character.prototype.processRouteEnd=function(){this._moveRoute.repeat?this._moveRouteIndex=-1:this._moveRouteForcing&&(this._moveRouteForcing=!1,this.restoreMoveRoute())},Game_Character.prototype.advanceMoveRouteIndex=function(){var a=this._moveRoute;if(a&&(this.isMovementSucceeded()||a.skippable)){var b=a.list.length-1;this._moveRouteIndex++,a.repeat&&this._moveRouteIndex>=b&&(this._moveRouteIndex=0)}},Game_Character.prototype.turnRight90=function(){switch(this.direction()){case 2:this.setDirection(4);break;case 4:this.setDirection(8);break;case 6:this.setDirection(2);break;case 8:this.setDirection(6)}},Game_Character.prototype.turnLeft90=function(){switch(this.direction()){case 2:this.setDirection(6);break;case 4:this.setDirection(2);break;case 6:this.setDirection(8);break;case 8:this.setDirection(4)}},Game_Character.prototype.turn180=function(){this.setDirection(this.reverseDir(this.direction()))},Game_Character.prototype.turnRightOrLeft90=function(){switch(Math.randomInt(2)){case 0:this.turnRight90();break;case 1:this.turnLeft90()}},Game_Character.prototype.turnRandom=function(){this.setDirection(2+2*Math.randomInt(4))},Game_Character.prototype.swap=function(a){var b=a.x,c=a.y;a.locate(this.x,this.y),this.locate(b,c)},Game_Character.prototype.findDirectionTo=function(a,b){var c=this.searchLimit(),d=$gameMap.width(),e=[],f=[],g=[],h={},i=h;if(this.x===a&&this.y===b)return 0;for(h.parent=null,h.x=this.x,h.y=this.y,h.g=0,h.f=$gameMap.distance(h.x,h.y,a,b),e.push(h),f.push(h.y*d+h.x);e.length>0;){for(var j=0,k=0;k<e.length;k++)e[k].f<e[j].f&&(j=k);var l=e[j],m=l.x,n=l.y,o=n*d+m,p=l.g;if(e.splice(j,1),f.splice(f.indexOf(o),1),g.push(o),l.x===a&&l.y===b){i=l,goaled=!0;break}if(!(p>=c))for(var q=0;4>q;q++){var r=2+2*q,s=$gameMap.roundXWithDirection(m,r),t=$gameMap.roundYWithDirection(n,r),u=t*d+s;if(!g.contains(u)&&this.canPass(m,n,r)){var v=p+1,w=f.indexOf(u);if(0>w||v<e[w].g){var x;w>=0?x=e[w]:(x={},e.push(x),f.push(u)),x.parent=l,x.x=s,x.y=t,x.g=v,x.f=v+$gameMap.distance(s,t,a,b),(!i||x.f-x.g<i.f-i.g)&&(i=x)}}}}for(var y=i;y.parent&&y.parent!==h;)y=y.parent;var z=$gameMap.deltaX(y.x,h.x),A=$gameMap.deltaY(y.y,h.y);if(A>0)return 2;if(0>z)return 4;if(z>0)return 6;if(0>A)return 8;var B=this.deltaXFrom(a),C=this.deltaYFrom(b);return Math.abs(B)>Math.abs(C)?B>0?4:6:0!==C?C>0?8:2:0},Game_Character.prototype.searchLimit=function(){return 12},Game_Player.prototype=Object.create(Game_Character.prototype),Game_Player.prototype.constructor=Game_Player,Game_Player.prototype.initialize=function(){Game_Character.prototype.initialize.call(this),this.setTransparent($dataSystem.optTransparent)},Game_Player.prototype.initMembers=function(){Game_Character.prototype.initMembers.call(this),this._vehicleType="walk",this._vehicleGettingOn=!1,this._vehicleGettingOff=!1,this._dashing=!1,this._needsMapReload=!1,this._transferring=!1,this._newMapId=0,this._newX=0,this._newY=0,this._newDirection=0,this._fadeType=0,this._followers=new Game_Followers,this._encounterCount=0},Game_Player.prototype.clearTransferInfo=function(){this._transferring=!1,this._newMapId=0,this._newX=0,this._newY=0,this._newDirection=0},Game_Player.prototype.followers=function(){return this._followers},Game_Player.prototype.refresh=function(){var a=$gameParty.leader(),b=a?a.characterName():"",c=a?a.characterIndex():0;this.setImage(b,c),this._followers.refresh()},Game_Player.prototype.isStopping=function(){return this._vehicleGettingOn||this._vehicleGettingOff?!1:Game_Character.prototype.isStopping.call(this)},Game_Player.prototype.reserveTransfer=function(a,b,c,d,e){this._transferring=!0,this._newMapId=a,this._newX=b,this._newY=c,this._newDirection=d,this._fadeType=e},Game_Player.prototype.requestMapReload=function(){this._needsMapReload=!0},Game_Player.prototype.isTransferring=function(){return this._transferring},Game_Player.prototype.newMapId=function(){return this._newMapId},Game_Player.prototype.fadeType=function(){return this._fadeType},Game_Player.prototype.performTransfer=function(){this.isTransferring()&&(this.setDirection(this._newDirection),(this._newMapId!==$gameMap.mapId()||this._needsMapReload)&&($gameMap.setup(this._newMapId),this._needsMapReload=!1),this.locate(this._newX,this._newY),this.refresh(),this.clearTransferInfo())},Game_Player.prototype.isMapPassable=function(a,b,c){var d=this.vehicle();return d?d.isMapPassable(a,b,c):Game_Character.prototype.isMapPassable.call(this,a,b,c)},Game_Player.prototype.vehicle=function(){return $gameMap.vehicle(this._vehicleType)},Game_Player.prototype.isInBoat=function(){return"boat"===this._vehicleType},Game_Player.prototype.isInShip=function(){return"ship"===this._vehicleType},Game_Player.prototype.isInAirship=function(){return"airship"===this._vehicleType},Game_Player.prototype.isInVehicle=function(){return this.isInBoat()||this.isInShip()||this.isInAirship()},Game_Player.prototype.isNormal=function(){return"walk"===this._vehicleType&&!this.isMoveRouteForcing()},Game_Player.prototype.isDashing=function(){return this._dashing},Game_Player.prototype.isDebugThrough=function(){return Input.isPressed("control")&&$gameTemp.isPlaytest()},Game_Player.prototype.isCollided=function(a,b){return this.isThrough()?!1:this.pos(a,b)||this._followers.isSomeoneCollided(a,b)},Game_Player.prototype.centerX=function(){return(Graphics.width/$gameMap.tileWidth()-1)/2},Game_Player.prototype.centerY=function(){return(Graphics.height/$gameMap.tileHeight()-1)/2},Game_Player.prototype.center=function(a,b){return $gameMap.setDisplayPos(a-this.centerX(),b-this.centerY())},Game_Player.prototype.locate=function(a,b){Game_Character.prototype.locate.call(this,a,b),this.center(a,b),this.makeEncounterCount(),this.isInVehicle()&&this.vehicle().refresh(),this._followers.synchronize(a,b,this.direction())},Game_Player.prototype.increaseSteps=function(){Game_Character.prototype.increaseSteps.call(this),this.isNormal()&&$gameParty.increaseSteps()},Game_Player.prototype.makeEncounterCount=function(){var a=$gameMap.encounterStep();this._encounterCount=Math.randomInt(a)+Math.randomInt(a)+1},Game_Player.prototype.makeEncounterTroopId=function(){var a=[],b=0;if($gameMap.encounterList().forEach(function(c){this.meetsEncounterConditions(c)&&(a.push(c),b+=c.weight)},this),b>0)for(var c=Math.randomInt(b),d=0;d<a.length;d++)if(c-=a[d].weight,0>c)return a[d].troopId;return 0},Game_Player.prototype.meetsEncounterConditions=function(a){return 0===a.regionSet.length||a.regionSet.contains(this.regionId())},Game_Player.prototype.executeEncounter=function(){if(!$gameMap.isEventRunning()&&this._encounterCount<=0){this.makeEncounterCount();var a=this.makeEncounterTroopId();return $dataTroops[a]?(BattleManager.setup(a,!0,!1),BattleManager.onEncounter(),!0):!1}return!1},Game_Player.prototype.startMapEvent=function(a,b,c,d){$gameMap.isEventRunning()||$gameMap.eventsXy(a,b).forEach(function(a){a.isTriggerIn(c)&&a.isNormalPriority()===d&&a.start()})},Game_Player.prototype.moveByInput=function(){if(!this.isMoving()&&this.canMove()){var a=this.getInputDirection();if(a>0)$gameTemp.clearDestination();else if($gameTemp.isDestinationValid()){var b=$gameTemp.destinationX(),c=$gameTemp.destinationY();a=this.findDirectionTo(b,c)}a>0&&this.executeMove(a)}},Game_Player.prototype.canMove=function(){return $gameMap.isEventRunning()||$gameMessage.isBusy()?!1:this.isMoveRouteForcing()||this.areFollowersGathering()?!1:this._vehicleGettingOn||this._vehicleGettingOff?!1:this.isInVehicle()&&!this.vehicle().canMove()?!1:!0},Game_Player.prototype.getInputDirection=function(){return Input.dir4},Game_Player.prototype.executeMove=function(a){this.moveStraight(a)},Game_Player.prototype.update=function(a){var b=this.scrolledX(),c=this.scrolledY(),d=this.isMoving();this.updateDashing(),a&&this.moveByInput(),Game_Character.prototype.update.call(this),this.updateScroll(b,c),this.updateVehicle(),this.isMoving()||this.updateNonmoving(d),this._followers.update()},Game_Player.prototype.updateDashing=function(){this.isMoving()||(!this.canMove()||this.isInVehicle()||$gameMap.isDashDisabled()?this._dashing=!1:this._dashing=this.isDashButtonPressed()||$gameTemp.isDestinationValid())},Game_Player.prototype.isDashButtonPressed=function(){var a=Input.isPressed("shift");return ConfigManager.alwaysDash?!a:a},Game_Player.prototype.updateScroll=function(a,b){var c=a,d=b,e=this.scrolledX(),f=this.scrolledY();f>d&&f>this.centerY()&&$gameMap.scrollDown(f-d),c>e&&e<this.centerX()&&$gameMap.scrollLeft(c-e),e>c&&e>this.centerX()&&$gameMap.scrollRight(e-c),d>f&&f<this.centerY()&&$gameMap.scrollUp(d-f)},Game_Player.prototype.updateVehicle=function(){this.isInVehicle()&&!this.areFollowersGathering()&&(this._vehicleGettingOn?this.updateVehicleGetOn():this._vehicleGettingOff?this.updateVehicleGetOff():this.vehicle().syncWithPlayer())},Game_Player.prototype.updateVehicleGetOn=function(){this.areFollowersGathering()||this.isMoving()||(this.setDirection(this.vehicle().direction()),this.setMoveSpeed(this.vehicle().moveSpeed()),this._vehicleGettingOn=!1,this.setTransparent(!0),this.isInAirship()&&this.setThrough(!0),this.vehicle().getOn())},Game_Player.prototype.updateVehicleGetOff=function(){!this.areFollowersGathering()&&this.vehicle().isLowest()&&(this._vehicleGettingOff=!1,this._vehicleType="walk",this.setTransparent(!1))},Game_Player.prototype.updateNonmoving=function(a){if(!$gameMap.isEventRunning()){if(a&&($gameParty.onPlayerWalk(),this.checkEventTriggerHere([1,2]),$gameMap.setupStartingEvent()))return;if(this.triggerAction())return;a?this.updateEncounterCount():$gameTemp.clearDestination()}},Game_Player.prototype.triggerAction=function(){if(this.canMove()){if(this.triggerButtonAction())return!0;if(this.triggerTouchAction())return!0}return!1},Game_Player.prototype.triggerButtonAction=function(){if(Input.isTriggered("ok")){if(this.getOnOffVehicle())return!0;if(this.checkEventTriggerHere([0]),$gameMap.setupStartingEvent())return!0;if(this.checkEventTriggerThere([0,1,2]),$gameMap.setupStartingEvent())return!0}return!1},Game_Player.prototype.triggerTouchAction=function(){if($gameTemp.isDestinationValid()){var a=this.direction(),b=this.x,c=this.y,d=$gameMap.roundXWithDirection(b,a),e=$gameMap.roundYWithDirection(c,a),f=$gameMap.roundXWithDirection(d,a),g=$gameMap.roundYWithDirection(e,a),h=$gameTemp.destinationX(),i=$gameTemp.destinationY();if(h===b&&i===c)return this.triggerTouchActionD1(b,c);if(h===d&&i===e)return this.triggerTouchActionD2(d,e);if(h===f&&i===g)return this.triggerTouchActionD3(d,e)}return!1},Game_Player.prototype.triggerTouchActionD1=function(a,b){return $gameMap.airship().pos(a,b)&&TouchInput.isTriggered()&&this.getOnOffVehicle()?!0:(this.checkEventTriggerHere([0]),$gameMap.setupStartingEvent())},Game_Player.prototype.triggerTouchActionD2=function(a,b){return($gameMap.boat().pos(a,b)||$gameMap.ship().pos(a,b))&&TouchInput.isTriggered()&&this.getOnVehicle()?!0:(this.isInBoat()||this.isInShip())&&TouchInput.isTriggered()&&this.getOffVehicle()?!0:(this.checkEventTriggerThere([0,1,2]),$gameMap.setupStartingEvent())},Game_Player.prototype.triggerTouchActionD3=function(a,b){return $gameMap.isCounter(a,b)&&this.checkEventTriggerThere([0,1,2]),$gameMap.setupStartingEvent()},Game_Player.prototype.updateEncounterCount=function(){this.canEncounter()&&(this._encounterCount-=this.encounterProgressValue())},Game_Player.prototype.canEncounter=function(){return!$gameParty.hasEncounterNone()&&$gameSystem.isEncounterEnabled()&&!this.isInAirship()&&!this.isMoveRouteForcing()&&!this.isDebugThrough()},Game_Player.prototype.encounterProgressValue=function(){var a=$gameMap.isBush(this.x,this.y)?2:1;return $gameParty.hasEncounterHalf()&&(a*=.5),this.isInShip()&&(a*=.5),a},Game_Player.prototype.checkEventTriggerHere=function(a){this.canStartLocalEvents()&&this.startMapEvent(this.x,this.y,a,!1)},Game_Player.prototype.checkEventTriggerThere=function(a){if(this.canStartLocalEvents()){var b=this.direction(),c=this.x,d=this.y,e=$gameMap.roundXWithDirection(c,b),f=$gameMap.roundYWithDirection(d,b);if(this.startMapEvent(e,f,a,!0),!$gameMap.isAnyEventStarting()&&$gameMap.isCounter(e,f)){var g=$gameMap.roundXWithDirection(e,b),h=$gameMap.roundYWithDirection(f,b);this.startMapEvent(g,h,a,!0)}}},Game_Player.prototype.checkEventTriggerTouch=function(a,b){this.canStartLocalEvents()&&this.startMapEvent(a,b,[1,2],!0)},Game_Player.prototype.canStartLocalEvents=function(){return!this.isInAirship()},Game_Player.prototype.getOnOffVehicle=function(){return this.isInVehicle()?this.getOffVehicle():this.getOnVehicle()},Game_Player.prototype.getOnVehicle=function(){var a=this.direction(),b=this.x,c=this.y,d=$gameMap.roundXWithDirection(b,a),e=$gameMap.roundYWithDirection(c,a);return $gameMap.airship().pos(b,c)?this._vehicleType="airship":$gameMap.ship().pos(d,e)?this._vehicleType="ship":$gameMap.boat().pos(d,e)&&(this._vehicleType="boat"),this.isInVehicle()&&(this._vehicleGettingOn=!0,this.isInAirship()||this.forceMoveForward(),this.gatherFollowers()),this._vehicleGettingOn},Game_Player.prototype.getOffVehicle=function(){return this.vehicle().isLandOk(this.x,this.y,this.direction())&&(this.isInAirship()&&this.setDirection(2),this._followers.synchronize(this.x,this.y,this.direction()),this.vehicle().getOff(),this.isInAirship()||(this.forceMoveForward(),this.setTransparent(!1)),this._vehicleGettingOff=!0,this.setMoveSpeed(4),this.setThrough(!1),this.makeEncounterCount(),this.gatherFollowers()),this._vehicleGettingOff},Game_Player.prototype.forceMoveForward=function(){this.setThrough(!0),this.moveForward(),this.setThrough(!1)},Game_Player.prototype.isOnDamageFloor=function(){return $gameMap.isDamageFloor(this.x,this.y)&&!this.isInAirship()},Game_Player.prototype.moveStraight=function(a){this.canPass(this.x,this.y,a)&&this._followers.updateMove(),Game_Character.prototype.moveStraight.call(this,a)},Game_Player.prototype.moveDiagonally=function(a,b){this.canPassDiagonally(this.x,this.y,a,b)&&this._followers.updateMove(),Game_Character.prototype.moveDiagonally.call(this,a,b)},Game_Player.prototype.jump=function(a,b){Game_Character.prototype.jump.call(this,a,b),this._followers.jumpAll()},Game_Player.prototype.showFollowers=function(){this._followers.show()},Game_Player.prototype.hideFollowers=function(){this._followers.hide()},Game_Player.prototype.gatherFollowers=function(){this._followers.gather()},Game_Player.prototype.areFollowersGathering=function(){return this._followers.areGathering()},Game_Player.prototype.areFollowersGathered=function(){return this._followers.areGathered()},Game_Follower.prototype=Object.create(Game_Character.prototype),Game_Follower.prototype.constructor=Game_Follower,Game_Follower.prototype.initialize=function(a){Game_Character.prototype.initialize.call(this),this._memberIndex=a,this.setTransparent($dataSystem.optTransparent),this.setThrough(!0)},Game_Follower.prototype.refresh=function(){var a=this.isVisible()?this.actor().characterName():"",b=this.isVisible()?this.actor().characterIndex():0;this.setImage(a,b)},Game_Follower.prototype.actor=function(){return $gameParty.battleMembers()[this._memberIndex]},Game_Follower.prototype.isVisible=function(){return this.actor()&&$gamePlayer.followers().isVisible()},Game_Follower.prototype.update=function(){Game_Character.prototype.update.call(this),this.setMoveSpeed($gamePlayer.realMoveSpeed()),this.setOpacity($gamePlayer.opacity()),this.setBlendMode($gamePlayer.blendMode()),this.setWalkAnime($gamePlayer.hasWalkAnime()),this.setStepAnime($gamePlayer.hasStepAnime()),this.setDirectionFix($gamePlayer.isDirectionFixed()),this.setTransparent($gamePlayer.isTransparent())},Game_Follower.prototype.chaseCharacter=function(a){var b=this.deltaXFrom(a.x),c=this.deltaYFrom(a.y);0!==b&&0!==c?this.moveDiagonally(b>0?4:6,c>0?8:2):0!==b?this.moveStraight(b>0?4:6):0!==c&&this.moveStraight(c>0?8:2),this.setMoveSpeed($gamePlayer.realMoveSpeed())},Game_Followers.prototype.initialize=function(){this._visible=$dataSystem.optFollowers,this._gathering=!1,this._data=[];for(var a=1;a<$gameParty.maxBattleMembers();a++)this._data.push(new Game_Follower(a))},Game_Followers.prototype.isVisible=function(){return this._visible},Game_Followers.prototype.show=function(){this._visible=!0},Game_Followers.prototype.hide=function(){this._visible=!1},Game_Followers.prototype.follower=function(a){return this._data[a]},Game_Followers.prototype.forEach=function(a,b){this._data.forEach(a,b)},Game_Followers.prototype.reverseEach=function(a,b){this._data.reverse(),this._data.forEach(a,b),this._data.reverse()},Game_Followers.prototype.refresh=function(){this.forEach(function(a){return a.refresh()},this)},Game_Followers.prototype.update=function(){this.areGathering()&&(this.areMoving()||this.updateMove(),this.areGathered()&&(this._gathering=!1)),this.forEach(function(a){a.update()},this)},Game_Followers.prototype.updateMove=function(){for(var a=this._data.length-1;a>=0;a--){var b=a>0?this._data[a-1]:$gamePlayer;this._data[a].chaseCharacter(b)}},Game_Followers.prototype.jumpAll=function(){if($gamePlayer.isJumping())for(var a=0;a<this._data.length;a++){var b=this._data[a],c=$gamePlayer.deltaXFrom(b.x),d=$gamePlayer.deltaYFrom(b.y);b.jump(c,d)}},Game_Followers.prototype.synchronize=function(a,b,c){this.forEach(function(d){d.locate(a,b),d.setDirection(c)},this)},Game_Followers.prototype.gather=function(){this._gathering=!0},Game_Followers.prototype.areGathering=function(){return this._gathering},Game_Followers.prototype.visibleFollowers=function(){return this._data.filter(function(a){return a.isVisible()},this)},Game_Followers.prototype.areMoving=function(){return this.visibleFollowers().some(function(a){return a.isMoving()},this)},Game_Followers.prototype.areGathered=function(){return this.visibleFollowers().every(function(a){return!a.isMoving()&&a.pos($gamePlayer.x,$gamePlayer.y)},this)},Game_Followers.prototype.isSomeoneCollided=function(a,b){return this.visibleFollowers().some(function(c){return c.pos(a,b)},this)},Game_Vehicle.prototype=Object.create(Game_Character.prototype),Game_Vehicle.prototype.constructor=Game_Vehicle,Game_Vehicle.prototype.initialize=function(a){Game_Character.prototype.initialize.call(this),this._type=a,this.resetDirection(),this.initMoveSpeed(),this.loadSystemSettings()},Game_Vehicle.prototype.initMembers=function(){Game_Character.prototype.initMembers.call(this),this._type="",this._mapId=0,this._altitude=0,this._driving=!1,this._bgm=null},Game_Vehicle.prototype.isBoat=function(){return"boat"===this._type},Game_Vehicle.prototype.isShip=function(){return"ship"===this._type},Game_Vehicle.prototype.isAirship=function(){return"airship"===this._type},Game_Vehicle.prototype.resetDirection=function(){this.setDirection(4)},Game_Vehicle.prototype.initMoveSpeed=function(){this.isBoat()?this.setMoveSpeed(4):this.isShip()?this.setMoveSpeed(5):this.isAirship()&&this.setMoveSpeed(6)},Game_Vehicle.prototype.vehicle=function(){return this.isBoat()?$dataSystem.boat:this.isShip()?$dataSystem.ship:this.isAirship()?$dataSystem.airship:null},Game_Vehicle.prototype.loadSystemSettings=function(){var a=this.vehicle();this._mapId=a.startMapId,this.setPosition(a.startX,a.startY),this.setImage(a.characterName,a.characterIndex)},Game_Vehicle.prototype.refresh=function(){this._driving?(this._mapId=$gameMap.mapId(),this.syncWithPlayer()):this._mapId===$gameMap.mapId()&&this.locate(this.x,this.y),this.isAirship()?this.setPriorityType(this._driving?2:0):this.setPriorityType(1),this.setWalkAnime(this._driving),this.setStepAnime(this._driving),this.setTransparent(this._mapId!==$gameMap.mapId())},Game_Vehicle.prototype.setLocation=function(a,b,c){this._mapId=a,this.setPosition(b,c),this.refresh()},Game_Vehicle.prototype.pos=function(a,b){return this._mapId===$gameMap.mapId()?Game_Character.prototype.pos.call(this,a,b):!1},Game_Vehicle.prototype.isMapPassable=function(a,b,c){var d=$gameMap.roundXWithDirection(a,c),e=$gameMap.roundYWithDirection(b,c);return this.isBoat()?$gameMap.isBoatPassable(d,e):this.isShip()?$gameMap.isShipPassable(d,e):this.isAirship()?!0:!1},Game_Vehicle.prototype.getOn=function(){this._driving=!0,this.setWalkAnime(!0),this.setStepAnime(!0),$gameSystem.saveWalkingBgm(),this.playBgm()},Game_Vehicle.prototype.getOff=function(){this._driving=!1,this.setWalkAnime(!1),this.setStepAnime(!1),this.resetDirection(),$gameSystem.replayWalkingBgm()},Game_Vehicle.prototype.setBgm=function(a){this._bgm=a},Game_Vehicle.prototype.playBgm=function(){AudioManager.playBgm(this._bgm||this.vehicle().bgm)},Game_Vehicle.prototype.syncWithPlayer=function(){this.copyPosition($gamePlayer),this.refreshBushDepth()},Game_Vehicle.prototype.screenY=function(){return Game_Character.prototype.screenY.call(this)-this._altitude},Game_Vehicle.prototype.shadowX=function(){return this.screenX()},Game_Vehicle.prototype.shadowY=function(){return this.screenY()+this._altitude},Game_Vehicle.prototype.shadowOpacity=function(){return 255*this._altitude/this.maxAltitude()},Game_Vehicle.prototype.canMove=function(){return this.isAirship()?this.isHighest():!0},Game_Vehicle.prototype.update=function(){Game_Character.prototype.update.call(this),this.isAirship()&&this.updateAirship()},Game_Vehicle.prototype.updateAirship=function(){this.updateAirshipAltitude(),this.setStepAnime(this.isHighest()),this.setPriorityType(this.isLowest()?0:2)},Game_Vehicle.prototype.updateAirshipAltitude=function(){this._driving&&!this.isHighest()&&this._altitude++,this._driving||this.isLowest()||this._altitude--},Game_Vehicle.prototype.maxAltitude=function(){return 48},Game_Vehicle.prototype.isLowest=function(){return this._altitude<=0},Game_Vehicle.prototype.isHighest=function(){return this._altitude>=this.maxAltitude()},Game_Vehicle.prototype.isTakeoffOk=function(){return $gamePlayer.areFollowersGathered()},Game_Vehicle.prototype.isLandOk=function(a,b,c){if(this.isAirship()){if(!$gameMap.isAirshipLandOk(a,b))return!1;if($gameMap.eventsXy(a,b).length>0)return!1}else{var d=$gameMap.roundXWithDirection(a,c),e=$gameMap.roundYWithDirection(b,c);if(!$gameMap.isValid(d,e))return!1;if(!$gameMap.isPassable(d,e,this.reverseDir(c)))return!1;if(this.isCollidedWithCharacters(d,e))return!1}return!0},Game_Event.prototype=Object.create(Game_Character.prototype),Game_Event.prototype.constructor=Game_Event,Game_Event.prototype.initialize=function(a,b){Game_Character.prototype.initialize.call(this),this._mapId=a,this._eventId=b,this.locate(this.event().x,this.event().y),this.refresh()},Game_Event.prototype.initMembers=function(){Game_Character.prototype.initMembers.call(this),this._moveType=0,this._trigger=0,this._starting=!1,this._erased=!1,this._pageIndex=-2,this._originalPattern=1,this._originalDirection=2,this._prelockDirection=0,this._locked=!1},Game_Event.prototype.eventId=function(){return this._eventId},Game_Event.prototype.event=function(){return $dataMap.events[this._eventId]},Game_Event.prototype.page=function(){return this.event().pages[this._pageIndex]},Game_Event.prototype.list=function(){return this.page().list},Game_Event.prototype.isCollidedWithCharacters=function(a,b){return Game_Character.prototype.isCollidedWithCharacters.call(this,a,b)||this.isCollidedWithPlayerCharacters(a,b)},Game_Event.prototype.isCollidedWithEvents=function(a,b){var c=$gameMap.eventsXyNt(a,b);return c.length>0},Game_Event.prototype.isCollidedWithPlayerCharacters=function(a,b){return this.isNormalPriority()&&$gamePlayer.isCollided(a,b)},Game_Event.prototype.lock=function(){this._locked||(this._prelockDirection=this.direction(),this.turnTowardPlayer(),this._locked=!0)},Game_Event.prototype.unlock=function(){this._locked&&(this._locked=!1,this.setDirection(this._prelockDirection))},Game_Event.prototype.updateStop=function(){this._locked&&this.resetStopCount(),Game_Character.prototype.updateStop.call(this),this.isMoveRouteForcing()||this.updateSelfMovement()},Game_Event.prototype.updateSelfMovement=function(){if(!this._locked&&this.isNearTheScreen()&&this.checkStop(this.stopCountThreshold()))switch(this._moveType){case 1:this.moveTypeRandom();break;case 2:this.moveTypeTowardPlayer();
break;case 3:this.moveTypeCustom()}},Game_Event.prototype.stopCountThreshold=function(){return 30*(5-this.moveFrequency())},Game_Event.prototype.moveTypeRandom=function(){switch(Math.randomInt(6)){case 0:case 1:this.moveRandom();break;case 2:case 3:case 4:this.moveForward();break;case 5:this.resetStopCount()}},Game_Event.prototype.moveTypeTowardPlayer=function(){if(this.isNearThePlayer())switch(Math.randomInt(6)){case 0:case 1:case 2:case 3:this.moveTowardPlayer();break;case 4:this.moveRandom();break;case 5:this.moveForward()}else this.moveRandom()},Game_Event.prototype.isNearThePlayer=function(){var a=Math.abs(this.deltaXFrom($gamePlayer.x)),b=Math.abs(this.deltaYFrom($gamePlayer.y));return 20>a+b},Game_Event.prototype.moveTypeCustom=function(){this.updateRoutineMove()},Game_Event.prototype.isStarting=function(){return this._starting},Game_Event.prototype.clearStartingFlag=function(){this._starting=!1},Game_Event.prototype.isTriggerIn=function(a){return a.contains(this._trigger)},Game_Event.prototype.start=function(){var a=this.list();a&&a.length>1&&(this._starting=!0,this.isTriggerIn([0,1,2])&&this.lock())},Game_Event.prototype.erase=function(){this._erased=!0,this.refresh()},Game_Event.prototype.refresh=function(){var a=this._erased?-1:this.findProperPageIndex();this._pageIndex!==a&&(this._pageIndex=a,this.setupPage())},Game_Event.prototype.findProperPageIndex=function(){for(var a=this.event().pages,b=a.length-1;b>=0;b--){var c=a[b];if(this.meetsConditions(c))return b}return-1},Game_Event.prototype.meetsConditions=function(a){var b=a.conditions;if(b.switch1Valid&&!$gameSwitches.value(b.switch1Id))return!1;if(b.switch2Valid&&!$gameSwitches.value(b.switch2Id))return!1;if(b.variableValid&&$gameVariables.value(b.variableId)<b.variableValue)return!1;if(b.selfSwitchValid){var c=[this._mapId,this._eventId,b.selfSwitchCh];if($gameSelfSwitches.value(c)!==!0)return!1}if(b.itemValid){var d=$dataItems[b.itemId];if(!$gameParty.hasItem(d))return!1}if(b.actorValid){var e=$gameActors.actor(b.actorId);if(!$gameParty.members().contains(e))return!1}return!0},Game_Event.prototype.setupPage=function(){this._pageIndex>=0?this.setupPageSettings():this.clearPageSettings(),this.refreshBushDepth(),this.clearStartingFlag(),this.checkEventTriggerAuto()},Game_Event.prototype.clearPageSettings=function(){this.setImage("",0),this._moveType=0,this._trigger=null,this._interpreter=null,this.setThrough(!0)},Game_Event.prototype.setupPageSettings=function(){var a=this.page(),b=a.image;b.tileId>0?this.setTileImage(b.tileId):this.setImage(b.characterName,b.characterIndex),this._originalDirection!==b.direction&&(this._originalDirection=b.direction,this._prelockDirection=0,this.setDirectionFix(!1),this.setDirection(b.direction)),this._originalPattern!==b.pattern&&(this._originalPattern=b.pattern,this.setPattern(b.pattern)),this.setMoveSpeed(a.moveSpeed),this.setMoveFrequency(a.moveFrequency),this.setPriorityType(a.priorityType),this.setWalkAnime(a.walkAnime),this.setStepAnime(a.stepAnime),this.setDirectionFix(a.directionFix),this.setThrough(a.through),this.setMoveRoute(a.moveRoute),this._moveType=a.moveType,this._trigger=a.trigger,4===this._trigger?this._interpreter=new Game_Interpreter:this._interpreter=null},Game_Event.prototype.isOriginalPattern=function(){return this.pattern()===this._originalPattern},Game_Event.prototype.resetPattern=function(){this.setPattern(this._originalPattern)},Game_Event.prototype.checkEventTriggerTouch=function(a,b){$gameMap.isEventRunning()||2===this._trigger&&$gamePlayer.pos(a,b)&&!this.isJumping()&&this.isNormalPriority()&&this.start()},Game_Event.prototype.checkEventTriggerAuto=function(){3===this._trigger&&this.start()},Game_Event.prototype.update=function(){Game_Character.prototype.update.call(this),this.checkEventTriggerAuto(),this.updateParallel()},Game_Event.prototype.updateParallel=function(){this._interpreter&&(this._interpreter.isRunning()||this._interpreter.setup(this.list(),this._eventId),this._interpreter.update())},Game_Event.prototype.locate=function(a,b){Game_Character.prototype.locate.call(this,a,b),this._prelockDirection=0},Game_Event.prototype.forceMoveRoute=function(a){Game_Character.prototype.forceMoveRoute.call(this,a),this._prelockDirection=0},Game_Interpreter.prototype.initialize=function(a){this._depth=a||0,this.checkOverflow(),this.clear(),this._branch={},this._params=[],this._indent=0,this._frameCount=0,this._freezeChecker=0},Game_Interpreter.prototype.checkOverflow=function(){if(this._depth>=100)throw new Error("Common event calls exceeded the limit")},Game_Interpreter.prototype.clear=function(){this._mapId=0,this._eventId=0,this._list=null,this._index=0,this._waitCount=0,this._waitMode="",this._comments="",this._character=null,this._childInterpreter=null},Game_Interpreter.prototype.setup=function(a,b){this.clear(),this._mapId=$gameMap.mapId(),this._eventId=b||0,this._list=a},Game_Interpreter.prototype.eventId=function(){return this._eventId},Game_Interpreter.prototype.isOnCurrentMap=function(){return this._mapId===$gameMap.mapId()},Game_Interpreter.prototype.setupReservedCommonEvent=function(){return $gameTemp.isCommonEventReserved()?(this.setup($gameTemp.reservedCommonEvent().list),$gameTemp.clearCommonEvent(),!0):!1},Game_Interpreter.prototype.isRunning=function(){return!!this._list},Game_Interpreter.prototype.update=function(){for(;this.isRunning()&&!this.updateChild()&&!this.updateWait()&&!SceneManager.isSceneChanging()&&this.executeCommand()&&!this.checkFreeze(););},Game_Interpreter.prototype.updateChild=function(){if(this._childInterpreter){if(this._childInterpreter.update(),this._childInterpreter.isRunning())return!0;this._childInterpreter=null}return!1},Game_Interpreter.prototype.updateWait=function(){return this.updateWaitCount()||this.updateWaitMode()},Game_Interpreter.prototype.updateWaitCount=function(){return this._waitCount>0?(this._waitCount--,!0):!1},Game_Interpreter.prototype.updateWaitMode=function(){var a=!1;switch(this._waitMode){case"message":a=$gameMessage.isBusy();break;case"transfer":a=$gamePlayer.isTransferring();break;case"scroll":a=$gameMap.isScrolling();break;case"route":a=this._character.isMoveRouteForcing();break;case"animation":a=this._character.isAnimationPlaying();break;case"balloon":a=this._character.isBalloonPlaying();break;case"gather":a=$gamePlayer.areFollowersGathering();break;case"action":a=BattleManager.isActionForced();break;case"video":a=Graphics.isVideoPlaying();break;case"image":a=!ImageManager.isReady()}return a||(this._waitMode=""),a},Game_Interpreter.prototype.setWaitMode=function(a){this._waitMode=a},Game_Interpreter.prototype.wait=function(a){this._waitCount=a},Game_Interpreter.prototype.fadeSpeed=function(){return 24},Game_Interpreter.prototype.executeCommand=function(){var a=this.currentCommand();if(a){this._params=a.parameters,this._indent=a.indent;var b="command"+a.code;if("function"==typeof this[b]&&!this[b]())return!1;this._index++}else this.terminate();return!0},Game_Interpreter.prototype.checkFreeze=function(){return this._frameCount!==Graphics.frameCount&&(this._frameCount=Graphics.frameCount,this._freezeChecker=0),this._freezeChecker++>=1e5?!0:!1},Game_Interpreter.prototype.terminate=function(){this._list=null,this._comments=""},Game_Interpreter.prototype.skipBranch=function(){for(;this._list[this._index+1].indent>this._indent;)this._index++},Game_Interpreter.prototype.currentCommand=function(){return this._list[this._index]},Game_Interpreter.prototype.nextEventCode=function(){var a=this._list[this._index+1];return a?a.code:0},Game_Interpreter.prototype.iterateActorId=function(a,b){if(0===a)$gameParty.members().forEach(b);else{var c=$gameActors.actor(a);c&&b(c)}},Game_Interpreter.prototype.iterateActorEx=function(a,b,c){0===a?this.iterateActorId(b,c):this.iterateActorId($gameVariables.value(b),c)},Game_Interpreter.prototype.iterateActorIndex=function(a,b){if(0>a)$gameParty.members().forEach(b);else{var c=$gameParty.members()[a];c&&b(c)}},Game_Interpreter.prototype.iterateEnemyIndex=function(a,b){if(0>a)$gameTroop.members().forEach(b);else{var c=$gameTroop.members()[a];c&&b(c)}},Game_Interpreter.prototype.iterateBattler=function(a,b,c){$gameParty.inBattle()&&(0===a?this.iterateEnemyIndex(b,c):this.iterateActorId(b,c))},Game_Interpreter.prototype.character=function(a){return $gameParty.inBattle()?null:0>a?$gamePlayer:this.isOnCurrentMap()?$gameMap.event(a>0?a:this._eventId):null},Game_Interpreter.prototype.operateValue=function(a,b,c){var d=0===b?c:$gameVariables.value(c);return 0===a?d:-d},Game_Interpreter.prototype.changeHp=function(a,b,c){a.isAlive()&&(!c&&a.hp<=-b&&(b=1-a.hp),a.gainHp(b),a.isDead()&&a.performCollapse())},Game_Interpreter.prototype.command101=function(){if(!$gameMessage.isBusy()){for($gameMessage.setFaceImage(this._params[0],this._params[1]),$gameMessage.setBackground(this._params[2]),$gameMessage.setPositionType(this._params[3]);401===this.nextEventCode();)this._index++,$gameMessage.add(this.currentCommand().parameters[0]);switch(this.nextEventCode()){case 102:this._index++,this.setupChoices(this.currentCommand().parameters);break;case 103:this._index++,this.setupNumInput(this.currentCommand().parameters);break;case 104:this._index++,this.setupItemChoice(this.currentCommand().parameters)}this._index++,this.setWaitMode("message")}return!1},Game_Interpreter.prototype.command102=function(){return $gameMessage.isBusy()||(this.setupChoices(this._params),this._index++,this.setWaitMode("message")),!1},Game_Interpreter.prototype.setupChoices=function(a){var b=a[0].clone(),c=a[1],d=a.length>2?a[2]:0,e=a.length>3?a[3]:2,f=a.length>4?a[4]:0;c>=b.length&&(c=-2),$gameMessage.setChoices(b,d,c),$gameMessage.setChoiceBackground(f),$gameMessage.setChoicePositionType(e),$gameMessage.setChoiceCallback(function(a){this._branch[this._indent]=a}.bind(this))},Game_Interpreter.prototype.command402=function(){return this._branch[this._indent]!==this._params[0]&&this.skipBranch(),!0},Game_Interpreter.prototype.command403=function(){return this._branch[this._indent]>=0&&this.skipBranch(),!0},Game_Interpreter.prototype.command103=function(){return $gameMessage.isBusy()||(this.setupNumInput(this._params),this._index++,this.setWaitMode("message")),!1},Game_Interpreter.prototype.setupNumInput=function(a){$gameMessage.setNumberInput(a[0],a[1])},Game_Interpreter.prototype.command104=function(){return $gameMessage.isBusy()||(this.setupItemChoice(this._params),this._index++,this.setWaitMode("message")),!1},Game_Interpreter.prototype.setupItemChoice=function(a){$gameMessage.setItemChoice(a[0],a[1]||2)},Game_Interpreter.prototype.command105=function(){if(!$gameMessage.isBusy()){for($gameMessage.setScroll(this._params[0],this._params[1]);405===this.nextEventCode();)this._index++,$gameMessage.add(this.currentCommand().parameters[0]);this._index++,this.setWaitMode("message")}return!1},Game_Interpreter.prototype.command108=function(){for(this._comments=[this._params[0]];408===this.nextEventCode();)this._index++,this._comments.push(this.currentCommand().parameters[0]);return!0},Game_Interpreter.prototype.command111=function(){var result=!1;switch(this._params[0]){case 0:result=$gameSwitches.value(this._params[1])===(0===this._params[2]);break;case 1:var value1=$gameVariables.value(this._params[1]),value2;switch(value2=0===this._params[2]?this._params[3]:$gameVariables.value(this._params[3]),this._params[4]){case 0:result=value1===value2;break;case 1:result=value1>=value2;break;case 2:result=value2>=value1;break;case 3:result=value1>value2;break;case 4:result=value2>value1;break;case 5:result=value1!==value2}break;case 2:if(this._eventId>0){var key=[this._mapId,this._eventId,this._params[1]];result=$gameSelfSwitches.value(key)===(0===this._params[2])}break;case 3:$gameTimer.isWorking()&&(result=0===this._params[2]?$gameTimer.seconds()>=this._params[1]:$gameTimer.seconds()<=this._params[1]);break;case 4:var actor=$gameActors.actor(this._params[1]);if(actor){var n=this._params[3];switch(this._params[2]){case 0:result=$gameParty.members().contains(actor);break;case 1:result=actor.name()===n;break;case 2:result=actor.isClass($dataClasses[n]);break;case 3:result=actor.isLearnedSkill(n);break;case 4:result=actor.hasWeapon($dataWeapons[n]);break;case 5:result=actor.hasArmor($dataArmors[n]);break;case 6:result=actor.isStateAffected(n)}}break;case 5:var enemy=$gameTroop.members()[this._params[1]];if(enemy)switch(this._params[2]){case 0:result=enemy.isAlive();break;case 1:result=enemy.isStateAffected(this._params[3])}break;case 6:var character=this.character(this._params[1]);character&&(result=character.direction()===this._params[2]);break;case 7:switch(this._params[2]){case 0:result=$gameParty.gold()>=this._params[1];break;case 1:result=$gameParty.gold()<=this._params[1];break;case 2:result=$gameParty.gold()<this._params[1]}break;case 8:result=$gameParty.hasItem($dataItems[this._params[1]]);break;case 9:result=$gameParty.hasItem($dataWeapons[this._params[1]],this._params[2]);break;case 10:result=$gameParty.hasItem($dataArmors[this._params[1]],this._params[2]);break;case 11:result=Input.isPressed(this._params[1]);break;case 12:result=!!eval(this._params[1]);break;case 13:result=$gamePlayer.vehicle()===$gameMap.vehicle(this._params[1])}return this._branch[this._indent]=result,this._branch[this._indent]===!1&&this.skipBranch(),!0},Game_Interpreter.prototype.command411=function(){return this._branch[this._indent]!==!1&&this.skipBranch(),!0},Game_Interpreter.prototype.command112=function(){return!0},Game_Interpreter.prototype.command413=function(){do this._index--;while(this.currentCommand().indent!==this._indent);return!0},Game_Interpreter.prototype.command113=function(){for(;this._index<this._list.length-1;){this._index++;var a=this.currentCommand();if(413===a.code&&a.indent<this._indent)break}return!0},Game_Interpreter.prototype.command115=function(){return this._index=this._list.length,!0},Game_Interpreter.prototype.command117=function(){var a=$dataCommonEvents[this._params[0]];if(a){var b=this.isOnCurrentMap()?this._eventId:0;this.setupChild(a.list,b)}return!0},Game_Interpreter.prototype.setupChild=function(a,b){this._childInterpreter=new Game_Interpreter(this._depth+1),this._childInterpreter.setup(a,b)},Game_Interpreter.prototype.command118=function(){return!0},Game_Interpreter.prototype.command119=function(){for(var a=this._params[0],b=0;b<this._list.length;b++){var c=this._list[b];if(118===c.code&&c.parameters[0]===a)return void this.jumpTo(b)}return!0},Game_Interpreter.prototype.jumpTo=function(a){for(var b=this._index,c=Math.min(a,b),d=Math.max(a,b),e=this._indent,f=c;d>=f;f++){var g=this._list[f].indent;g!==e&&(this._branch[e]=null,e=g)}this._index=a},Game_Interpreter.prototype.command121=function(){for(var a=this._params[0];a<=this._params[1];a++)$gameSwitches.setValue(a,0===this._params[2]);return!0},Game_Interpreter.prototype.command122=function(){var value=0;switch(this._params[3]){case 0:value=this._params[4];break;case 1:value=$gameVariables.value(this._params[4]);break;case 2:value=this._params[4]+Math.randomInt(this._params[5]-this._params[4]+1);break;case 3:value=this.gameDataOperand(this._params[4],this._params[5],this._params[6]);break;case 4:value=eval(this._params[4])}for(var i=this._params[0];i<=this._params[1];i++)this.operateVariable(i,this._params[2],value);return!0},Game_Interpreter.prototype.gameDataOperand=function(a,b,c){switch(a){case 0:return $gameParty.numItems($dataItems[b]);case 1:return $gameParty.numItems($dataWeapons[b]);case 2:return $gameParty.numItems($dataArmors[b]);case 3:var d=$gameActors.actor(b);if(d)switch(c){case 0:return d.level;case 1:return d.currentExp();case 2:return d.hp;case 3:return d.mp;default:if(c>=4&&11>=c)return d.param(c-4)}break;case 4:var e=$gameTroop.members()[b];if(e)switch(c){case 0:return e.hp;case 1:return e.mp;default:if(c>=2&&9>=c)return e.param(c-2)}break;case 5:var f=this.character(b);if(f)switch(c){case 0:return f.x;case 1:return f.y;case 2:return f.direction();case 3:return f.screenX();case 4:return f.screenY()}break;case 6:return d=$gameParty.members()[b],d?d.actorId():0;case 7:switch(b){case 0:return $gameMap.mapId();case 1:return $gameParty.size();case 2:return $gameParty.gold();case 3:return $gameParty.steps();case 4:return $gameSystem.playtime();case 5:return $gameTimer.seconds();case 6:return $gameSystem.saveCount();case 7:return $gameSystem.battleCount();case 8:return $gameSystem.winCount();case 9:return $gameSystem.escapeCount()}}return 0},Game_Interpreter.prototype.operateVariable=function(a,b,c){try{var d=$gameVariables.value(a);switch(b){case 0:$gameVariables.setValue(a,d=c);break;case 1:$gameVariables.setValue(a,d+c);break;case 2:$gameVariables.setValue(a,d-c);break;case 3:$gameVariables.setValue(a,d*c);break;case 4:$gameVariables.setValue(a,d/c);break;case 5:$gameVariables.setValue(a,d%c)}}catch(e){$gameVariables.setValue(a,0)}},Game_Interpreter.prototype.command123=function(){if(this._eventId>0){var a=[this._mapId,this._eventId,this._params[0]];$gameSelfSwitches.setValue(a,0===this._params[1])}return!0},Game_Interpreter.prototype.command124=function(){return 0===this._params[0]?$gameTimer.start(60*this._params[1]):$gameTimer.stop(),!0},Game_Interpreter.prototype.command125=function(){var a=this.operateValue(this._params[0],this._params[1],this._params[2]);return $gameParty.gainGold(a),!0},Game_Interpreter.prototype.command126=function(){var a=this.operateValue(this._params[1],this._params[2],this._params[3]);return $gameParty.gainItem($dataItems[this._params[0]],a),!0},Game_Interpreter.prototype.command127=function(){var a=this.operateValue(this._params[1],this._params[2],this._params[3]);return $gameParty.gainItem($dataWeapons[this._params[0]],a,this._params[4]),!0},Game_Interpreter.prototype.command128=function(){var a=this.operateValue(this._params[1],this._params[2],this._params[3]);return $gameParty.gainItem($dataArmors[this._params[0]],a,this._params[4]),!0},Game_Interpreter.prototype.command129=function(){var a=$gameActors.actor(this._params[0]);return a&&(0===this._params[1]?(this._params[2]&&$gameActors.actor(this._params[0]).setup(this._params[0]),$gameParty.addActor(this._params[0])):$gameParty.removeActor(this._params[0])),!0},Game_Interpreter.prototype.command132=function(){return $gameSystem.setBattleBgm(this._params[0]),!0},Game_Interpreter.prototype.command133=function(){return $gameSystem.setVictoryMe(this._params[0]),!0},Game_Interpreter.prototype.command134=function(){return 0===this._params[0]?$gameSystem.disableSave():$gameSystem.enableSave(),!0},Game_Interpreter.prototype.command135=function(){return 0===this._params[0]?$gameSystem.disableMenu():$gameSystem.enableMenu(),!0},Game_Interpreter.prototype.command136=function(){return 0===this._params[0]?$gameSystem.disableEncounter():$gameSystem.enableEncounter(),$gamePlayer.makeEncounterCount(),!0},Game_Interpreter.prototype.command137=function(){return 0===this._params[0]?$gameSystem.disableFormation():$gameSystem.enableFormation(),!0},Game_Interpreter.prototype.command138=function(){return $gameSystem.setWindowTone(this._params[0]),!0},Game_Interpreter.prototype.command139=function(){return $gameSystem.setDefeatMe(this._params[0]),!0},Game_Interpreter.prototype.command140=function(){var a=$gameMap.vehicle(this._params[0]);return a&&a.setBgm(this._params[1]),!0},Game_Interpreter.prototype.command201=function(){if(!$gameParty.inBattle()&&!$gameMessage.isBusy()){var a,b,c;0===this._params[0]?(a=this._params[1],b=this._params[2],c=this._params[3]):(a=$gameVariables.value(this._params[1]),b=$gameVariables.value(this._params[2]),c=$gameVariables.value(this._params[3])),$gamePlayer.reserveTransfer(a,b,c,this._params[4],this._params[5]),this.setWaitMode("transfer"),this._index++}return!1},Game_Interpreter.prototype.command202=function(){var a,b,c;0===this._params[1]?(a=this._params[2],b=this._params[3],c=this._params[4]):(a=$gameVariables.value(this._params[2]),b=$gameVariables.value(this._params[3]),c=$gameVariables.value(this._params[4]));var d=$gameMap.vehicle(this._params[0]);return d&&d.setLocation(a,b,c),!0},Game_Interpreter.prototype.command203=function(){var a=this.character(this._params[0]);if(a){if(0===this._params[1])a.locate(this._params[2],this._params[3]);else if(1===this._params[1]){var b=$gameVariables.value(this._params[2]),c=$gameVariables.value(this._params[3]);a.locate(b,c)}else{var d=this.character(this._params[2]);d&&a.swap(d)}this._params[4]>0&&a.setDirection(this._params[4])}return!0},Game_Interpreter.prototype.command204=function(){if(!$gameParty.inBattle()){if($gameMap.isScrolling())return this.setWaitMode("scroll"),!1;$gameMap.startScroll(this._params[0],this._params[1],this._params[2])}return!0},Game_Interpreter.prototype.command205=function(){return $gameMap.refreshIfNeeded(),this._character=this.character(this._params[0]),this._character&&(this._character.forceMoveRoute(this._params[1]),this._params[1].wait&&this.setWaitMode("route")),!0},Game_Interpreter.prototype.command206=function(){return $gamePlayer.getOnOffVehicle(),!0},Game_Interpreter.prototype.command211=function(){return $gamePlayer.setTransparent(0===this._params[0]),!0},Game_Interpreter.prototype.command212=function(){return this._character=this.character(this._params[0]),this._character&&(this._character.requestAnimation(this._params[1]),this._params[2]&&this.setWaitMode("animation")),!0},Game_Interpreter.prototype.command213=function(){return this._character=this.character(this._params[0]),this._character&&(this._character.requestBalloon(this._params[1]),this._params[2]&&this.setWaitMode("balloon")),!0},Game_Interpreter.prototype.command214=function(){return this.isOnCurrentMap()&&this._eventId>0&&$gameMap.eraseEvent(this._eventId),!0},Game_Interpreter.prototype.command216=function(){return 0===this._params[0]?$gamePlayer.showFollowers():$gamePlayer.hideFollowers(),$gamePlayer.refresh(),!0},Game_Interpreter.prototype.command217=function(){return $gameParty.inBattle()||($gamePlayer.gatherFollowers(),this.setWaitMode("gather")),!0},Game_Interpreter.prototype.command221=function(){return $gameMessage.isBusy()||($gameScreen.startFadeOut(this.fadeSpeed()),this.wait(this.fadeSpeed()),this._index++),!1},Game_Interpreter.prototype.command222=function(){return $gameMessage.isBusy()||($gameScreen.startFadeIn(this.fadeSpeed()),this.wait(this.fadeSpeed()),this._index++),!1},Game_Interpreter.prototype.command223=function(){return $gameScreen.startTint(this._params[0],this._params[1]),this._params[2]&&this.wait(this._params[1]),!0},Game_Interpreter.prototype.command224=function(){return $gameScreen.startFlash(this._params[0],this._params[1]),this._params[2]&&this.wait(this._params[1]),!0},Game_Interpreter.prototype.command225=function(){return $gameScreen.startShake(this._params[0],this._params[1],this._params[2]),this._params[3]&&this.wait(this._params[2]),!0},Game_Interpreter.prototype.command230=function(){return this.wait(this._params[0]),!0},Game_Interpreter.prototype.command231=function(){var a,b;return 0===this._params[3]?(a=this._params[4],b=this._params[5]):(a=$gameVariables.value(this._params[4]),b=$gameVariables.value(this._params[5])),$gameScreen.showPicture(this._params[0],this._params[1],this._params[2],a,b,this._params[6],this._params[7],this._params[8],this._params[9]),!0},Game_Interpreter.prototype.command232=function(){var a,b;return 0===this._params[3]?(a=this._params[4],b=this._params[5]):(a=$gameVariables.value(this._params[4]),b=$gameVariables.value(this._params[5])),$gameScreen.movePicture(this._params[0],this._params[2],a,b,this._params[6],this._params[7],this._params[8],this._params[9],this._params[10]),this._params[11]&&this.wait(this._params[10]),!0},Game_Interpreter.prototype.command233=function(){return $gameScreen.rotatePicture(this._params[0],this._params[1]),!0},Game_Interpreter.prototype.command234=function(){return $gameScreen.tintPicture(this._params[0],this._params[1],this._params[2]),this._params[3]&&this.wait(this._params[2]),!0},Game_Interpreter.prototype.command235=function(){return $gameScreen.erasePicture(this._params[0]),!0},Game_Interpreter.prototype.command236=function(){return $gameParty.inBattle()||($gameScreen.changeWeather(this._params[0],this._params[1],this._params[2]),this._params[3]&&this.wait(this._params[2])),!0},Game_Interpreter.prototype.command241=function(){return AudioManager.playBgm(this._params[0]),!0},Game_Interpreter.prototype.command242=function(){return AudioManager.fadeOutBgm(this._params[0]),!0},Game_Interpreter.prototype.command243=function(){return $gameSystem.saveBgm(),!0},Game_Interpreter.prototype.command244=function(){return $gameSystem.replayBgm(),!0},Game_Interpreter.prototype.command245=function(){return AudioManager.playBgs(this._params[0]),!0},Game_Interpreter.prototype.command246=function(){return AudioManager.fadeOutBgs(this._params[0]),!0},Game_Interpreter.prototype.command249=function(){return AudioManager.playMe(this._params[0]),!0},Game_Interpreter.prototype.command250=function(){return AudioManager.playSe(this._params[0]),!0},Game_Interpreter.prototype.command251=function(){return AudioManager.stopSe(),!0},Game_Interpreter.prototype.command261=function(){if(!$gameMessage.isBusy()){var a=this._params[0];if(a.length>0){var b=this.videoFileExt();Graphics.playVideo("movies/"+a+b),this.setWaitMode("video")}this._index++}return!1},Game_Interpreter.prototype.videoFileExt=function(){return Graphics.canPlayVideoType("video/webm")&&!Utils.isMobileDevice()?".webm":".mp4"},Game_Interpreter.prototype.command281=function(){return 0===this._params[0]?$gameMap.enableNameDisplay():$gameMap.disableNameDisplay(),!0},Game_Interpreter.prototype.command282=function(){for(var a=$dataTilesets[this._params[0]],b=0;b<a.tilesetNames.length;b++)ImageManager.loadTileset(a.tilesetNames[b]);return ImageManager.isReady()?($gameMap.changeTileset(this._params[0]),!0):!1},Game_Interpreter.prototype.command283=function(){return $gameMap.changeBattleback(this._params[0],this._params[1]),!0},Game_Interpreter.prototype.command284=function(){return $gameMap.changeParallax(this._params[0],this._params[1],this._params[2],this._params[3],this._params[4]),!0},Game_Interpreter.prototype.command285=function(){var a,b,c;switch(0===this._params[2]?(a=this._params[3],b=this._params[4]):(a=$gameVariables.value(this._params[3]),b=$gameVariables.value(this._params[4])),this._params[1]){case 0:c=$gameMap.terrainTag(a,b);break;case 1:c=$gameMap.eventIdXy(a,b);break;case 2:case 3:case 4:case 5:c=$gameMap.tileId(a,b,this._params[1]-2);break;default:c=$gameMap.regionId(a,b)}return $gameVariables.setValue(this._params[0],c),!0},Game_Interpreter.prototype.command301=function(){if(!$gameParty.inBattle()){var a;a=0===this._params[0]?this._params[1]:1===this._params[0]?$gameVariables.value(this._params[1]):$gamePlayer.makeEncounterTroopId(),$dataTroops[a]&&(BattleManager.setup(a,this._params[2],this._params[3]),BattleManager.setEventCallback(function(a){this._branch[this._indent]=a}.bind(this)),$gamePlayer.makeEncounterCount(),SceneManager.push(Scene_Battle))}return!0},Game_Interpreter.prototype.command601=function(){return 0!==this._branch[this._indent]&&this.skipBranch(),!0},Game_Interpreter.prototype.command602=function(){return 1!==this._branch[this._indent]&&this.skipBranch(),!0},Game_Interpreter.prototype.command603=function(){return 2!==this._branch[this._indent]&&this.skipBranch(),!0},Game_Interpreter.prototype.command302=function(){if(!$gameParty.inBattle()){for(var a=[this._params];605===this.nextEventCode();)this._index++,a.push(this.currentCommand().parameters);SceneManager.push(Scene_Shop),SceneManager.prepareNextScene(a,this._params[4])}return!0},Game_Interpreter.prototype.command303=function(){return $gameParty.inBattle()||$dataActors[this._params[0]]&&(SceneManager.push(Scene_Name),SceneManager.prepareNextScene(this._params[0],this._params[1])),!0},Game_Interpreter.prototype.command311=function(){var a=this.operateValue(this._params[2],this._params[3],this._params[4]);return this.iterateActorEx(this._params[0],this._params[1],function(b){this.changeHp(b,a,this._params[5])}.bind(this)),!0},Game_Interpreter.prototype.command312=function(){var a=this.operateValue(this._params[2],this._params[3],this._params[4]);return this.iterateActorEx(this._params[0],this._params[1],function(b){b.gainMp(a)}.bind(this)),!0},Game_Interpreter.prototype.command326=function(){var a=this.operateValue(this._params[2],this._params[3],this._params[4]);return this.iterateActorEx(this._params[0],this._params[1],function(b){b.gainTp(a)}.bind(this)),!0},Game_Interpreter.prototype.command313=function(){return this.iterateActorEx(this._params[0],this._params[1],function(a){var b=a.isDead();0===this._params[2]?a.addState(this._params[3]):a.removeState(this._params[3]),a.isDead()&&!b&&a.performCollapse(),a.clearResult()}.bind(this)),!0},Game_Interpreter.prototype.command314=function(){return this.iterateActorEx(this._params[0],this._params[1],function(a){a.recoverAll()}.bind(this)),!0},Game_Interpreter.prototype.command315=function(){var a=this.operateValue(this._params[2],this._params[3],this._params[4]);return this.iterateActorEx(this._params[0],this._params[1],function(b){b.changeExp(b.currentExp()+a,this._params[5])}.bind(this)),!0},Game_Interpreter.prototype.command316=function(){var a=this.operateValue(this._params[2],this._params[3],this._params[4]);return this.iterateActorEx(this._params[0],this._params[1],function(b){b.changeLevel(b.level+a,this._params[5])}.bind(this)),!0},Game_Interpreter.prototype.command317=function(){var a=this.operateValue(this._params[3],this._params[4],this._params[5]);return this.iterateActorEx(this._params[0],this._params[1],function(b){b.addParam(this._params[2],a)}.bind(this)),!0},Game_Interpreter.prototype.command318=function(){return this.iterateActorEx(this._params[0],this._params[1],function(a){0===this._params[2]?a.learnSkill(this._params[3]):a.forgetSkill(this._params[3])}.bind(this)),!0},Game_Interpreter.prototype.command319=function(){var a=$gameActors.actor(this._params[0]);return a&&a.changeEquipById(this._params[1],this._params[2]),!0},Game_Interpreter.prototype.command320=function(){var a=$gameActors.actor(this._params[0]);return a&&a.setName(this._params[1]),!0},Game_Interpreter.prototype.command321=function(){var a=$gameActors.actor(this._params[0]);return a&&$dataClasses[this._params[1]]&&a.changeClass(this._params[1],!1),!0},Game_Interpreter.prototype.command322=function(){var a=$gameActors.actor(this._params[0]);return a&&(a.setCharacterImage(this._params[1],this._params[2]),a.setFaceImage(this._params[3],this._params[4]),a.setBattlerImage(this._params[5])),$gamePlayer.refresh(),!0},Game_Interpreter.prototype.command323=function(){var a=$gameMap.vehicle(this._params[0]);return a&&a.setImage(this._params[1],this._params[2]),!0},Game_Interpreter.prototype.command324=function(){var a=$gameActors.actor(this._params[0]);return a&&a.setNickname(this._params[1]),!0},Game_Interpreter.prototype.command325=function(){var a=$gameActors.actor(this._params[0]);return a&&a.setProfile(this._params[1]),!0},Game_Interpreter.prototype.command331=function(){var a=this.operateValue(this._params[1],this._params[2],this._params[3]);return this.iterateEnemyIndex(this._params[0],function(b){this.changeHp(b,a,this._params[4])}.bind(this)),!0},Game_Interpreter.prototype.command332=function(){var a=this.operateValue(this._params[1],this._params[2],this._params[3]);return this.iterateEnemyIndex(this._params[0],function(b){b.gainMp(a)}.bind(this)),!0},Game_Interpreter.prototype.command342=function(){var a=this.operateValue(this._params[1],this._params[2],this._params[3]);return this.iterateEnemyIndex(this._params[0],function(b){b.gainTp(a)}.bind(this)),!0},Game_Interpreter.prototype.command333=function(){return this.iterateEnemyIndex(this._params[0],function(a){var b=a.isDead();0===this._params[1]?a.addState(this._params[2]):a.removeState(this._params[2]),a.isDead()&&!b&&a.performCollapse(),
a.clearResult()}.bind(this)),!0},Game_Interpreter.prototype.command334=function(){return this.iterateEnemyIndex(this._params[0],function(a){a.recoverAll()}.bind(this)),!0},Game_Interpreter.prototype.command335=function(){return this.iterateEnemyIndex(this._params[0],function(a){a.appear(),$gameTroop.makeUniqueNames()}.bind(this)),!0},Game_Interpreter.prototype.command336=function(){return this.iterateEnemyIndex(this._params[0],function(a){a.transform(this._params[1]),$gameTroop.makeUniqueNames()}.bind(this)),!0},Game_Interpreter.prototype.command337=function(){return this.iterateEnemyIndex(this._params[0],function(a){a.isAlive()&&a.startAnimation(this._params[1],!1,0)}.bind(this)),!0},Game_Interpreter.prototype.command339=function(){return this.iterateBattler(this._params[0],this._params[1],function(a){a.isDeathStateAffected()||(a.forceAction(this._params[2],this._params[3]),BattleManager.forceAction(a),this.setWaitMode("action"))}.bind(this)),!0},Game_Interpreter.prototype.command340=function(){return BattleManager.abort(),!0},Game_Interpreter.prototype.command351=function(){return $gameParty.inBattle()||(SceneManager.push(Scene_Menu),Window_MenuCommand.initCommandPosition()),!0},Game_Interpreter.prototype.command352=function(){return $gameParty.inBattle()||SceneManager.push(Scene_Save),!0},Game_Interpreter.prototype.command353=function(){return SceneManager["goto"](Scene_Gameover),!0},Game_Interpreter.prototype.command354=function(){return SceneManager["goto"](Scene_Title),!0},Game_Interpreter.prototype.command355=function(){for(var script=this.currentCommand().parameters[0]+"\n";655===this.nextEventCode();)this._index++,script+=this.currentCommand().parameters[0]+"\n";return eval(script),!0},Game_Interpreter.prototype.command356=function(){var a=this._params[0].split(" "),b=a.shift();return this.pluginCommand(b,a),!0},Game_Interpreter.prototype.pluginCommand=function(a,b){};