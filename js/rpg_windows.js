function Window_Base(){this.initialize.apply(this,arguments)}function Window_Selectable(){this.initialize.apply(this,arguments)}function Window_Command(){this.initialize.apply(this,arguments)}function Window_HorzCommand(){this.initialize.apply(this,arguments)}function Window_Help(){this.initialize.apply(this,arguments)}function Window_Gold(){this.initialize.apply(this,arguments)}function Window_MenuCommand(){this.initialize.apply(this,arguments)}function Window_MenuStatus(){this.initialize.apply(this,arguments)}function Window_MenuActor(){this.initialize.apply(this,arguments)}function Window_ItemCategory(){this.initialize.apply(this,arguments)}function Window_ItemList(){this.initialize.apply(this,arguments)}function Window_SkillType(){this.initialize.apply(this,arguments)}function Window_SkillStatus(){this.initialize.apply(this,arguments)}function Window_SkillList(){this.initialize.apply(this,arguments)}function Window_EquipStatus(){this.initialize.apply(this,arguments)}function Window_EquipCommand(){this.initialize.apply(this,arguments)}function Window_EquipSlot(){this.initialize.apply(this,arguments)}function Window_EquipItem(){this.initialize.apply(this,arguments)}function Window_Status(){this.initialize.apply(this,arguments)}function Window_Options(){this.initialize.apply(this,arguments)}function Window_SavefileList(){this.initialize.apply(this,arguments)}function Window_ShopCommand(){this.initialize.apply(this,arguments)}function Window_ShopBuy(){this.initialize.apply(this,arguments)}function Window_ShopSell(){this.initialize.apply(this,arguments)}function Window_ShopNumber(){this.initialize.apply(this,arguments)}function Window_ShopStatus(){this.initialize.apply(this,arguments)}function Window_NameEdit(){this.initialize.apply(this,arguments)}function Window_NameInput(){this.initialize.apply(this,arguments)}function Window_ChoiceList(){this.initialize.apply(this,arguments)}function Window_NumberInput(){this.initialize.apply(this,arguments)}function Window_EventItem(){this.initialize.apply(this,arguments)}function Window_Message(){this.initialize.apply(this,arguments)}function Window_ScrollText(){this.initialize.apply(this,arguments)}function Window_MapName(){this.initialize.apply(this,arguments)}function Window_BattleLog(){this.initialize.apply(this,arguments)}function Window_PartyCommand(){this.initialize.apply(this,arguments)}function Window_ActorCommand(){this.initialize.apply(this,arguments)}function Window_BattleStatus(){this.initialize.apply(this,arguments)}function Window_BattleActor(){this.initialize.apply(this,arguments)}function Window_BattleEnemy(){this.initialize.apply(this,arguments)}function Window_BattleSkill(){this.initialize.apply(this,arguments)}function Window_BattleItem(){this.initialize.apply(this,arguments)}function Window_TitleCommand(){this.initialize.apply(this,arguments)}function Window_GameEnd(){this.initialize.apply(this,arguments)}function Window_DebugRange(){this.initialize.apply(this,arguments)}function Window_DebugEdit(){this.initialize.apply(this,arguments)}Window_Base.prototype=Object.create(Window.prototype),Window_Base.prototype.constructor=Window_Base,Window_Base.prototype.initialize=function(a,b,c,d){Window.prototype.initialize.call(this),this.loadWindowskin(),this.move(a,b,c,d),this.updatePadding(),this.updateBackOpacity(),this.updateTone(),this.createContents(),this._opening=!1,this._closing=!1,this._dimmerSprite=null},Window_Base._iconWidth=32,Window_Base._iconHeight=32,Window_Base._faceWidth=144,Window_Base._faceHeight=144,Window_Base.prototype.lineHeight=function(){return 36},Window_Base.prototype.standardFontFace=function(){return $gameSystem.isChinese()?"SimHei, Heiti TC, sans-serif":$gameSystem.isKorean()?"Dotum, AppleGothic, sans-serif":"GameFont"},Window_Base.prototype.standardFontSize=function(){return 28},Window_Base.prototype.standardPadding=function(){return 18},Window_Base.prototype.textPadding=function(){return 6},Window_Base.prototype.standardBackOpacity=function(){return 192},Window_Base.prototype.loadWindowskin=function(){this.windowskin=ImageManager.loadSystem("Window")},Window_Base.prototype.updatePadding=function(){this.padding=this.standardPadding()},Window_Base.prototype.updateBackOpacity=function(){this.backOpacity=this.standardBackOpacity()},Window_Base.prototype.contentsWidth=function(){return this.width-2*this.standardPadding()},Window_Base.prototype.contentsHeight=function(){return this.height-2*this.standardPadding()},Window_Base.prototype.fittingHeight=function(a){return a*this.lineHeight()+2*this.standardPadding()},Window_Base.prototype.updateTone=function(){var a=$gameSystem.windowTone();this.setTone(a[0],a[1],a[2])},Window_Base.prototype.createContents=function(){this.contents=new Bitmap(this.contentsWidth(),this.contentsHeight()),this.resetFontSettings()},Window_Base.prototype.resetFontSettings=function(){this.contents.fontFace=this.standardFontFace(),this.contents.fontSize=this.standardFontSize(),this.resetTextColor()},Window_Base.prototype.resetTextColor=function(){this.changeTextColor(this.normalColor())},Window_Base.prototype.update=function(){Window.prototype.update.call(this),this.updateTone(),this.updateOpen(),this.updateClose(),this.updateBackgroundDimmer()},Window_Base.prototype.updateOpen=function(){this._opening&&(this.openness+=32,this.isOpen()&&(this._opening=!1))},Window_Base.prototype.updateClose=function(){this._closing&&(this.openness-=32,this.isClosed()&&(this._closing=!1))},Window_Base.prototype.open=function(){this.isOpen()||(this._opening=!0),this._closing=!1},Window_Base.prototype.close=function(){this.isClosed()||(this._closing=!0),this._opening=!1},Window_Base.prototype.isOpening=function(){return this._opening},Window_Base.prototype.isClosing=function(){return this._closing},Window_Base.prototype.show=function(){this.visible=!0},Window_Base.prototype.hide=function(){this.visible=!1},Window_Base.prototype.activate=function(){this.active=!0},Window_Base.prototype.deactivate=function(){this.active=!1},Window_Base.prototype.textColor=function(a){var b=96+a%8*12+6,c=144+12*Math.floor(a/8)+6;return this.windowskin.getPixel(b,c)},Window_Base.prototype.normalColor=function(){return this.textColor(0)},Window_Base.prototype.systemColor=function(){return this.textColor(16)},Window_Base.prototype.crisisColor=function(){return this.textColor(17)},Window_Base.prototype.deathColor=function(){return this.textColor(18)},Window_Base.prototype.gaugeBackColor=function(){return this.textColor(19)},Window_Base.prototype.hpGaugeColor1=function(){return this.textColor(20)},Window_Base.prototype.hpGaugeColor2=function(){return this.textColor(21)},Window_Base.prototype.mpGaugeColor1=function(){return this.textColor(22)},Window_Base.prototype.mpGaugeColor2=function(){return this.textColor(23)},Window_Base.prototype.mpCostColor=function(){return this.textColor(23)},Window_Base.prototype.powerUpColor=function(){return this.textColor(24)},Window_Base.prototype.powerDownColor=function(){return this.textColor(25)},Window_Base.prototype.tpGaugeColor1=function(){return this.textColor(28)},Window_Base.prototype.tpGaugeColor2=function(){return this.textColor(29)},Window_Base.prototype.tpCostColor=function(){return this.textColor(29)},Window_Base.prototype.pendingColor=function(){return this.windowskin.getPixel(120,120)},Window_Base.prototype.translucentOpacity=function(){return 160},Window_Base.prototype.changeTextColor=function(a){this.contents.textColor=a},Window_Base.prototype.changePaintOpacity=function(a){this.contents.paintOpacity=a?255:this.translucentOpacity()},Window_Base.prototype.drawText=function(a,b,c,d,e){this.contents.drawText(a,b,c,d,this.lineHeight(),e)},Window_Base.prototype.textWidth=function(a){return this.contents.measureTextWidth(a)},Window_Base.prototype.drawTextEx=function(a,b,c){if(a){var d={index:0,x:b,y:c,left:b};for(d.text=this.convertEscapeCharacters(a),d.height=this.calcTextHeight(d,!1),this.resetFontSettings();d.index<d.text.length;)this.processCharacter(d);return d.x-b}return 0},Window_Base.prototype.convertEscapeCharacters=function(a){return a=a.replace(/\\/g,""),a=a.replace(/\x1b\x1b/g,"\\"),a=a.replace(/\x1bV\[(\d+)\]/gi,function(){return $gameVariables.value(parseInt(arguments[1]))}.bind(this)),a=a.replace(/\x1bV\[(\d+)\]/gi,function(){return $gameVariables.value(parseInt(arguments[1]))}.bind(this)),a=a.replace(/\x1bN\[(\d+)\]/gi,function(){return this.actorName(parseInt(arguments[1]))}.bind(this)),a=a.replace(/\x1bP\[(\d+)\]/gi,function(){return this.partyMemberName(parseInt(arguments[1]))}.bind(this)),a=a.replace(/\x1bG/gi,TextManager.currencyUnit)},Window_Base.prototype.actorName=function(a){var b=a>=1?$gameActors.actor(a):null;return b?b.name():""},Window_Base.prototype.partyMemberName=function(a){var b=a>=1?$gameParty.members()[a-1]:null;return b?b.name():""},Window_Base.prototype.processCharacter=function(a){switch(a.text[a.index]){case"\n":this.processNewLine(a);break;case"\f":this.processNewPage(a);break;case"":this.processEscapeCharacter(this.obtainEscapeCode(a),a);break;default:this.processNormalCharacter(a)}},Window_Base.prototype.processNormalCharacter=function(a){var b=a.text[a.index++],c=this.textWidth(b);this.contents.drawText(b,a.x,a.y,2*c,a.height),a.x+=c},Window_Base.prototype.processNewLine=function(a){a.x=a.left,a.y+=a.height,a.height=this.calcTextHeight(a,!1),a.index++},Window_Base.prototype.processNewPage=function(a){a.index++},Window_Base.prototype.obtainEscapeCode=function(a){a.index++;var b=/^[\$\.\|\^!><\{\}\\]|^[A-Z]+/i,c=b.exec(a.text.slice(a.index));return c?(a.index+=c[0].length,c[0].toUpperCase()):""},Window_Base.prototype.obtainEscapeParam=function(a){var b=/^\[\d+\]/.exec(a.text.slice(a.index));return b?(a.index+=b[0].length,parseInt(b[0].slice(1))):""},Window_Base.prototype.processEscapeCharacter=function(a,b){switch(a){case"C":this.changeTextColor(this.textColor(this.obtainEscapeParam(b)));break;case"I":this.processDrawIcon(this.obtainEscapeParam(b),b);break;case"{":this.makeFontBigger();break;case"}":this.makeFontSmaller()}},Window_Base.prototype.processDrawIcon=function(a,b){this.drawIcon(a,b.x+2,b.y+2),b.x+=Window_Base._iconWidth+4},Window_Base.prototype.makeFontBigger=function(){this.contents.fontSize<=96&&(this.contents.fontSize+=12)},Window_Base.prototype.makeFontSmaller=function(){this.contents.fontSize>=24&&(this.contents.fontSize-=12)},Window_Base.prototype.calcTextHeight=function(a,b){for(var c=this.contents.fontSize,d=0,e=a.text.slice(a.index).split("\n"),f=b?e.length:1,g=0;f>g;g++){for(var h=this.contents.fontSize,i=/\x1b[\{\}]/g;;){var j=i.exec(e[g]);if(!j)break;"{"===j[0]&&this.makeFontBigger(),"}"===j[0]&&this.makeFontSmaller(),h<this.contents.fontSize&&(h=this.contents.fontSize)}d+=h+8}return this.contents.fontSize=c,d},Window_Base.prototype.drawIcon=function(a,b,c){var d=ImageManager.loadSystem("IconSet"),e=Window_Base._iconWidth,f=Window_Base._iconHeight,g=a%16*e,h=Math.floor(a/16)*f;this.contents.blt(d,g,h,e,f,b,c)},Window_Base.prototype.drawFace=function(a,b,c,d,e,f){e=e||Window_Base._faceWidth,f=f||Window_Base._faceHeight;var g=ImageManager.loadFace(a),h=Window_Base._faceWidth,i=Window_Base._faceHeight,j=Math.min(e,h),k=Math.min(f,i),l=Math.floor(c+Math.max(e-h,0)/2),m=Math.floor(d+Math.max(f-i,0)/2),n=b%4*h+(h-j)/2,o=Math.floor(b/4)*i+(i-k)/2;this.contents.blt(g,n,o,j,k,l,m)},Window_Base.prototype.drawCharacter=function(a,b,c,d){var e=ImageManager.loadCharacter(a),f=ImageManager.isBigCharacter(a),g=e.width/(f?3:12),h=e.height/(f?4:8),i=b,j=(i%4*3+1)*g,k=4*Math.floor(i/4)*h;this.contents.blt(e,j,k,g,h,c-g/2,d-h)},Window_Base.prototype.drawGauge=function(a,b,c,d,e,f){var g=Math.floor(c*d),h=b+this.lineHeight()-8;this.contents.fillRect(a,h,c,6,this.gaugeBackColor()),this.contents.gradientFillRect(a,h,g,6,e,f)},Window_Base.prototype.hpColor=function(a){return a.isDead()?this.deathColor():a.isDying()?this.crisisColor():this.normalColor()},Window_Base.prototype.mpColor=function(a){return this.normalColor()},Window_Base.prototype.tpColor=function(a){return this.normalColor()},Window_Base.prototype.drawActorCharacter=function(a,b,c){this.drawCharacter(a.characterName(),a.characterIndex(),b,c)},Window_Base.prototype.drawActorFace=function(a,b,c,d,e){this.drawFace(a.faceName(),a.faceIndex(),b,c,d,e)},Window_Base.prototype.drawActorName=function(a,b,c,d){d=d||168,this.changeTextColor(this.hpColor(a)),this.drawText(a.name(),b,c,d)},Window_Base.prototype.drawActorClass=function(a,b,c,d){d=d||168,this.resetTextColor(),this.drawText(a.currentClass().name,b,c,d)},Window_Base.prototype.drawActorNickname=function(a,b,c,d){d=d||270,this.resetTextColor(),this.drawText(a.nickname(),b,c,d)},Window_Base.prototype.drawActorLevel=function(a,b,c){this.changeTextColor(this.systemColor()),this.drawText(TextManager.levelA,b,c,48),this.resetTextColor(),this.drawText(a.level,b+84,c,36,"right")},Window_Base.prototype.drawActorIcons=function(a,b,c,d){d=d||144;for(var e=a.allIcons().slice(0,Math.floor(d/Window_Base._iconWidth)),f=0;f<e.length;f++)this.drawIcon(e[f],b+Window_Base._iconWidth*f,c+2)},Window_Base.prototype.drawCurrentAndMax=function(a,b,c,d,e,f,g){var h=this.textWidth("HP"),i=this.textWidth("0000"),j=this.textWidth("/"),k=c+e-i,l=k-j,m=l-i;m>=c+h?(this.changeTextColor(f),this.drawText(a,m,d,i,"right"),this.changeTextColor(g),this.drawText("/",l,d,j,"right"),this.drawText(b,k,d,i,"right")):(this.changeTextColor(f),this.drawText(a,k,d,i,"right"))},Window_Base.prototype.drawActorHp=function(a,b,c,d){d=d||186;var e=this.hpGaugeColor1(),f=this.hpGaugeColor2();this.drawGauge(b,c,d,a.hpRate(),e,f),this.changeTextColor(this.systemColor()),this.drawText(TextManager.hpA,b,c,44),this.drawCurrentAndMax(a.hp,a.mhp,b,c,d,this.hpColor(a),this.normalColor())},Window_Base.prototype.drawActorMp=function(a,b,c,d){d=d||186;var e=this.mpGaugeColor1(),f=this.mpGaugeColor2();this.drawGauge(b,c,d,a.mpRate(),e,f),this.changeTextColor(this.systemColor()),this.drawText(TextManager.mpA,b,c,44),this.drawCurrentAndMax(a.mp,a.mmp,b,c,d,this.mpColor(a),this.normalColor())},Window_Base.prototype.drawActorTp=function(a,b,c,d){d=d||96;var e=this.tpGaugeColor1(),f=this.tpGaugeColor2();this.drawGauge(b,c,d,a.tpRate(),e,f),this.changeTextColor(this.systemColor()),this.drawText(TextManager.tpA,b,c,44),this.changeTextColor(this.tpColor(a)),this.drawText(a.tp,b+d-64,c,64,"right")},Window_Base.prototype.drawActorSimpleStatus=function(a,b,c,d){var e=this.lineHeight(),f=b+180,g=Math.min(200,d-180-this.textPadding());this.drawActorName(a,b,c),this.drawActorLevel(a,b,c+1*e),this.drawActorIcons(a,b,c+2*e),this.drawActorClass(a,f,c),this.drawActorHp(a,f,c+1*e,g),this.drawActorMp(a,f,c+2*e,g)},Window_Base.prototype.drawItemName=function(a,b,c,d){if(d=d||312,a){var e=Window_Base._iconWidth+4;this.resetTextColor(),this.drawIcon(a.iconIndex,b+2,c+2),this.drawText(a.name,b+e,c,d-e)}},Window_Base.prototype.drawCurrencyValue=function(a,b,c,d,e){var f=Math.min(80,this.textWidth(b));this.resetTextColor(),this.drawText(a,c,d,e-f-6,"right"),this.changeTextColor(this.systemColor()),this.drawText(b,c+e-f,d,f,"right")},Window_Base.prototype.paramchangeTextColor=function(a){return a>0?this.powerUpColor():0>a?this.powerDownColor():this.normalColor()},Window_Base.prototype.setBackgroundType=function(a){0===a?this.opacity=255:this.opacity=0,1===a?this.showBackgroundDimmer():this.hideBackgroundDimmer()},Window_Base.prototype.showBackgroundDimmer=function(){this._dimmerSprite||(this._dimmerSprite=new Sprite,this._dimmerSprite.bitmap=new Bitmap(0,0),this.addChildToBack(this._dimmerSprite));var a=this._dimmerSprite.bitmap;(a.width!==this.width||a.height!==this.height)&&this.refreshDimmerBitmap(),this._dimmerSprite.visible=!0,this.updateBackgroundDimmer()},Window_Base.prototype.hideBackgroundDimmer=function(){this._dimmerSprite&&(this._dimmerSprite.visible=!1)},Window_Base.prototype.updateBackgroundDimmer=function(){this._dimmerSprite&&(this._dimmerSprite.opacity=this.openness)},Window_Base.prototype.refreshDimmerBitmap=function(){if(this._dimmerSprite){var a=this._dimmerSprite.bitmap,b=this.width,c=this.height,d=this.padding,e=this.dimColor1(),f=this.dimColor2();a.resize(b,c),a.gradientFillRect(0,0,b,d,f,e,!0),a.fillRect(0,d,b,c-2*d,e),a.gradientFillRect(0,c-d,b,d,e,f,!0),this._dimmerSprite.setFrame(0,0,b,c)}},Window_Base.prototype.dimColor1=function(){return"rgba(0, 0, 0, 0.6)"},Window_Base.prototype.dimColor2=function(){return"rgba(0, 0, 0, 0)"},Window_Base.prototype.canvasToLocalX=function(a){for(var b=this;b;)a-=b.x,b=b.parent;return a},Window_Base.prototype.canvasToLocalY=function(a){for(var b=this;b;)a-=b.y,b=b.parent;return a},Window_Selectable.prototype=Object.create(Window_Base.prototype),Window_Selectable.prototype.constructor=Window_Selectable,Window_Selectable.prototype.initialize=function(a,b,c,d){Window_Base.prototype.initialize.call(this,a,b,c,d),this._index=-1,this._cursorFixed=!1,this._cursorAll=!1,this._stayCount=0,this._helpWindow=null,this._handlers={},this._touching=!1,this._scrollX=0,this._scrollY=0,this.deactivate()},Window_Selectable.prototype.index=function(){return this._index},Window_Selectable.prototype.cursorFixed=function(){return this._cursorFixed},Window_Selectable.prototype.setCursorFixed=function(a){this._cursorFixed=a},Window_Selectable.prototype.cursorAll=function(){return this._cursorAll},Window_Selectable.prototype.setCursorAll=function(a){this._cursorAll=a},Window_Selectable.prototype.maxCols=function(){return 1},Window_Selectable.prototype.maxItems=function(){return 0},Window_Selectable.prototype.spacing=function(){return 12},Window_Selectable.prototype.itemWidth=function(){return Math.floor((this.width-2*this.padding+this.spacing())/this.maxCols()-this.spacing())},Window_Selectable.prototype.itemHeight=function(){return this.lineHeight()},Window_Selectable.prototype.maxRows=function(){return Math.max(Math.ceil(this.maxItems()/this.maxCols()),1)},Window_Selectable.prototype.activate=function(){Window_Base.prototype.activate.call(this),this.reselect()},Window_Selectable.prototype.deactivate=function(){Window_Base.prototype.deactivate.call(this),this.reselect()},Window_Selectable.prototype.select=function(a){this._index=a,this._stayCount=0,this.ensureCursorVisible(),this.updateCursor(),this.callUpdateHelp()},Window_Selectable.prototype.deselect=function(){this.select(-1)},Window_Selectable.prototype.reselect=function(){this.select(this._index)},Window_Selectable.prototype.row=function(){return Math.floor(this.index()/this.maxCols())},Window_Selectable.prototype.topRow=function(){return Math.floor(this._scrollY/this.itemHeight())},Window_Selectable.prototype.maxTopRow=function(){return Math.max(0,this.maxRows()-this.maxPageRows())},Window_Selectable.prototype.setTopRow=function(a){var b=a.clamp(0,this.maxTopRow())*this.itemHeight();this._scrollY!==b&&(this._scrollY=b,this.refresh(),this.updateCursor())},Window_Selectable.prototype.resetScroll=function(){this.setTopRow(0)},Window_Selectable.prototype.maxPageRows=function(){var a=this.height-2*this.padding;return Math.floor(a/this.itemHeight())},Window_Selectable.prototype.maxPageItems=function(){return this.maxPageRows()*this.maxCols()},Window_Selectable.prototype.isHorizontal=function(){return 1===this.maxPageRows()},Window_Selectable.prototype.bottomRow=function(){return Math.max(0,this.topRow()+this.maxPageRows()-1)},Window_Selectable.prototype.setBottomRow=function(a){this.setTopRow(a-(this.maxPageRows()-1))},Window_Selectable.prototype.topIndex=function(){return this.topRow()*this.maxCols()},Window_Selectable.prototype.itemRect=function(a){var b=new Rectangle,c=this.maxCols();return b.width=this.itemWidth(),b.height=this.itemHeight(),b.x=a%c*(b.width+this.spacing())-this._scrollX,b.y=Math.floor(a/c)*b.height-this._scrollY,b},Window_Selectable.prototype.itemRectForText=function(a){var b=this.itemRect(a);return b.x+=this.textPadding(),b.width-=2*this.textPadding(),b},Window_Selectable.prototype.setHelpWindow=function(a){this._helpWindow=a,this.callUpdateHelp()},Window_Selectable.prototype.showHelpWindow=function(){this._helpWindow&&this._helpWindow.show()},Window_Selectable.prototype.hideHelpWindow=function(){this._helpWindow&&this._helpWindow.hide()},Window_Selectable.prototype.setHandler=function(a,b){this._handlers[a]=b},Window_Selectable.prototype.isHandled=function(a){return!!this._handlers[a]},Window_Selectable.prototype.callHandler=function(a){this.isHandled(a)&&this._handlers[a]()},Window_Selectable.prototype.isOpenAndActive=function(){return this.isOpen()&&this.active},Window_Selectable.prototype.isCursorMovable=function(){return this.isOpenAndActive()&&!this._cursorFixed&&!this._cursorAll&&this.maxItems()>0},Window_Selectable.prototype.cursorDown=function(a){var b=this.index(),c=this.maxItems(),d=this.maxCols();(c-d>b||a&&1===d)&&this.select((b+d)%c)},Window_Selectable.prototype.cursorUp=function(a){var b=this.index(),c=this.maxItems(),d=this.maxCols();(b>=d||a&&1===d)&&this.select((b-d+c)%c)},Window_Selectable.prototype.cursorRight=function(a){var b=this.index(),c=this.maxItems(),d=this.maxCols();d>=2&&(c-1>b||a&&this.isHorizontal())&&this.select((b+1)%c)},Window_Selectable.prototype.cursorLeft=function(a){var b=this.index(),c=this.maxItems(),d=this.maxCols();d>=2&&(b>0||a&&this.isHorizontal())&&this.select((b-1+c)%c)},Window_Selectable.prototype.cursorPagedown=function(){var a=this.index(),b=this.maxItems();this.topRow()+this.maxPageRows()<this.maxRows()&&(this.setTopRow(this.topRow()+this.maxPageRows()),this.select(Math.min(a+this.maxPageItems(),b-1)))},Window_Selectable.prototype.cursorPageup=function(){var a=this.index();this.topRow()>0&&(this.setTopRow(this.topRow()-this.maxPageRows()),this.select(Math.max(a-this.maxPageItems(),0)))},Window_Selectable.prototype.scrollDown=function(){this.topRow()+1<this.maxRows()&&this.setTopRow(this.topRow()+1)},Window_Selectable.prototype.scrollUp=function(){this.topRow()>0&&this.setTopRow(this.topRow()-1)},Window_Selectable.prototype.update=function(){Window_Base.prototype.update.call(this),this.updateArrows(),this.processCursorMove(),this.processHandling(),this.processWheel(),this.processTouch(),this._stayCount++},Window_Selectable.prototype.updateArrows=function(){var a=this.topRow(),b=this.maxTopRow();this.downArrowVisible=b>0&&b>a,this.upArrowVisible=a>0},Window_Selectable.prototype.processCursorMove=function(){if(this.isCursorMovable()){var a=this.index();Input.isRepeated("down")&&this.cursorDown(Input.isTriggered("down")),Input.isRepeated("up")&&this.cursorUp(Input.isTriggered("up")),Input.isRepeated("right")&&this.cursorRight(Input.isTriggered("right")),Input.isRepeated("left")&&this.cursorLeft(Input.isTriggered("left")),!this.isHandled("pagedown")&&Input.isTriggered("pagedown")&&this.cursorPagedown(),!this.isHandled("pageup")&&Input.isTriggered("pageup")&&this.cursorPageup(),this.index()!==a&&SoundManager.playCursor()}},Window_Selectable.prototype.processHandling=function(){this.isOpenAndActive()&&(this.isOkEnabled()&&this.isOkTriggered()?this.processOk():this.isCancelEnabled()&&this.isCancelTriggered()?this.processCancel():this.isHandled("pagedown")&&Input.isTriggered("pagedown")?this.processPagedown():this.isHandled("pageup")&&Input.isTriggered("pageup")&&this.processPageup())},Window_Selectable.prototype.processWheel=function(){if(this.isOpenAndActive()){var a=20;TouchInput.wheelY>=a&&this.scrollDown(),TouchInput.wheelY<=-a&&this.scrollUp()}},Window_Selectable.prototype.processTouch=function(){this.isOpenAndActive()?(TouchInput.isTriggered()&&this.isTouchedInsideFrame()?(this._touching=!0,this.onTouch(!0)):TouchInput.isCancelled()&&this.isCancelEnabled()&&this.processCancel(),this._touching&&(TouchInput.isPressed()?this.onTouch(!1):this._touching=!1)):this._touching=!1},Window_Selectable.prototype.isTouchedInsideFrame=function(){var a=this.canvasToLocalX(TouchInput.x),b=this.canvasToLocalY(TouchInput.y);return a>=0&&b>=0&&a<this.width&&b<this.height},Window_Selectable.prototype.onTouch=function(a){var b=this.index(),c=this.canvasToLocalX(TouchInput.x),d=this.canvasToLocalY(TouchInput.y),e=this.hitTest(c,d);e>=0?e===this.index()?a&&this.isTouchOkEnabled()&&this.processOk():this.isCursorMovable()&&this.select(e):this._stayCount>=10&&(d<this.padding?this.cursorUp():d>=this.height-this.padding&&this.cursorDown()),this.index()!==b&&SoundManager.playCursor()},Window_Selectable.prototype.hitTest=function(a,b){if(this.isContentsArea(a,b))for(var c=a-this.padding,d=b-this.padding,e=this.topIndex(),f=0;f<this.maxPageItems();f++){var g=e+f;if(g<this.maxItems()){var h=this.itemRect(g),i=h.x+h.width,j=h.y+h.height;if(c>=h.x&&d>=h.y&&i>c&&j>d)return g}}return-1},Window_Selectable.prototype.isContentsArea=function(a,b){var c=this.padding,d=this.padding,e=this.width-this.padding,f=this.height-this.padding;return a>=c&&b>=d&&e>a&&f>b},Window_Selectable.prototype.isTouchOkEnabled=function(){return this.isOkEnabled()},Window_Selectable.prototype.isOkEnabled=function(){return this.isHandled("ok")},Window_Selectable.prototype.isCancelEnabled=function(){return this.isHandled("cancel")},Window_Selectable.prototype.isOkTriggered=function(){return Input.isRepeated("ok")},Window_Selectable.prototype.isCancelTriggered=function(){return Input.isRepeated("cancel")},Window_Selectable.prototype.processOk=function(){this.isCurrentItemEnabled()?(this.playOkSound(),this.updateInputData(),this.deactivate(),this.callOkHandler()):this.playBuzzerSound()},Window_Selectable.prototype.playOkSound=function(){SoundManager.playOk()},Window_Selectable.prototype.playBuzzerSound=function(){SoundManager.playBuzzer()},Window_Selectable.prototype.callOkHandler=function(){this.callHandler("ok")},Window_Selectable.prototype.processCancel=function(){SoundManager.playCancel(),this.updateInputData(),this.deactivate(),this.callCancelHandler()},Window_Selectable.prototype.callCancelHandler=function(){this.callHandler("cancel")},Window_Selectable.prototype.processPageup=function(){SoundManager.playCursor(),this.updateInputData(),this.deactivate(),this.callHandler("pageup")},Window_Selectable.prototype.processPagedown=function(){SoundManager.playCursor(),this.updateInputData(),this.deactivate(),this.callHandler("pagedown")},Window_Selectable.prototype.updateInputData=function(){Input.update(),TouchInput.update()},Window_Selectable.prototype.updateCursor=function(){if(this._cursorAll){var a=this.maxRows()*this.itemHeight();this.setCursorRect(0,0,this.contents.width,a),this.setTopRow(0)}else if(this.isCursorVisible()){var b=this.itemRect(this.index());this.setCursorRect(b.x,b.y,b.width,b.height)}else this.setCursorRect(0,0,0,0)},Window_Selectable.prototype.isCursorVisible=function(){var a=this.row();return a>=this.topRow()&&a<=this.bottomRow()},Window_Selectable.prototype.ensureCursorVisible=function(){var a=this.row();a<this.topRow()?this.setTopRow(a):a>this.bottomRow()&&this.setBottomRow(a)},Window_Selectable.prototype.callUpdateHelp=function(){this.active&&this._helpWindow&&this.updateHelp()},Window_Selectable.prototype.updateHelp=function(){this._helpWindow.clear()},Window_Selectable.prototype.setHelpWindowItem=function(a){this._helpWindow&&this._helpWindow.setItem(a)},Window_Selectable.prototype.isCurrentItemEnabled=function(){return!0},Window_Selectable.prototype.drawAllItems=function(){for(var a=this.topIndex(),b=0;b<this.maxPageItems();b++){var c=a+b;c<this.maxItems()&&this.drawItem(c)}},Window_Selectable.prototype.drawItem=function(a){},Window_Selectable.prototype.clearItem=function(a){var b=this.itemRect(a);this.contents.clearRect(b.x,b.y,b.width,b.height)},Window_Selectable.prototype.redrawItem=function(a){a>=0&&(this.clearItem(a),this.drawItem(a))},Window_Selectable.prototype.redrawCurrentItem=function(){this.redrawItem(this.index())},Window_Selectable.prototype.refresh=function(){this.contents&&(this.contents.clear(),this.drawAllItems())},Window_Command.prototype=Object.create(Window_Selectable.prototype),Window_Command.prototype.constructor=Window_Command,Window_Command.prototype.initialize=function(a,b){this.clearCommandList(),this.makeCommandList();var c=this.windowWidth(),d=this.windowHeight();Window_Selectable.prototype.initialize.call(this,a,b,c,d),this.refresh(),this.select(0),this.activate()},Window_Command.prototype.windowWidth=function(){return 240},Window_Command.prototype.windowHeight=function(){return this.fittingHeight(this.numVisibleRows())},Window_Command.prototype.numVisibleRows=function(){return Math.ceil(this.maxItems()/this.maxCols())},Window_Command.prototype.maxItems=function(){return this._list.length},Window_Command.prototype.clearCommandList=function(){this._list=[]},Window_Command.prototype.makeCommandList=function(){},Window_Command.prototype.addCommand=function(a,b,c,d){void 0===c&&(c=!0),void 0===d&&(d=null),this._list.push({name:a,symbol:b,enabled:c,ext:d})},Window_Command.prototype.commandName=function(a){return this._list[a].name},Window_Command.prototype.commandSymbol=function(a){return this._list[a].symbol},Window_Command.prototype.isCommandEnabled=function(a){return this._list[a].enabled},Window_Command.prototype.currentData=function(){return this.index()>=0?this._list[this.index()]:null},Window_Command.prototype.isCurrentItemEnabled=function(){return this.currentData()?this.currentData().enabled:!1},Window_Command.prototype.currentSymbol=function(){return this.currentData()?this.currentData().symbol:null},Window_Command.prototype.currentExt=function(){return this.currentData()?this.currentData().ext:null},Window_Command.prototype.findSymbol=function(a){for(var b=0;b<this._list.length;b++)if(this._list[b].symbol===a)return b;return-1},Window_Command.prototype.selectSymbol=function(a){var b=this.findSymbol(a);b>=0?this.select(b):this.select(0)},Window_Command.prototype.findExt=function(a){for(var b=0;b<this._list.length;b++)if(this._list[b].ext===a)return b;return-1},Window_Command.prototype.selectExt=function(a){var b=this.findExt(a);b>=0?this.select(b):this.select(0)},Window_Command.prototype.drawItem=function(a){var b=this.itemRectForText(a),c=this.itemTextAlign();this.resetTextColor(),this.changePaintOpacity(this.isCommandEnabled(a)),this.drawText(this.commandName(a),b.x,b.y,b.width,c)},Window_Command.prototype.itemTextAlign=function(){return"left"},Window_Command.prototype.isOkEnabled=function(){return!0},Window_Command.prototype.callOkHandler=function(){var a=this.currentSymbol();this.isHandled(a)?this.callHandler(a):this.isHandled("ok")?Window_Selectable.prototype.callOkHandler.call(this):this.activate()},Window_Command.prototype.refresh=function(){this.clearCommandList(),this.makeCommandList(),this.createContents(),Window_Selectable.prototype.refresh.call(this)},Window_HorzCommand.prototype=Object.create(Window_Command.prototype),Window_HorzCommand.prototype.constructor=Window_HorzCommand,Window_HorzCommand.prototype.initialize=function(a,b){Window_Command.prototype.initialize.call(this,a,b)},Window_HorzCommand.prototype.numVisibleRows=function(){return 1},Window_HorzCommand.prototype.maxCols=function(){return 4},Window_HorzCommand.prototype.itemTextAlign=function(){return"center"},Window_Help.prototype=Object.create(Window_Base.prototype),Window_Help.prototype.constructor=Window_Help,Window_Help.prototype.initialize=function(a){var b=Graphics.boxWidth,c=this.fittingHeight(a||2);Window_Base.prototype.initialize.call(this,0,0,b,c),this._text=""},Window_Help.prototype.setText=function(a){this._text!==a&&(this._text=a,this.refresh())},Window_Help.prototype.clear=function(){this.setText("")},Window_Help.prototype.setItem=function(a){this.setText(a?a.description:"")},Window_Help.prototype.refresh=function(){this.contents.clear(),this.drawTextEx(this._text,this.textPadding(),0)},Window_Gold.prototype=Object.create(Window_Base.prototype),Window_Gold.prototype.constructor=Window_Gold,Window_Gold.prototype.initialize=function(a,b){var c=this.windowWidth(),d=this.windowHeight();Window_Base.prototype.initialize.call(this,a,b,c,d),this.refresh()},Window_Gold.prototype.windowWidth=function(){
return 240},Window_Gold.prototype.windowHeight=function(){return this.fittingHeight(1)},Window_Gold.prototype.refresh=function(){var a=this.textPadding(),b=this.contents.width-2*this.textPadding();this.contents.clear(),this.drawCurrencyValue(this.value(),this.currencyUnit(),a,0,b)},Window_Gold.prototype.value=function(){return $gameParty.gold()},Window_Gold.prototype.currencyUnit=function(){return TextManager.currencyUnit},Window_Gold.prototype.open=function(){this.refresh(),Window_Base.prototype.open.call(this)},Window_MenuCommand.prototype=Object.create(Window_Command.prototype),Window_MenuCommand.prototype.constructor=Window_MenuCommand,Window_MenuCommand.prototype.initialize=function(a,b){Window_Command.prototype.initialize.call(this,a,b),this.selectLast()},Window_MenuCommand._lastCommandSymbol=null,Window_MenuCommand.initCommandPosition=function(){this._lastCommandSymbol=null},Window_MenuCommand.prototype.windowWidth=function(){return 240},Window_MenuCommand.prototype.numVisibleRows=function(){return this.maxItems()},Window_MenuCommand.prototype.makeCommandList=function(){this.addMainCommands(),this.addFormationCommand(),this.addOriginalCommands(),this.addOptionsCommand(),this.addSaveCommand(),this.addGameEndCommand()},Window_MenuCommand.prototype.addMainCommands=function(){var a=this.areMainCommandsEnabled();this.needsCommand("item")&&this.addCommand(TextManager.item,"item",a),this.needsCommand("skill")&&this.addCommand(TextManager.skill,"skill",a),this.needsCommand("equip")&&this.addCommand(TextManager.equip,"equip",a),this.needsCommand("status")&&this.addCommand(TextManager.status,"status",a)},Window_MenuCommand.prototype.addFormationCommand=function(){if(this.needsCommand("formation")){var a=this.isFormationEnabled();this.addCommand(TextManager.formation,"formation",a)}},Window_MenuCommand.prototype.addOriginalCommands=function(){},Window_MenuCommand.prototype.addOptionsCommand=function(){if(this.needsCommand("options")){var a=this.isOptionsEnabled();this.addCommand(TextManager.options,"options",a)}},Window_MenuCommand.prototype.addSaveCommand=function(){if(this.needsCommand("save")){var a=this.isSaveEnabled();this.addCommand(TextManager.save,"save",a)}},Window_MenuCommand.prototype.addGameEndCommand=function(){var a=this.isGameEndEnabled();this.addCommand(TextManager.gameEnd,"gameEnd",a)},Window_MenuCommand.prototype.needsCommand=function(a){var b=$dataSystem.menuCommands;if(b)switch(a){case"item":return b[0];case"skill":return b[1];case"equip":return b[2];case"status":return b[3];case"formation":return b[4];case"save":return b[5]}return!0},Window_MenuCommand.prototype.areMainCommandsEnabled=function(){return $gameParty.exists()},Window_MenuCommand.prototype.isFormationEnabled=function(){return $gameParty.size()>=2&&$gameSystem.isFormationEnabled()},Window_MenuCommand.prototype.isOptionsEnabled=function(){return!0},Window_MenuCommand.prototype.isSaveEnabled=function(){return!DataManager.isEventTest()&&$gameSystem.isSaveEnabled()},Window_MenuCommand.prototype.isGameEndEnabled=function(){return!0},Window_MenuCommand.prototype.processOk=function(){Window_MenuCommand._lastCommandSymbol=this.currentSymbol(),Window_Command.prototype.processOk.call(this)},Window_MenuCommand.prototype.selectLast=function(){this.selectSymbol(Window_MenuCommand._lastCommandSymbol)},Window_MenuStatus.prototype=Object.create(Window_Selectable.prototype),Window_MenuStatus.prototype.constructor=Window_MenuStatus,Window_MenuStatus.prototype.initialize=function(a,b){var c=this.windowWidth(),d=this.windowHeight();Window_Selectable.prototype.initialize.call(this,a,b,c,d),this._formationMode=!1,this._pendingIndex=-1,this.loadImages(),this.refresh()},Window_MenuStatus.prototype.windowWidth=function(){return Graphics.boxWidth-240},Window_MenuStatus.prototype.windowHeight=function(){return Graphics.boxHeight},Window_MenuStatus.prototype.maxItems=function(){return $gameParty.size()},Window_MenuStatus.prototype.itemHeight=function(){var a=this.height-2*this.padding;return Math.floor(a/this.numVisibleRows())},Window_MenuStatus.prototype.numVisibleRows=function(){return 4},Window_MenuStatus.prototype.loadImages=function(){$gameParty.members().forEach(function(a){ImageManager.loadFace(a.faceName())},this)},Window_MenuStatus.prototype.drawItem=function(a){this.drawItemBackground(a),this.drawItemImage(a),this.drawItemStatus(a)},Window_MenuStatus.prototype.drawItemBackground=function(a){if(a===this._pendingIndex){var b=this.itemRect(a),c=this.pendingColor();this.changePaintOpacity(!1),this.contents.fillRect(b.x,b.y,b.width,b.height,c),this.changePaintOpacity(!0)}},Window_MenuStatus.prototype.drawItemImage=function(a){var b=$gameParty.members()[a],c=this.itemRect(a);this.changePaintOpacity(b.isBattleMember()),this.drawActorFace(b,c.x+1,c.y+1,144,c.height-2),this.changePaintOpacity(!0)},Window_MenuStatus.prototype.drawItemStatus=function(a){var b=$gameParty.members()[a],c=this.itemRect(a),d=c.x+162,e=c.y+c.height/2-1.5*this.lineHeight(),f=c.width-d-this.textPadding();this.drawActorSimpleStatus(b,d,e,f)},Window_MenuStatus.prototype.processOk=function(){Window_Selectable.prototype.processOk.call(this),$gameParty.setMenuActor($gameParty.members()[this.index()])},Window_MenuStatus.prototype.isCurrentItemEnabled=function(){if(this._formationMode){var a=$gameParty.members()[this.index()];return a&&a.isFormationChangeOk()}return!0},Window_MenuStatus.prototype.selectLast=function(){this.select($gameParty.menuActor().index()||0)},Window_MenuStatus.prototype.formationMode=function(){return this._formationMode},Window_MenuStatus.prototype.setFormationMode=function(a){this._formationMode=a},Window_MenuStatus.prototype.pendingIndex=function(){return this._pendingIndex},Window_MenuStatus.prototype.setPendingIndex=function(a){var b=this._pendingIndex;this._pendingIndex=a,this.redrawItem(this._pendingIndex),this.redrawItem(b)},Window_MenuActor.prototype=Object.create(Window_MenuStatus.prototype),Window_MenuActor.prototype.constructor=Window_MenuActor,Window_MenuActor.prototype.initialize=function(){Window_MenuStatus.prototype.initialize.call(this,0,0),this.hide()},Window_MenuActor.prototype.processOk=function(){this.cursorAll()||$gameParty.setTargetActor($gameParty.members()[this.index()]),this.callOkHandler()},Window_MenuActor.prototype.selectLast=function(){this.select($gameParty.targetActor().index()||0)},Window_MenuActor.prototype.selectForItem=function(a){var b=$gameParty.menuActor(),c=new Game_Action(b);c.setItemObject(a),this.setCursorFixed(!1),this.setCursorAll(!1),c.isForUser()?DataManager.isSkill(a)?(this.setCursorFixed(!0),this.select(b.index())):this.selectLast():c.isForAll()?(this.setCursorAll(!0),this.select(0)):this.selectLast()},Window_ItemCategory.prototype=Object.create(Window_HorzCommand.prototype),Window_ItemCategory.prototype.constructor=Window_ItemCategory,Window_ItemCategory.prototype.initialize=function(){Window_HorzCommand.prototype.initialize.call(this,0,0)},Window_ItemCategory.prototype.windowWidth=function(){return Graphics.boxWidth},Window_ItemCategory.prototype.maxCols=function(){return 4},Window_ItemCategory.prototype.update=function(){Window_HorzCommand.prototype.update.call(this),this._itemWindow&&this._itemWindow.setCategory(this.currentSymbol())},Window_ItemCategory.prototype.makeCommandList=function(){this.addCommand(TextManager.item,"item"),this.addCommand(TextManager.weapon,"weapon"),this.addCommand(TextManager.armor,"armor"),this.addCommand(TextManager.keyItem,"keyItem")},Window_ItemCategory.prototype.setItemWindow=function(a){this._itemWindow=a,this.update()},Window_ItemList.prototype=Object.create(Window_Selectable.prototype),Window_ItemList.prototype.constructor=Window_ItemList,Window_ItemList.prototype.initialize=function(a,b,c,d){Window_Selectable.prototype.initialize.call(this,a,b,c,d),this._category="none",this._data=[]},Window_ItemList.prototype.setCategory=function(a){this._category!==a&&(this._category=a,this.refresh(),this.resetScroll())},Window_ItemList.prototype.maxCols=function(){return 2},Window_ItemList.prototype.spacing=function(){return 48},Window_ItemList.prototype.maxItems=function(){return this._data?this._data.length:1},Window_ItemList.prototype.item=function(){var a=this.index();return this._data&&a>=0?this._data[a]:null},Window_ItemList.prototype.isCurrentItemEnabled=function(){return this.isEnabled(this.item())},Window_ItemList.prototype.includes=function(a){switch(this._category){case"item":return DataManager.isItem(a)&&1===a.itypeId;case"weapon":return DataManager.isWeapon(a);case"armor":return DataManager.isArmor(a);case"keyItem":return DataManager.isItem(a)&&2===a.itypeId;default:return!1}},Window_ItemList.prototype.needsNumber=function(){return!0},Window_ItemList.prototype.isEnabled=function(a){return $gameParty.canUse(a)},Window_ItemList.prototype.makeItemList=function(){this._data=$gameParty.allItems().filter(function(a){return this.includes(a)},this),this.includes(null)&&this._data.push(null)},Window_ItemList.prototype.selectLast=function(){var a=this._data.indexOf($gameParty.lastItem());this.select(a>=0?a:0)},Window_ItemList.prototype.drawItem=function(a){var b=this._data[a];if(b){var c=this.numberWidth(),d=this.itemRect(a);d.width-=this.textPadding(),this.changePaintOpacity(this.isEnabled(b)),this.drawItemName(b,d.x,d.y,d.width-c),this.drawItemNumber(b,d.x,d.y,d.width),this.changePaintOpacity(1)}},Window_ItemList.prototype.numberWidth=function(){return this.textWidth("000")},Window_ItemList.prototype.drawItemNumber=function(a,b,c,d){this.needsNumber()&&(this.drawText(":",b,c,d-this.textWidth("00"),"right"),this.drawText($gameParty.numItems(a),b,c,d,"right"))},Window_ItemList.prototype.updateHelp=function(){this.setHelpWindowItem(this.item())},Window_ItemList.prototype.refresh=function(){this.makeItemList(),this.createContents(),this.drawAllItems()},Window_SkillType.prototype=Object.create(Window_Command.prototype),Window_SkillType.prototype.constructor=Window_SkillType,Window_SkillType.prototype.initialize=function(a,b){Window_Command.prototype.initialize.call(this,a,b),this._actor=null},Window_SkillType.prototype.windowWidth=function(){return 240},Window_SkillType.prototype.setActor=function(a){this._actor!==a&&(this._actor=a,this.refresh(),this.selectLast())},Window_SkillType.prototype.numVisibleRows=function(){return 4},Window_SkillType.prototype.makeCommandList=function(){if(this._actor){var a=this._actor.addedSkillTypes();a.sort(function(a,b){return a-b}),a.forEach(function(a){var b=$dataSystem.skillTypes[a];this.addCommand(b,"skill",!0,a)},this)}},Window_SkillType.prototype.update=function(){Window_Command.prototype.update.call(this),this._skillWindow&&this._skillWindow.setStypeId(this.currentExt())},Window_SkillType.prototype.setSkillWindow=function(a){this._skillWindow=a,this.update()},Window_SkillType.prototype.selectLast=function(){var a=this._actor.lastMenuSkill();a?this.selectExt(a.stypeId):this.select(0)},Window_SkillStatus.prototype=Object.create(Window_Base.prototype),Window_SkillStatus.prototype.constructor=Window_SkillStatus,Window_SkillStatus.prototype.initialize=function(a,b,c,d){Window_Base.prototype.initialize.call(this,a,b,c,d),this._actor=null},Window_SkillStatus.prototype.setActor=function(a){this._actor!==a&&(this._actor=a,this.refresh())},Window_SkillStatus.prototype.refresh=function(){if(this.contents.clear(),this._actor){var a=this.width-2*this.padding,b=this.height-2*this.padding,c=b/2-1.5*this.lineHeight(),d=a-162-this.textPadding();this.drawActorFace(this._actor,0,0,144,b),this.drawActorSimpleStatus(this._actor,162,c,d)}},Window_SkillList.prototype=Object.create(Window_Selectable.prototype),Window_SkillList.prototype.constructor=Window_SkillList,Window_SkillList.prototype.initialize=function(a,b,c,d){Window_Selectable.prototype.initialize.call(this,a,b,c,d),this._actor=null,this._stypeId=0,this._data=[]},Window_SkillList.prototype.setActor=function(a){this._actor!==a&&(this._actor=a,this.refresh(),this.resetScroll())},Window_SkillList.prototype.setStypeId=function(a){this._stypeId!==a&&(this._stypeId=a,this.refresh(),this.resetScroll())},Window_SkillList.prototype.maxCols=function(){return 2},Window_SkillList.prototype.spacing=function(){return 48},Window_SkillList.prototype.maxItems=function(){return this._data?this._data.length:1},Window_SkillList.prototype.item=function(){return this._data&&this.index()>=0?this._data[this.index()]:null},Window_SkillList.prototype.isCurrentItemEnabled=function(){return this.isEnabled(this._data[this.index()])},Window_SkillList.prototype.includes=function(a){return a&&a.stypeId===this._stypeId},Window_SkillList.prototype.isEnabled=function(a){return this._actor&&this._actor.canUse(a)},Window_SkillList.prototype.makeItemList=function(){this._actor?this._data=this._actor.skills().filter(function(a){return this.includes(a)},this):this._data=[]},Window_SkillList.prototype.selectLast=function(){var a;a=$gameParty.inBattle()?this._actor.lastBattleSkill():this._actor.lastMenuSkill();var b=this._data.indexOf(a);this.select(b>=0?b:0)},Window_SkillList.prototype.drawItem=function(a){var b=this._data[a];if(b){var c=this.costWidth(),d=this.itemRect(a);d.width-=this.textPadding(),this.changePaintOpacity(this.isEnabled(b)),this.drawItemName(b,d.x,d.y,d.width-c),this.drawSkillCost(b,d.x,d.y,d.width),this.changePaintOpacity(1)}},Window_SkillList.prototype.costWidth=function(){return this.textWidth("000")},Window_SkillList.prototype.drawSkillCost=function(a,b,c,d){this._actor.skillTpCost(a)>0?(this.changeTextColor(this.tpCostColor()),this.drawText(this._actor.skillTpCost(a),b,c,d,"right")):this._actor.skillMpCost(a)>0&&(this.changeTextColor(this.mpCostColor()),this.drawText(this._actor.skillMpCost(a),b,c,d,"right"))},Window_SkillList.prototype.updateHelp=function(){this.setHelpWindowItem(this.item())},Window_SkillList.prototype.refresh=function(){this.makeItemList(),this.createContents(),this.drawAllItems()},Window_EquipStatus.prototype=Object.create(Window_Base.prototype),Window_EquipStatus.prototype.constructor=Window_EquipStatus,Window_EquipStatus.prototype.initialize=function(a,b){var c=this.windowWidth(),d=this.windowHeight();Window_Base.prototype.initialize.call(this,a,b,c,d),this._actor=null,this._tempActor=null,this.refresh()},Window_EquipStatus.prototype.windowWidth=function(){return 312},Window_EquipStatus.prototype.windowHeight=function(){return this.fittingHeight(this.numVisibleRows())},Window_EquipStatus.prototype.numVisibleRows=function(){return 7},Window_EquipStatus.prototype.setActor=function(a){this._actor!==a&&(this._actor=a,this.refresh())},Window_EquipStatus.prototype.refresh=function(){if(this.contents.clear(),this._actor){this.drawActorName(this._actor,this.textPadding(),0);for(var a=0;6>a;a++)this.drawItem(0,this.lineHeight()*(1+a),2+a)}},Window_EquipStatus.prototype.setTempActor=function(a){this._tempActor!==a&&(this._tempActor=a,this.refresh())},Window_EquipStatus.prototype.drawItem=function(a,b,c){this.drawParamName(a+this.textPadding(),b,c),this._actor&&this.drawCurrentParam(a+140,b,c),this.drawRightArrow(a+188,b),this._tempActor&&this.drawNewParam(a+222,b,c)},Window_EquipStatus.prototype.drawParamName=function(a,b,c){this.changeTextColor(this.systemColor()),this.drawText(TextManager.param(c),a,b,120)},Window_EquipStatus.prototype.drawCurrentParam=function(a,b,c){this.resetTextColor(),this.drawText(this._actor.param(c),a,b,48,"right")},Window_EquipStatus.prototype.drawRightArrow=function(a,b){this.changeTextColor(this.systemColor()),this.drawText("→",a,b,32,"center")},Window_EquipStatus.prototype.drawNewParam=function(a,b,c){var d=this._tempActor.param(c),e=d-this._actor.param(c);this.changeTextColor(this.paramchangeTextColor(e)),this.drawText(d,a,b,48,"right")},Window_EquipCommand.prototype=Object.create(Window_HorzCommand.prototype),Window_EquipCommand.prototype.constructor=Window_EquipCommand,Window_EquipCommand.prototype.initialize=function(a,b,c){this._windowWidth=c,Window_HorzCommand.prototype.initialize.call(this,a,b)},Window_EquipCommand.prototype.windowWidth=function(){return this._windowWidth},Window_EquipCommand.prototype.maxCols=function(){return 3},Window_EquipCommand.prototype.makeCommandList=function(){this.addCommand(TextManager.equip2,"equip"),this.addCommand(TextManager.optimize,"optimize"),this.addCommand(TextManager.clear,"clear")},Window_EquipSlot.prototype=Object.create(Window_Selectable.prototype),Window_EquipSlot.prototype.constructor=Window_EquipSlot,Window_EquipSlot.prototype.initialize=function(a,b,c,d){Window_Selectable.prototype.initialize.call(this,a,b,c,d),this._actor=null,this.refresh()},Window_EquipSlot.prototype.setActor=function(a){this._actor!==a&&(this._actor=a,this.refresh())},Window_EquipSlot.prototype.update=function(){Window_Selectable.prototype.update.call(this),this._itemWindow&&this._itemWindow.setSlotId(this.index())},Window_EquipSlot.prototype.maxItems=function(){return this._actor?this._actor.equipSlots().length:0},Window_EquipSlot.prototype.item=function(){return this._actor?this._actor.equips()[this.index()]:null},Window_EquipSlot.prototype.drawItem=function(a){if(this._actor){var b=this.itemRectForText(a);this.changeTextColor(this.systemColor()),this.changePaintOpacity(this.isEnabled(a)),this.drawText(this.slotName(a),b.x,b.y,138,this.lineHeight()),this.drawItemName(this._actor.equips()[a],b.x+138,b.y),this.changePaintOpacity(!0)}},Window_EquipSlot.prototype.slotName=function(a){var b=this._actor.equipSlots();return this._actor?$dataSystem.equipTypes[b[a]]:""},Window_EquipSlot.prototype.isEnabled=function(a){return this._actor?this._actor.isEquipChangeOk(a):!1},Window_EquipSlot.prototype.isCurrentItemEnabled=function(){return this.isEnabled(this.index())},Window_EquipSlot.prototype.setStatusWindow=function(a){this._statusWindow=a,this.callUpdateHelp()},Window_EquipSlot.prototype.setItemWindow=function(a){this._itemWindow=a,this.update()},Window_EquipSlot.prototype.updateHelp=function(){Window_Selectable.prototype.updateHelp.call(this),this.setHelpWindowItem(this.item()),this._statusWindow&&this._statusWindow.setTempActor(null)},Window_EquipItem.prototype=Object.create(Window_ItemList.prototype),Window_EquipItem.prototype.constructor=Window_EquipItem,Window_EquipItem.prototype.initialize=function(a,b,c,d){Window_ItemList.prototype.initialize.call(this,a,b,c,d),this._actor=null,this._slotId=0},Window_EquipItem.prototype.setActor=function(a){this._actor!==a&&(this._actor=a,this.refresh(),this.resetScroll())},Window_EquipItem.prototype.setSlotId=function(a){this._slotId!==a&&(this._slotId=a,this.refresh(),this.resetScroll())},Window_EquipItem.prototype.includes=function(a){return null===a?!0:this._slotId<0||a.etypeId!==this._actor.equipSlots()[this._slotId]?!1:this._actor.canEquip(a)},Window_EquipItem.prototype.isEnabled=function(a){return!0},Window_EquipItem.prototype.selectLast=function(){},Window_EquipItem.prototype.setStatusWindow=function(a){this._statusWindow=a,this.callUpdateHelp()},Window_EquipItem.prototype.updateHelp=function(){if(Window_ItemList.prototype.updateHelp.call(this),this._actor&&this._statusWindow){var a=JsonEx.makeDeepCopy(this._actor);a.forceChangeEquip(this._slotId,this.item()),this._statusWindow.setTempActor(a)}},Window_EquipItem.prototype.playOkSound=function(){},Window_Status.prototype=Object.create(Window_Selectable.prototype),Window_Status.prototype.constructor=Window_Status,Window_Status.prototype.initialize=function(){var a=Graphics.boxWidth,b=Graphics.boxHeight;Window_Selectable.prototype.initialize.call(this,0,0,a,b),this.refresh(),this.activate()},Window_Status.prototype.setActor=function(a){this._actor!==a&&(this._actor=a,this.refresh())},Window_Status.prototype.refresh=function(){if(this.contents.clear(),this._actor){var a=this.lineHeight();this.drawBlock1(0*a),this.drawHorzLine(1*a),this.drawBlock2(2*a),this.drawHorzLine(6*a),this.drawBlock3(7*a),this.drawHorzLine(13*a),this.drawBlock4(14*a)}},Window_Status.prototype.drawBlock1=function(a){this.drawActorName(this._actor,6,a),this.drawActorClass(this._actor,192,a),this.drawActorNickname(this._actor,432,a)},Window_Status.prototype.drawBlock2=function(a){this.drawActorFace(this._actor,12,a),this.drawBasicInfo(204,a),this.drawExpInfo(456,a)},Window_Status.prototype.drawBlock3=function(a){this.drawParameters(48,a),this.drawEquipments(432,a)},Window_Status.prototype.drawBlock4=function(a){this.drawProfile(6,a)},Window_Status.prototype.drawHorzLine=function(a){var b=a+this.lineHeight()/2-1;this.contents.paintOpacity=48,this.contents.fillRect(0,b,this.contentsWidth(),2,this.lineColor()),this.contents.paintOpacity=255},Window_Status.prototype.lineColor=function(){return this.normalColor()},Window_Status.prototype.drawBasicInfo=function(a,b){var c=this.lineHeight();this.drawActorLevel(this._actor,a,b+0*c),this.drawActorIcons(this._actor,a,b+1*c),this.drawActorHp(this._actor,a,b+2*c),this.drawActorMp(this._actor,a,b+3*c)},Window_Status.prototype.drawParameters=function(a,b){for(var c=this.lineHeight(),d=0;6>d;d++){var e=d+2,f=b+c*d;this.changeTextColor(this.systemColor()),this.drawText(TextManager.param(e),a,f,160),this.resetTextColor(),this.drawText(this._actor.param(e),a+160,f,60,"right")}},Window_Status.prototype.drawExpInfo=function(a,b){var c=this.lineHeight(),d=TextManager.expTotal.format(TextManager.exp),e=TextManager.expNext.format(TextManager.level),f=this._actor.currentExp(),g=this._actor.nextRequiredExp();this._actor.isMaxLevel()&&(f="-------",g="-------"),this.changeTextColor(this.systemColor()),this.drawText(d,a,b+0*c,270),this.drawText(e,a,b+2*c,270),this.resetTextColor(),this.drawText(f,a,b+1*c,270,"right"),this.drawText(g,a,b+3*c,270,"right")},Window_Status.prototype.drawEquipments=function(a,b){for(var c=this._actor.equips(),d=Math.min(c.length,this.maxEquipmentLines()),e=0;d>e;e++)this.drawItemName(c[e],a,b+this.lineHeight()*e)},Window_Status.prototype.drawProfile=function(a,b){this.drawTextEx(this._actor.profile(),a,b)},Window_Status.prototype.maxEquipmentLines=function(){return 6},Window_Options.prototype=Object.create(Window_Command.prototype),Window_Options.prototype.constructor=Window_Options,Window_Options.prototype.initialize=function(){Window_Command.prototype.initialize.call(this,0,0),this.updatePlacement()},Window_Options.prototype.windowWidth=function(){return 400},Window_Options.prototype.windowHeight=function(){return this.fittingHeight(Math.min(this.numVisibleRows(),12))},Window_Options.prototype.updatePlacement=function(){this.x=(Graphics.boxWidth-this.width)/2,this.y=(Graphics.boxHeight-this.height)/2},Window_Options.prototype.makeCommandList=function(){this.addGeneralOptions(),this.addVolumeOptions()},Window_Options.prototype.addGeneralOptions=function(){this.addCommand(TextManager.alwaysDash,"alwaysDash"),this.addCommand(TextManager.commandRemember,"commandRemember")},Window_Options.prototype.addVolumeOptions=function(){this.addCommand(TextManager.bgmVolume,"bgmVolume"),this.addCommand(TextManager.bgsVolume,"bgsVolume"),this.addCommand(TextManager.meVolume,"meVolume"),this.addCommand(TextManager.seVolume,"seVolume")},Window_Options.prototype.drawItem=function(a){var b=this.itemRectForText(a),c=this.statusWidth(),d=b.width-c;this.resetTextColor(),this.changePaintOpacity(this.isCommandEnabled(a)),this.drawText(this.commandName(a),b.x,b.y,d,"left"),this.drawText(this.statusText(a),d,b.y,c,"right")},Window_Options.prototype.statusWidth=function(){return 120},Window_Options.prototype.statusText=function(a){var b=this.commandSymbol(a),c=this.getConfigValue(b);return this.isVolumeSymbol(b)?this.volumeStatusText(c):this.booleanStatusText(c)},Window_Options.prototype.isVolumeSymbol=function(a){return a.contains("Volume")},Window_Options.prototype.booleanStatusText=function(a){return a?"ON":"OFF"},Window_Options.prototype.volumeStatusText=function(a){return a+"%"},Window_Options.prototype.processOk=function(){var a=this.index(),b=this.commandSymbol(a),c=this.getConfigValue(b);this.isVolumeSymbol(b)?(c+=this.volumeOffset(),c>100&&(c=0),c=c.clamp(0,100),this.changeValue(b,c)):this.changeValue(b,!c)},Window_Options.prototype.cursorRight=function(a){var b=this.index(),c=this.commandSymbol(b),d=this.getConfigValue(c);this.isVolumeSymbol(c)?(d+=this.volumeOffset(),d=d.clamp(0,100),this.changeValue(c,d)):this.changeValue(c,!0)},Window_Options.prototype.cursorLeft=function(a){var b=this.index(),c=this.commandSymbol(b),d=this.getConfigValue(c);this.isVolumeSymbol(c)?(d-=this.volumeOffset(),d=d.clamp(0,100),this.changeValue(c,d)):this.changeValue(c,!1)},Window_Options.prototype.volumeOffset=function(){return 20},Window_Options.prototype.changeValue=function(a,b){var c=this.getConfigValue(a);c!==b&&(this.setConfigValue(a,b),this.redrawItem(this.findSymbol(a)),SoundManager.playCursor())},Window_Options.prototype.getConfigValue=function(a){return ConfigManager[a]},Window_Options.prototype.setConfigValue=function(a,b){ConfigManager[a]=b},Window_SavefileList.prototype=Object.create(Window_Selectable.prototype),Window_SavefileList.prototype.constructor=Window_SavefileList,Window_SavefileList.prototype.initialize=function(a,b,c,d){Window_Selectable.prototype.initialize.call(this,a,b,c,d),this.activate(),this._mode=null},Window_SavefileList.prototype.setMode=function(a){this._mode=a},Window_SavefileList.prototype.maxItems=function(){return DataManager.maxSavefiles()},Window_SavefileList.prototype.maxVisibleItems=function(){return 5},Window_SavefileList.prototype.itemHeight=function(){var a=this.height-2*this.padding;return Math.floor(a/this.maxVisibleItems())},Window_SavefileList.prototype.drawItem=function(a){var b=a+1,c=DataManager.isThisGameFile(b),d=DataManager.loadSavefileInfo(b),e=this.itemRectForText(a);this.resetTextColor(),"load"===this._mode&&this.changePaintOpacity(c),this.drawFileId(b,e.x,e.y),d&&(this.changePaintOpacity(c),this.drawContents(d,e,c),this.changePaintOpacity(!0))},Window_SavefileList.prototype.drawFileId=function(a,b,c){this.drawText(TextManager.file+" "+a,b,c,180)},Window_SavefileList.prototype.drawContents=function(a,b,c){var d=b.y+b.height;b.width>=420&&(this.drawGameTitle(a,b.x+192,b.y,b.width-192),c&&this.drawPartyCharacters(a,b.x+220,d-4));var e=this.lineHeight(),f=d-e;f>=e&&this.drawPlaytime(a,b.x,f,b.width)},Window_SavefileList.prototype.drawGameTitle=function(a,b,c,d){a.title&&this.drawText(a.title,b,c,d)},Window_SavefileList.prototype.drawPartyCharacters=function(a,b,c){if(a.characters)for(var d=0;d<a.characters.length;d++){var e=a.characters[d];this.drawCharacter(e[0],e[1],b+48*d,c)}},Window_SavefileList.prototype.drawPlaytime=function(a,b,c,d){a.playtime&&this.drawText(a.playtime,b,c,d,"right")},Window_SavefileList.prototype.playOkSound=function(){},Window_ShopCommand.prototype=Object.create(Window_HorzCommand.prototype),Window_ShopCommand.prototype.constructor=Window_ShopCommand,Window_ShopCommand.prototype.initialize=function(a,b){this._windowWidth=a,this._purchaseOnly=b,Window_HorzCommand.prototype.initialize.call(this,0,0)},Window_ShopCommand.prototype.windowWidth=function(){return this._windowWidth},Window_ShopCommand.prototype.maxCols=function(){return 3},Window_ShopCommand.prototype.makeCommandList=function(){this.addCommand(TextManager.buy,"buy"),this.addCommand(TextManager.sell,"sell",!this._purchaseOnly),this.addCommand(TextManager.cancel,"cancel")},Window_ShopBuy.prototype=Object.create(Window_Selectable.prototype),Window_ShopBuy.prototype.constructor=Window_ShopBuy,Window_ShopBuy.prototype.initialize=function(a,b,c,d){var e=this.windowWidth();Window_Selectable.prototype.initialize.call(this,a,b,e,c),this._shopGoods=d,this._money=0,this.refresh(),this.select(0)},Window_ShopBuy.prototype.windowWidth=function(){return 456},Window_ShopBuy.prototype.maxItems=function(){return this._data?this._data.length:1},Window_ShopBuy.prototype.item=function(){return this._data[this.index()]},Window_ShopBuy.prototype.setMoney=function(a){this._money=a,this.refresh()},Window_ShopBuy.prototype.isCurrentItemEnabled=function(){return this.isEnabled(this._data[this.index()])},Window_ShopBuy.prototype.price=function(a){return this._price[this._data.indexOf(a)]||0},Window_ShopBuy.prototype.isEnabled=function(a){return a&&this.price(a)<=this._money&&!$gameParty.hasMaxItems(a)},Window_ShopBuy.prototype.refresh=function(){this.makeItemList(),this.createContents(),this.drawAllItems()},Window_ShopBuy.prototype.makeItemList=function(){this._data=[],this._price=[],this._shopGoods.forEach(function(a){var b=null;switch(a[0]){case 0:b=$dataItems[a[1]];break;case 1:b=$dataWeapons[a[1]];break;case 2:b=$dataArmors[a[1]]}b&&(this._data.push(b),this._price.push(0===a[2]?b.price:a[3]))},this)},Window_ShopBuy.prototype.drawItem=function(a){var b=this._data[a],c=this.itemRect(a),d=96;c.width-=this.textPadding(),this.changePaintOpacity(this.isEnabled(b)),this.drawItemName(b,c.x,c.y,c.width-d),this.drawText(this.price(b),c.x+c.width-d,c.y,d,"right"),this.changePaintOpacity(!0)},Window_ShopBuy.prototype.setStatusWindow=function(a){this._statusWindow=a,this.callUpdateHelp()},Window_ShopBuy.prototype.updateHelp=function(){this.setHelpWindowItem(this.item()),this._statusWindow&&this._statusWindow.setItem(this.item())},Window_ShopSell.prototype=Object.create(Window_ItemList.prototype),Window_ShopSell.prototype.constructor=Window_ShopSell,Window_ShopSell.prototype.initialize=function(a,b,c,d){Window_ItemList.prototype.initialize.call(this,a,b,c,d)},Window_ShopSell.prototype.isEnabled=function(a){return a&&a.price>0},Window_ShopNumber.prototype=Object.create(Window_Selectable.prototype),Window_ShopNumber.prototype.constructor=Window_ShopNumber,Window_ShopNumber.prototype.initialize=function(a,b,c){var d=this.windowWidth();Window_Selectable.prototype.initialize.call(this,a,b,d,c),this._item=null,this._max=1,this._price=0,this._number=1,this._currencyUnit=TextManager.currencyUnit,this.createButtons()},Window_ShopNumber.prototype.windowWidth=function(){return 456},Window_ShopNumber.prototype.number=function(){return this._number},Window_ShopNumber.prototype.setup=function(a,b,c){this._item=a,this._max=Math.floor(b),this._price=c,this._number=1,this.placeButtons(),this.updateButtonsVisiblity(),this.refresh()},Window_ShopNumber.prototype.setCurrencyUnit=function(a){this._currencyUnit=a,this.refresh()},Window_ShopNumber.prototype.createButtons=function(){var a=ImageManager.loadSystem("ButtonSet"),b=48,c=48;this._buttons=[];for(var d=0;5>d;d++){var e=new Sprite_Button,f=b*d,g=b*(4===d?2:1);e.bitmap=a,e.setColdFrame(f,0,g,c),e.setHotFrame(f,c,g,c),e.visible=!1,this._buttons.push(e),this.addChild(e)}this._buttons[0].setClickHandler(this.onButtonDown2.bind(this)),this._buttons[1].setClickHandler(this.onButtonDown.bind(this)),this._buttons[2].setClickHandler(this.onButtonUp.bind(this)),this._buttons[3].setClickHandler(this.onButtonUp2.bind(this)),this._buttons[4].setClickHandler(this.onButtonOk.bind(this))},Window_ShopNumber.prototype.placeButtons=function(){for(var a=this._buttons.length,b=16,c=-b,d=0;a>d;d++)c+=this._buttons[d].width+b;for(var e=(this.width-c)/2,f=0;a>f;f++){var g=this._buttons[f];g.x=e,g.y=this.buttonY(),e+=g.width+b}},Window_ShopNumber.prototype.updateButtonsVisiblity=function(){TouchInput.date>Input.date?this.showButtons():this.hideButtons()},Window_ShopNumber.prototype.showButtons=function(){for(var a=0;a<this._buttons.length;a++)this._buttons[a].visible=!0},Window_ShopNumber.prototype.hideButtons=function(){for(var a=0;a<this._buttons.length;a++)this._buttons[a].visible=!1},Window_ShopNumber.prototype.refresh=function(){this.contents.clear(),this.drawItemName(this._item,0,this.itemY()),this.drawMultiplicationSign(),this.drawNumber(),this.drawTotalPrice()},Window_ShopNumber.prototype.drawMultiplicationSign=function(){var a="×",b=this.textWidth(a),c=this.cursorX()-2*b,d=this.itemY();this.resetTextColor(),this.drawText(a,c,d,b)},Window_ShopNumber.prototype.drawNumber=function(){var a=this.cursorX(),b=this.itemY(),c=this.cursorWidth()-this.textPadding();
this.resetTextColor(),this.drawText(this._number,a,b,c,"right")},Window_ShopNumber.prototype.drawTotalPrice=function(){var a=this._price*this._number,b=this.contentsWidth()-this.textPadding();this.drawCurrencyValue(a,this._currencyUnit,0,this.priceY(),b)},Window_ShopNumber.prototype.itemY=function(){return Math.round(this.contentsHeight()/2-1.5*this.lineHeight())},Window_ShopNumber.prototype.priceY=function(){return Math.round(this.contentsHeight()/2+this.lineHeight()/2)},Window_ShopNumber.prototype.buttonY=function(){return Math.round(this.priceY()+2.5*this.lineHeight())},Window_ShopNumber.prototype.cursorWidth=function(){var a=this.textWidth("0");return this.maxDigits()*a+2*this.textPadding()},Window_ShopNumber.prototype.cursorX=function(){return this.contentsWidth()-this.cursorWidth()-this.textPadding()},Window_ShopNumber.prototype.maxDigits=function(){return 2},Window_ShopNumber.prototype.update=function(){Window_Selectable.prototype.update.call(this),this.processNumberChange()},Window_ShopNumber.prototype.isOkTriggered=function(){return Input.isTriggered("ok")},Window_ShopNumber.prototype.playOkSound=function(){},Window_ShopNumber.prototype.processNumberChange=function(){this.isOpenAndActive()&&(Input.isRepeated("right")&&this.changeNumber(1),Input.isRepeated("left")&&this.changeNumber(-1),Input.isRepeated("up")&&this.changeNumber(10),Input.isRepeated("down")&&this.changeNumber(-10))},Window_ShopNumber.prototype.changeNumber=function(a){var b=this._number;this._number=(this._number+a).clamp(1,this._max),this._number!==b&&(SoundManager.playCursor(),this.refresh())},Window_ShopNumber.prototype.updateCursor=function(){this.setCursorRect(this.cursorX(),this.itemY(),this.cursorWidth(),this.lineHeight())},Window_ShopNumber.prototype.onButtonUp=function(){this.changeNumber(1)},Window_ShopNumber.prototype.onButtonUp2=function(){this.changeNumber(10)},Window_ShopNumber.prototype.onButtonDown=function(){this.changeNumber(-1)},Window_ShopNumber.prototype.onButtonDown2=function(){this.changeNumber(-10)},Window_ShopNumber.prototype.onButtonOk=function(){this.processOk()},Window_ShopStatus.prototype=Object.create(Window_Base.prototype),Window_ShopStatus.prototype.constructor=Window_ShopStatus,Window_ShopStatus.prototype.initialize=function(a,b,c,d){Window_Base.prototype.initialize.call(this,a,b,c,d),this._item=null,this._pageIndex=0,this.refresh()},Window_ShopStatus.prototype.refresh=function(){if(this.contents.clear(),this._item){var a=this.textPadding();this.drawPossession(a,0),this.isEquipItem()&&this.drawEquipInfo(a,2*this.lineHeight())}},Window_ShopStatus.prototype.setItem=function(a){this._item=a,this.refresh()},Window_ShopStatus.prototype.isEquipItem=function(){return DataManager.isWeapon(this._item)||DataManager.isArmor(this._item)},Window_ShopStatus.prototype.drawPossession=function(a,b){var c=this.contents.width-this.textPadding()-a,d=this.textWidth("0000");this.changeTextColor(this.systemColor()),this.drawText(TextManager.possession,a,b,c-d),this.resetTextColor(),this.drawText($gameParty.numItems(this._item),a,b,c,"right")},Window_ShopStatus.prototype.drawEquipInfo=function(a,b){for(var c=this.statusMembers(),d=0;d<c.length;d++)this.drawActorEquipInfo(a,b+this.lineHeight()*(2.4*d),c[d])},Window_ShopStatus.prototype.statusMembers=function(){var a=this._pageIndex*this.pageSize(),b=a+this.pageSize();return $gameParty.members().slice(a,b)},Window_ShopStatus.prototype.pageSize=function(){return 4},Window_ShopStatus.prototype.maxPages=function(){return Math.floor(($gameParty.size()+this.pageSize()-1)/this.pageSize())},Window_ShopStatus.prototype.drawActorEquipInfo=function(a,b,c){var d=c.canEquip(this._item);this.changePaintOpacity(d),this.resetTextColor(),this.drawText(c.name(),a,b,168);var e=this.currentEquippedItem(c,this._item.etypeId);d&&this.drawActorParamChange(a,b,c,e),this.drawItemName(e,a,b+this.lineHeight()),this.changePaintOpacity(!0)},Window_ShopStatus.prototype.drawActorParamChange=function(a,b,c,d){var e=this.contents.width-this.textPadding()-a,f=this.paramId(),g=this._item.params[f]-(d?d.params[f]:0);this.changeTextColor(this.paramchangeTextColor(g)),this.drawText((g>0?"+":"")+g,a,b,e,"right")},Window_ShopStatus.prototype.paramId=function(){return DataManager.isWeapon(this._item)?2:3},Window_ShopStatus.prototype.currentEquippedItem=function(a,b){for(var c=[],d=a.equips(),e=a.equipSlots(),f=0;f<e.length;f++)e[f]===b&&c.push(d[f]);for(var g=this.paramId(),h=Number.MAX_VALUE,i=null,j=0;j<c.length;j++)c[j]&&c[j].params[g]<h&&(h=c[j].params[g],i=c[j]);return i},Window_ShopStatus.prototype.update=function(){Window_Base.prototype.update.call(this),this.updatePage()},Window_ShopStatus.prototype.updatePage=function(){this.isPageChangeEnabled()&&this.isPageChangeRequested()&&this.changePage()},Window_ShopStatus.prototype.isPageChangeEnabled=function(){return this.visible&&this.maxPages()>=2},Window_ShopStatus.prototype.isPageChangeRequested=function(){return Input.isTriggered("shift")?!0:TouchInput.isTriggered()&&this.isTouchedInsideFrame()?!0:!1},Window_ShopStatus.prototype.isTouchedInsideFrame=function(){var a=this.canvasToLocalX(TouchInput.x),b=this.canvasToLocalY(TouchInput.y);return a>=0&&b>=0&&a<this.width&&b<this.height},Window_ShopStatus.prototype.changePage=function(){this._pageIndex=(this._pageIndex+1)%this.maxPages(),this.refresh(),SoundManager.playCursor()},Window_NameEdit.prototype=Object.create(Window_Base.prototype),Window_NameEdit.prototype.constructor=Window_NameEdit,Window_NameEdit.prototype.initialize=function(a,b){var c=this.windowWidth(),d=this.windowHeight(),e=(Graphics.boxWidth-c)/2,f=(Graphics.boxHeight-(d+this.fittingHeight(9)+8))/2;Window_Base.prototype.initialize.call(this,e,f,c,d),this._actor=a,this._name=a.name().slice(0,this._maxLength),this._index=this._name.length,this._maxLength=b,this._defaultName=this._name,this.deactivate(),this.refresh(),ImageManager.loadFace(a.faceName())},Window_NameEdit.prototype.windowWidth=function(){return 480},Window_NameEdit.prototype.windowHeight=function(){return this.fittingHeight(4)},Window_NameEdit.prototype.name=function(){return this._name},Window_NameEdit.prototype.restoreDefault=function(){return this._name=this._defaultName,this._index=this._name.length,this.refresh(),this._name.length>0},Window_NameEdit.prototype.add=function(a){return this._index<this._maxLength?(this._name+=a,this._index++,this.refresh(),!0):!1},Window_NameEdit.prototype.back=function(){return this._index>0?(this._index--,this._name=this._name.slice(0,this._index),this.refresh(),!0):!1},Window_NameEdit.prototype.faceWidth=function(){return 144},Window_NameEdit.prototype.charWidth=function(){var a=$gameSystem.isJapanese()?"Ａ":"A";return this.textWidth(a)},Window_NameEdit.prototype.left=function(){var a=(this.contentsWidth()+this.faceWidth())/2,b=(this._maxLength+1)*this.charWidth();return Math.min(a-b/2,this.contentsWidth()-b)},Window_NameEdit.prototype.itemRect=function(a){return{x:this.left()+a*this.charWidth(),y:54,width:this.charWidth(),height:this.lineHeight()}},Window_NameEdit.prototype.underlineRect=function(a){var b=this.itemRect(a);return b.x++,b.y+=b.height-4,b.width-=2,b.height=2,b},Window_NameEdit.prototype.underlineColor=function(){return this.normalColor()},Window_NameEdit.prototype.drawUnderline=function(a){var b=this.underlineRect(a),c=this.underlineColor();this.contents.paintOpacity=48,this.contents.fillRect(b.x,b.y,b.width,b.height,c),this.contents.paintOpacity=255},Window_NameEdit.prototype.drawChar=function(a){var b=this.itemRect(a);this.resetTextColor(),this.drawText(this._name[a]||"",b.x,b.y)},Window_NameEdit.prototype.refresh=function(){this.contents.clear(),this.drawActorFace(this._actor,0,0);for(var a=0;a<this._maxLength;a++)this.drawUnderline(a);for(var b=0;b<this._name.length;b++)this.drawChar(b);var c=this.itemRect(this._index);this.setCursorRect(c.x,c.y,c.width,c.height)},Window_NameInput.prototype=Object.create(Window_Selectable.prototype),Window_NameInput.prototype.constructor=Window_NameInput,Window_NameInput.LATIN1=["A","B","C","D","E","a","b","c","d","e","F","G","H","I","J","f","g","h","i","j","K","L","M","N","O","k","l","m","n","o","P","Q","R","S","T","p","q","r","s","t","U","V","W","X","Y","u","v","w","x","y","Z","[","]","^","_","z","{","}","|","~","0","1","2","3","4","!","#","$","%","&","5","6","7","8","9","(",")","*","+","-","/","=","@","<",">",":",";"," ","Page","OK"],Window_NameInput.LATIN2=["Á","É","Í","Ó","Ú","á","é","í","ó","ú","À","È","Ì","Ò","Ù","à","è","ì","ò","ù","Â","Ê","Î","Ô","Û","â","ê","î","ô","û","Ä","Ë","Ï","Ö","Ü","ä","ë","ï","ö","ü","Ā","Ē","Ī","Ō","Ū","ā","ē","ī","ō","ū","Ã","Å","Æ","Ç","Ð","ã","å","æ","ç","ð","Ñ","Õ","Ø","Š","Ŵ","ñ","õ","ø","š","ŵ","Ý","Ŷ","Ÿ","Ž","Þ","ý","ÿ","ŷ","ž","þ","Ĳ","Œ","ĳ","œ","ß","«","»"," ","Page","OK"],Window_NameInput.RUSSIA=["А","Б","В","Г","Д","а","б","в","г","д","Е","Ё","Ж","З","И","е","ё","ж","з","и","Й","К","Л","М","Н","й","к","л","м","н","О","П","Р","С","Т","о","п","р","с","т","У","Ф","Х","Ц","Ч","у","ф","х","ц","ч","Ш","Щ","Ъ","Ы","Ь","ш","щ","ъ","ы","ь","Э","Ю","Я","^","_","э","ю","я","%","&","0","1","2","3","4","(",")","*","+","-","5","6","7","8","9",":",";"," ","","OK"],Window_NameInput.JAPAN1=["あ","い","う","え","お","が","ぎ","ぐ","げ","ご","か","き","く","け","こ","ざ","じ","ず","ぜ","ぞ","さ","し","す","せ","そ","だ","ぢ","づ","で","ど","た","ち","つ","て","と","ば","び","ぶ","べ","ぼ","な","に","ぬ","ね","の","ぱ","ぴ","ぷ","ぺ","ぽ","は","ひ","ふ","へ","ほ","ぁ","ぃ","ぅ","ぇ","ぉ","ま","み","む","め","も","っ","ゃ","ゅ","ょ","ゎ","や","ゆ","よ","わ","ん","ー","～","・","＝","☆","ら","り","る","れ","ろ","ゔ","を","　","カナ","決定"],Window_NameInput.JAPAN2=["ア","イ","ウ","エ","オ","ガ","ギ","グ","ゲ","ゴ","カ","キ","ク","ケ","コ","ザ","ジ","ズ","ゼ","ゾ","サ","シ","ス","セ","ソ","ダ","ヂ","ヅ","デ","ド","タ","チ","ツ","テ","ト","バ","ビ","ブ","ベ","ボ","ナ","ニ","ヌ","ネ","ノ","パ","ピ","プ","ペ","ポ","ハ","ヒ","フ","ヘ","ホ","ァ","ィ","ゥ","ェ","ォ","マ","ミ","ム","メ","モ","ッ","ャ","ュ","ョ","ヮ","ヤ","ユ","ヨ","ワ","ン","ー","～","・","＝","☆","ラ","リ","ル","レ","ロ","ヴ","ヲ","　","英数","決定"],Window_NameInput.JAPAN3=["Ａ","Ｂ","Ｃ","Ｄ","Ｅ","ａ","ｂ","ｃ","ｄ","ｅ","Ｆ","Ｇ","Ｈ","Ｉ","Ｊ","ｆ","ｇ","ｈ","ｉ","ｊ","Ｋ","Ｌ","Ｍ","Ｎ","Ｏ","ｋ","ｌ","ｍ","ｎ","ｏ","Ｐ","Ｑ","Ｒ","Ｓ","Ｔ","ｐ","ｑ","ｒ","ｓ","ｔ","Ｕ","Ｖ","Ｗ","Ｘ","Ｙ","ｕ","ｖ","ｗ","ｘ","ｙ","Ｚ","［","］","＾","＿","ｚ","｛","｝","｜","～","０","１","２","３","４","！","＃","＄","％","＆","５","６","７","８","９","（","）","＊","＋","－","／","＝","＠","＜","＞","：","；","　","かな","決定"],Window_NameInput.prototype.initialize=function(a){var b=a.x,c=a.y+a.height+8,d=a.width,e=this.windowHeight();Window_Selectable.prototype.initialize.call(this,b,c,d,e),this._editWindow=a,this._page=0,this._index=0,this.refresh(),this.updateCursor(),this.activate()},Window_NameInput.prototype.windowHeight=function(){return this.fittingHeight(9)},Window_NameInput.prototype.table=function(){return $gameSystem.isJapanese()?[Window_NameInput.JAPAN1,Window_NameInput.JAPAN2,Window_NameInput.JAPAN3]:$gameSystem.isRussian()?[Window_NameInput.RUSSIA]:[Window_NameInput.LATIN1,Window_NameInput.LATIN2]},Window_NameInput.prototype.maxCols=function(){return 10},Window_NameInput.prototype.maxItems=function(){return 90},Window_NameInput.prototype.character=function(){return this._index<88?this.table()[this._page][this._index]:""},Window_NameInput.prototype.isPageChange=function(){return 88===this._index},Window_NameInput.prototype.isOk=function(){return 89===this._index},Window_NameInput.prototype.itemRect=function(a){return{x:a%10*42+24*Math.floor(a%10/5),y:Math.floor(a/10)*this.lineHeight(),width:42,height:this.lineHeight()}},Window_NameInput.prototype.refresh=function(){var a=this.table();this.contents.clear(),this.resetTextColor();for(var b=0;90>b;b++){var c=this.itemRect(b);c.x+=3,c.width-=6,this.drawText(a[this._page][b],c.x,c.y,c.width,"center")}},Window_NameInput.prototype.updateCursor=function(){var a=this.itemRect(this._index);this.setCursorRect(a.x,a.y,a.width,a.height)},Window_NameInput.prototype.isCursorMovable=function(){return this.active},Window_NameInput.prototype.cursorDown=function(a){(this._index<80||a)&&(this._index=(this._index+10)%90)},Window_NameInput.prototype.cursorUp=function(a){(this._index>=10||a)&&(this._index=(this._index+80)%90)},Window_NameInput.prototype.cursorRight=function(a){this._index%10<9?this._index++:a&&(this._index-=9)},Window_NameInput.prototype.cursorLeft=function(a){this._index%10>0?this._index--:a&&(this._index+=9)},Window_NameInput.prototype.cursorPagedown=function(){this._page=(this._page+1)%this.table().length,this.refresh()},Window_NameInput.prototype.cursorPageup=function(){this._page=(this._page+this.table().length-1)%this.table().length,this.refresh()},Window_NameInput.prototype.processCursorMove=function(){var a=this._page;Window_Selectable.prototype.processCursorMove.call(this),this.updateCursor(),this._page!==a&&SoundManager.playCursor()},Window_NameInput.prototype.processHandling=function(){this.isOpen()&&this.active&&(Input.isTriggered("shift")&&this.processJump(),Input.isRepeated("cancel")&&this.processBack(),Input.isRepeated("ok")&&this.processOk())},Window_NameInput.prototype.isCancelEnabled=function(){return!0},Window_NameInput.prototype.processCancel=function(){this.processBack()},Window_NameInput.prototype.processJump=function(){89!==this._index&&(this._index=89,SoundManager.playCursor())},Window_NameInput.prototype.processBack=function(){this._editWindow.back()&&SoundManager.playCancel()},Window_NameInput.prototype.processOk=function(){this.character()?this.onNameAdd():this.isPageChange()?(SoundManager.playOk(),this.cursorPagedown()):this.isOk()&&this.onNameOk()},Window_NameInput.prototype.onNameAdd=function(){this._editWindow.add(this.character())?SoundManager.playOk():SoundManager.playBuzzer()},Window_NameInput.prototype.onNameOk=function(){""===this._editWindow.name()?this._editWindow.restoreDefault()?SoundManager.playOk():SoundManager.playBuzzer():(SoundManager.playOk(),this.callOkHandler())},Window_ChoiceList.prototype=Object.create(Window_Command.prototype),Window_ChoiceList.prototype.constructor=Window_ChoiceList,Window_ChoiceList.prototype.initialize=function(a){this._messageWindow=a,Window_Command.prototype.initialize.call(this,0,0),this.openness=0,this.deactivate(),this._background=0},Window_ChoiceList.prototype.start=function(){this.updatePlacement(),this.updateBackground(),this.refresh(),this.selectDefault(),this.open(),this.activate()},Window_ChoiceList.prototype.selectDefault=function(){this.select($gameMessage.choiceDefaultType())},Window_ChoiceList.prototype.updatePlacement=function(){var a=$gameMessage.choicePositionType(),b=this._messageWindow.y;switch(this.width=this.windowWidth(),this.height=this.windowHeight(),a){case 0:this.x=0;break;case 1:this.x=(Graphics.boxWidth-this.width)/2;break;case 2:this.x=Graphics.boxWidth-this.width}b>=Graphics.boxHeight/2?this.y=b-this.height:this.y=b+this._messageWindow.height},Window_ChoiceList.prototype.updateBackground=function(){this._background=$gameMessage.choiceBackground(),this.setBackgroundType(this._background)},Window_ChoiceList.prototype.windowWidth=function(){var a=this.maxChoiceWidth()+2*this.padding;return Math.min(a,Graphics.boxWidth)},Window_ChoiceList.prototype.numVisibleRows=function(){var a=this._messageWindow.y,b=this._messageWindow.height,c=Graphics.boxHeight/2,d=$gameMessage.choices(),e=d.length,f=8;return c>a&&a+b>c&&(f=4),e>f&&(e=f),e},Window_ChoiceList.prototype.maxChoiceWidth=function(){for(var a=96,b=$gameMessage.choices(),c=0;c<b.length;c++){var d=this.textWidthEx(b[c])+2*this.textPadding();d>a&&(a=d)}return a},Window_ChoiceList.prototype.textWidthEx=function(a){return this.drawTextEx(a,0,this.contents.height)},Window_ChoiceList.prototype.contentsHeight=function(){return this.maxItems()*this.itemHeight()},Window_ChoiceList.prototype.makeCommandList=function(){for(var a=$gameMessage.choices(),b=0;b<a.length;b++)this.addCommand(a[b],"choice")},Window_ChoiceList.prototype.drawItem=function(a){var b=this.itemRectForText(a);this.drawTextEx(this.commandName(a),b.x,b.y)},Window_ChoiceList.prototype.isCancelEnabled=function(){return-1!==$gameMessage.choiceCancelType()},Window_ChoiceList.prototype.isOkTriggered=function(){return Input.isTriggered("ok")},Window_ChoiceList.prototype.callOkHandler=function(){$gameMessage.onChoice(this.index()),this._messageWindow.terminateMessage(),this.close()},Window_ChoiceList.prototype.callCancelHandler=function(){$gameMessage.onChoice($gameMessage.choiceCancelType()),this._messageWindow.terminateMessage(),this.close()},Window_NumberInput.prototype=Object.create(Window_Selectable.prototype),Window_NumberInput.prototype.constructor=Window_NumberInput,Window_NumberInput.prototype.initialize=function(a){this._messageWindow=a,Window_Selectable.prototype.initialize.call(this,0,0,0,0),this._number=0,this._maxDigits=1,this.openness=0,this.createButtons(),this.deactivate()},Window_NumberInput.prototype.start=function(){this._maxDigits=$gameMessage.numInputMaxDigits(),this._number=$gameVariables.value($gameMessage.numInputVariableId()),this._number=this._number.clamp(0,Math.pow(10,this._maxDigits)-1),this.updatePlacement(),this.placeButtons(),this.updateButtonsVisiblity(),this.createContents(),this.refresh(),this.open(),this.activate(),this.select(0)},Window_NumberInput.prototype.updatePlacement=function(){var a=this._messageWindow.y,b=8;this.width=this.windowWidth(),this.height=this.windowHeight(),this.x=(Graphics.boxWidth-this.width)/2,a>=Graphics.boxHeight/2?this.y=a-this.height-b:this.y=a+this._messageWindow.height+b},Window_NumberInput.prototype.windowWidth=function(){return this.maxCols()*this.itemWidth()+2*this.padding},Window_NumberInput.prototype.windowHeight=function(){return this.fittingHeight(1)},Window_NumberInput.prototype.maxCols=function(){return this._maxDigits},Window_NumberInput.prototype.maxItems=function(){return this._maxDigits},Window_NumberInput.prototype.spacing=function(){return 0},Window_NumberInput.prototype.itemWidth=function(){return 32},Window_NumberInput.prototype.createButtons=function(){var a=ImageManager.loadSystem("ButtonSet"),b=48,c=48;this._buttons=[];for(var d=0;3>d;d++){var e=new Sprite_Button,f=b*[1,2,4][d],g=b*(2===d?2:1);e.bitmap=a,e.setColdFrame(f,0,g,c),e.setHotFrame(f,c,g,c),e.visible=!1,this._buttons.push(e),this.addChild(e)}this._buttons[0].setClickHandler(this.onButtonDown.bind(this)),this._buttons[1].setClickHandler(this.onButtonUp.bind(this)),this._buttons[2].setClickHandler(this.onButtonOk.bind(this))},Window_NumberInput.prototype.placeButtons=function(){for(var a=this._buttons.length,b=16,c=-b,d=0;a>d;d++)c+=this._buttons[d].width+b;for(var e=(this.width-c)/2,f=0;a>f;f++){var g=this._buttons[f];g.x=e,g.y=this.buttonY(),e+=g.width+b}},Window_NumberInput.prototype.updateButtonsVisiblity=function(){TouchInput.date>Input.date?this.showButtons():this.hideButtons()},Window_NumberInput.prototype.showButtons=function(){for(var a=0;a<this._buttons.length;a++)this._buttons[a].visible=!0},Window_NumberInput.prototype.hideButtons=function(){for(var a=0;a<this._buttons.length;a++)this._buttons[a].visible=!1},Window_NumberInput.prototype.buttonY=function(){var a=8;return this._messageWindow.y>=Graphics.boxHeight/2?0-this._buttons[0].height-a:this.height+a},Window_NumberInput.prototype.update=function(){Window_Selectable.prototype.update.call(this),this.processDigitChange()},Window_NumberInput.prototype.processDigitChange=function(){this.isOpenAndActive()&&(Input.isRepeated("up")?this.changeDigit(!0):Input.isRepeated("down")&&this.changeDigit(!1))},Window_NumberInput.prototype.changeDigit=function(a){var b=this.index(),c=Math.pow(10,this._maxDigits-1-b),d=Math.floor(this._number/c)%10;this._number-=d*c,d=a?(d+1)%10:(d+9)%10,this._number+=d*c,this.refresh(),SoundManager.playCursor()},Window_NumberInput.prototype.isTouchOkEnabled=function(){return!1},Window_NumberInput.prototype.isOkEnabled=function(){return!0},Window_NumberInput.prototype.isCancelEnabled=function(){return!1},Window_NumberInput.prototype.isOkTriggered=function(){return Input.isTriggered("ok")},Window_NumberInput.prototype.processOk=function(){SoundManager.playOk(),$gameVariables.setValue($gameMessage.numInputVariableId(),this._number),this._messageWindow.terminateMessage(),this.updateInputData(),this.deactivate(),this.close()},Window_NumberInput.prototype.drawItem=function(a){var b=this.itemRect(a),c="center",d=this._number.padZero(this._maxDigits),e=d.slice(a,a+1);this.resetTextColor(),this.drawText(e,b.x,b.y,b.width,c)},Window_NumberInput.prototype.onButtonUp=function(){this.changeDigit(!0)},Window_NumberInput.prototype.onButtonDown=function(){this.changeDigit(!1)},Window_NumberInput.prototype.onButtonOk=function(){this.processOk(),this.hideButtons()},Window_EventItem.prototype=Object.create(Window_ItemList.prototype),Window_EventItem.prototype.constructor=Window_EventItem,Window_EventItem.prototype.initialize=function(a){this._messageWindow=a;var b=Graphics.boxWidth,c=this.windowHeight();Window_ItemList.prototype.initialize.call(this,0,0,b,c),this.openness=0,this.deactivate(),this.setHandler("ok",this.onOk.bind(this)),this.setHandler("cancel",this.onCancel.bind(this))},Window_EventItem.prototype.windowHeight=function(){return this.fittingHeight(this.numVisibleRows())},Window_EventItem.prototype.numVisibleRows=function(){return 4},Window_EventItem.prototype.start=function(){this.refresh(),this.updatePlacement(),this.select(0),this.open(),this.activate()},Window_EventItem.prototype.updatePlacement=function(){this._messageWindow.y>=Graphics.boxHeight/2?this.y=0:this.y=Graphics.boxHeight-this.height},Window_EventItem.prototype.includes=function(a){var b=$gameMessage.itemChoiceItypeId();return DataManager.isItem(a)&&a.itypeId===b},Window_EventItem.prototype.isEnabled=function(a){return!0},Window_EventItem.prototype.onOk=function(){var a=this.item(),b=a?a.id:0;$gameVariables.setValue($gameMessage.itemChoiceVariableId(),b),this._messageWindow.terminateMessage(),this.close()},Window_EventItem.prototype.onCancel=function(){$gameVariables.setValue($gameMessage.itemChoiceVariableId(),0),this._messageWindow.terminateMessage(),this.close()},Window_Message.prototype=Object.create(Window_Base.prototype),Window_Message.prototype.constructor=Window_Message,Window_Message.prototype.initialize=function(){var a=this.windowWidth(),b=this.windowHeight(),c=(Graphics.boxWidth-a)/2;Window_Base.prototype.initialize.call(this,c,0,a,b),this.openness=0,this.initMembers(),this.createSubWindows(),this.updatePlacement()},Window_Message.prototype.initMembers=function(){this._background=0,this._positionType=2,this._waitCount=0,this._faceBitmap=null,this._textState=null,this.clearFlags()},Window_Message.prototype.subWindows=function(){return[this._goldWindow,this._choiceWindow,this._numberWindow,this._itemWindow]},Window_Message.prototype.createSubWindows=function(){this._goldWindow=new Window_Gold(0,0),this._goldWindow.x=Graphics.boxWidth-this._goldWindow.width,this._goldWindow.openness=0,this._choiceWindow=new Window_ChoiceList(this),this._numberWindow=new Window_NumberInput(this),this._itemWindow=new Window_EventItem(this)},Window_Message.prototype.windowWidth=function(){return Graphics.boxWidth},Window_Message.prototype.windowHeight=function(){return this.fittingHeight(this.numVisibleRows())},Window_Message.prototype.clearFlags=function(){this._showFast=!1,this._lineShowFast=!1,this._pauseSkip=!1},Window_Message.prototype.numVisibleRows=function(){return 4},Window_Message.prototype.update=function(){for(this.checkToNotClose(),Window_Base.prototype.update.call(this);!this.isOpening()&&!this.isClosing();){if(this.updateWait())return;if(this.updateLoading())return;if(this.updateInput())return;if(this.updateMessage())return;if(!this.canStart())return void this.startInput();this.startMessage()}},Window_Message.prototype.checkToNotClose=function(){this.isClosing()&&this.isOpen()&&this.doesContinue()&&this.open()},Window_Message.prototype.canStart=function(){return $gameMessage.hasText()&&!$gameMessage.scrollMode()},Window_Message.prototype.startMessage=function(){this._textState={},this._textState.index=0,this._textState.text=this.convertEscapeCharacters($gameMessage.allText()),this.newPage(this._textState),this.updatePlacement(),this.updateBackground(),this.open()},Window_Message.prototype.updatePlacement=function(){this._positionType=$gameMessage.positionType(),this.y=this._positionType*(Graphics.boxHeight-this.height)/2,this._goldWindow.y=this.y>0?0:Graphics.boxHeight-this._goldWindow.height},Window_Message.prototype.updateBackground=function(){this._background=$gameMessage.background(),this.setBackgroundType(this._background)},Window_Message.prototype.terminateMessage=function(){this.close(),this._goldWindow.close(),$gameMessage.clear()},Window_Message.prototype.updateWait=function(){return this._waitCount>0?(this._waitCount--,!0):!1},Window_Message.prototype.updateLoading=function(){return this._faceBitmap?ImageManager.isReady()?(this.drawMessageFace(),this._faceBitmap=null,!1):!0:!1},Window_Message.prototype.updateInput=function(){return this.isAnySubWindowActive()?!0:this.pause?(this.isTriggered()&&(Input.update(),this.pause=!1,this._textState||this.terminateMessage()),!0):!1},Window_Message.prototype.isAnySubWindowActive=function(){return this._choiceWindow.active||this._numberWindow.active||this._itemWindow.active},Window_Message.prototype.updateMessage=function(){if(this._textState){for(;!this.isEndOfText(this._textState)&&(this.needsNewPage(this._textState)&&this.newPage(this._textState),this.updateShowFast(),this.processCharacter(this._textState),this._showFast||this._lineShowFast)&&!(this.pause||this._waitCount>0););return this.isEndOfText(this._textState)&&this.onEndOfText(),!0}return!1},Window_Message.prototype.onEndOfText=function(){this.startInput()||(this._pauseSkip?this.terminateMessage():this.startPause()),this._textState=null},Window_Message.prototype.startInput=function(){return $gameMessage.isChoice()?(this._choiceWindow.start(),!0):$gameMessage.isNumberInput()?(this._numberWindow.start(),!0):$gameMessage.isItemChoice()?(this._itemWindow.start(),!0):!1},Window_Message.prototype.isTriggered=function(){return Input.isRepeated("ok")||Input.isRepeated("cancel")||TouchInput.isRepeated()},Window_Message.prototype.doesContinue=function(){return $gameMessage.hasText()&&!$gameMessage.scrollMode()&&!this.areSettingsChanged()},Window_Message.prototype.areSettingsChanged=function(){return this._background!==$gameMessage.background()||this._positionType!==$gameMessage.positionType()},Window_Message.prototype.updateShowFast=function(){this.isTriggered()&&(this._showFast=!0)},Window_Message.prototype.newPage=function(a){this.contents.clear(),this.resetFontSettings(),this.clearFlags(),this.loadMessageFace(),a.x=this.newLineX(),a.y=0,a.left=this.newLineX(),a.height=this.calcTextHeight(a,!1)},Window_Message.prototype.loadMessageFace=function(){this._faceBitmap=ImageManager.loadFace($gameMessage.faceName())},Window_Message.prototype.drawMessageFace=function(){this.drawFace($gameMessage.faceName(),$gameMessage.faceIndex(),0,0)},Window_Message.prototype.newLineX=function(){return""===$gameMessage.faceName()?0:168},Window_Message.prototype.processNewLine=function(a){this._lineShowFast=!1,Window_Base.prototype.processNewLine.call(this,a),this.needsNewPage(a)&&this.startPause()},Window_Message.prototype.processNewPage=function(a){Window_Base.prototype.processNewPage.call(this,a),"\n"===a.text[a.index]&&a.index++,a.y=this.contents.height,this.startPause()},Window_Message.prototype.isEndOfText=function(a){return a.index>=a.text.length},Window_Message.prototype.needsNewPage=function(a){return!this.isEndOfText(a)&&a.y+a.height>this.contents.height},Window_Message.prototype.processEscapeCharacter=function(a,b){switch(a){case"$":this._goldWindow.open();break;case".":this.startWait(15);break;case"|":this.startWait(60);break;case"!":this.startPause();break;case">":this._lineShowFast=!0;break;case"<":this._lineShowFast=!1;break;case"^":this._pauseSkip=!0;break;default:Window_Base.prototype.processEscapeCharacter.call(this,a,b)}},Window_Message.prototype.startWait=function(a){this._waitCount=a},Window_Message.prototype.startPause=function(){this.startWait(10),this.pause=!0},Window_ScrollText.prototype=Object.create(Window_Base.prototype),Window_ScrollText.prototype.constructor=Window_ScrollText,Window_ScrollText.prototype.initialize=function(){var a=Graphics.boxWidth,b=Graphics.boxHeight;Window_Base.prototype.initialize.call(this,0,0,a,b),this.opacity=0,this.hide(),this._text="",this._allTextHeight=0},Window_ScrollText.prototype.update=function(){Window_Base.prototype.update.call(this),$gameMessage.scrollMode()&&(this._text&&this.updateMessage(),!this._text&&$gameMessage.hasText()&&this.startMessage())},Window_ScrollText.prototype.startMessage=function(){this._text=$gameMessage.allText(),this.refresh(),this.show()},Window_ScrollText.prototype.refresh=function(){var a={index:0};a.text=this.convertEscapeCharacters(this._text),this.resetFontSettings(),this._allTextHeight=this.calcTextHeight(a,!0),this.createContents(),this.origin.y=-this.height,this.drawTextEx(this._text,this.textPadding(),1)},Window_ScrollText.prototype.contentsHeight=function(){return Math.max(this._allTextHeight,1)},Window_ScrollText.prototype.updateMessage=function(){this.origin.y+=this.scrollSpeed(),this.origin.y>=this.contents.height&&this.terminateMessage()},Window_ScrollText.prototype.scrollSpeed=function(){var a=$gameMessage.scrollSpeed()/2;return this.isFastForward()&&(a*=this.fastForwardRate()),a},Window_ScrollText.prototype.isFastForward=function(){return $gameMessage.scrollNoFast()?!1:Input.isPressed("ok")||Input.isPressed("shift")||TouchInput.isPressed()},Window_ScrollText.prototype.fastForwardRate=function(){return 3},Window_ScrollText.prototype.terminateMessage=function(){this._text=null,$gameMessage.clear(),this.hide()},Window_MapName.prototype=Object.create(Window_Base.prototype),Window_MapName.prototype.constructor=Window_MapName,Window_MapName.prototype.initialize=function(){var a=this.windowWidth(),b=this.windowHeight();Window_Base.prototype.initialize.call(this,0,0,a,b),this.opacity=0,this.contentsOpacity=0,this._showCount=0,this.refresh()},Window_MapName.prototype.windowWidth=function(){return 360},Window_MapName.prototype.windowHeight=function(){return this.fittingHeight(1)},Window_MapName.prototype.update=function(){Window_Base.prototype.update.call(this),this._showCount>0&&$gameMap.isNameDisplayEnabled()?(this.updateFadeIn(),this._showCount--):this.updateFadeOut()},Window_MapName.prototype.updateFadeIn=function(){this.contentsOpacity+=16},Window_MapName.prototype.updateFadeOut=function(){this.contentsOpacity-=16},Window_MapName.prototype.open=function(){this.refresh(),this._showCount=150},Window_MapName.prototype.close=function(){this._showCount=0},Window_MapName.prototype.refresh=function(){if(this.contents.clear(),$gameMap.displayName()){var a=this.contentsWidth();this.drawBackground(0,0,a,this.lineHeight()),this.drawText($gameMap.displayName(),0,0,a,"center")}},Window_MapName.prototype.drawBackground=function(a,b,c,d){var e=this.dimColor1(),f=this.dimColor2();this.contents.gradientFillRect(a,b,c/2,d,f,e),this.contents.gradientFillRect(a+c/2,b,c/2,d,e,f)},Window_BattleLog.prototype=Object.create(Window_Selectable.prototype),Window_BattleLog.prototype.constructor=Window_BattleLog,Window_BattleLog.prototype.initialize=function(){var a=this.windowWidth(),b=this.windowHeight();Window_Selectable.prototype.initialize.call(this,0,0,a,b),this.opacity=0,this._lines=[],this._methods=[],this._waitCount=0,this._waitMode="",this._baseLineStack=[],this._spriteset=null,this.createBackBitmap(),this.createBackSprite(),this.refresh()},Window_BattleLog.prototype.setSpriteset=function(a){this._spriteset=a},Window_BattleLog.prototype.windowWidth=function(){return Graphics.boxWidth},Window_BattleLog.prototype.windowHeight=function(){return this.fittingHeight(this.maxLines())},Window_BattleLog.prototype.maxLines=function(){return 10},Window_BattleLog.prototype.createBackBitmap=function(){
this._backBitmap=new Bitmap(this.width,this.height)},Window_BattleLog.prototype.createBackSprite=function(){this._backSprite=new Sprite,this._backSprite.bitmap=this._backBitmap,this._backSprite.y=this.y,this.addChildToBack(this._backSprite)},Window_BattleLog.prototype.numLines=function(){return this._lines.length},Window_BattleLog.prototype.messageSpeed=function(){return 16},Window_BattleLog.prototype.isBusy=function(){return this._waitCount>0||this._waitMode||this._methods.length>0},Window_BattleLog.prototype.update=function(){this.updateWait()||this.callNextMethod()},Window_BattleLog.prototype.updateWait=function(){return this.updateWaitCount()||this.updateWaitMode()},Window_BattleLog.prototype.updateWaitCount=function(){return this._waitCount>0?(this._waitCount-=this.isFastForward()?3:1,this._waitCount<0&&(this._waitCount=0),!0):!1},Window_BattleLog.prototype.updateWaitMode=function(){var a=!1;switch(this._waitMode){case"effect":a=this._spriteset.isEffecting();break;case"movement":a=this._spriteset.isAnyoneMoving()}return a||(this._waitMode=""),a},Window_BattleLog.prototype.setWaitMode=function(a){this._waitMode=a},Window_BattleLog.prototype.callNextMethod=function(){if(this._methods.length>0){var a=this._methods.shift();if(!a.name||!this[a.name])throw new Error("Method not found: "+a.name);this[a.name].apply(this,a.params)}},Window_BattleLog.prototype.isFastForward=function(){return Input.isLongPressed("ok")||Input.isPressed("shift")||TouchInput.isLongPressed()},Window_BattleLog.prototype.push=function(a){var b=Array.prototype.slice.call(arguments,1);this._methods.push({name:a,params:b})},Window_BattleLog.prototype.clear=function(){this._lines=[],this._baseLineStack=[],this.refresh()},Window_BattleLog.prototype.wait=function(){this._waitCount=this.messageSpeed()},Window_BattleLog.prototype.waitForEffect=function(){this.setWaitMode("effect")},Window_BattleLog.prototype.waitForMovement=function(){this.setWaitMode("movement")},Window_BattleLog.prototype.addText=function(a){this._lines.push(a),this.refresh(),this.wait()},Window_BattleLog.prototype.pushBaseLine=function(){this._baseLineStack.push(this._lines.length)},Window_BattleLog.prototype.popBaseLine=function(){for(var a=this._baseLineStack.pop();this._lines.length>a;)this._lines.pop()},Window_BattleLog.prototype.waitForNewLine=function(){var a=0;this._baseLineStack.length>0&&(a=this._baseLineStack[this._baseLineStack.length-1]),this._lines.length>a&&this.wait()},Window_BattleLog.prototype.popupDamage=function(a){a.startDamagePopup()},Window_BattleLog.prototype.performActionStart=function(a,b){a.performActionStart(b)},Window_BattleLog.prototype.performAction=function(a,b){a.performAction(b)},Window_BattleLog.prototype.performActionEnd=function(a){a.performActionEnd()},Window_BattleLog.prototype.performDamage=function(a){a.performDamage()},Window_BattleLog.prototype.performMiss=function(a){a.performMiss()},Window_BattleLog.prototype.performRecovery=function(a){a.performRecovery()},Window_BattleLog.prototype.performEvasion=function(a){a.performEvasion()},Window_BattleLog.prototype.performMagicEvasion=function(a){a.performMagicEvasion()},Window_BattleLog.prototype.performCounter=function(a){a.performCounter()},Window_BattleLog.prototype.performReflection=function(a){a.performReflection()},Window_BattleLog.prototype.performSubstitute=function(a,b){a.performSubstitute(b)},Window_BattleLog.prototype.performCollapse=function(a){a.performCollapse()},Window_BattleLog.prototype.showAnimation=function(a,b,c){0>c?this.showAttackAnimation(a,b):this.showNormalAnimation(b,c)},Window_BattleLog.prototype.showAttackAnimation=function(a,b){a.isActor()?this.showActorAttackAnimation(a,b):this.showEnemyAttackAnimation(a,b)},Window_BattleLog.prototype.showActorAttackAnimation=function(a,b){this.showNormalAnimation(b,a.attackAnimationId1(),!1),this.showNormalAnimation(b,a.attackAnimationId2(),!0)},Window_BattleLog.prototype.showEnemyAttackAnimation=function(a,b){SoundManager.playEnemyAttack()},Window_BattleLog.prototype.showNormalAnimation=function(a,b,c){var d=$dataAnimations[b];if(d){var e=this.animationBaseDelay(),f=this.animationNextDelay();a.forEach(function(a){a.startAnimation(b,c,e),e+=f})}},Window_BattleLog.prototype.animationBaseDelay=function(){return 8},Window_BattleLog.prototype.animationNextDelay=function(){return 12},Window_BattleLog.prototype.refresh=function(){this.drawBackground(),this.contents.clear();for(var a=0;a<this._lines.length;a++)this.drawLineText(a)},Window_BattleLog.prototype.drawBackground=function(){var a=this.backRect(),b=this.backColor();this._backBitmap.clear(),this._backBitmap.paintOpacity=this.backPaintOpacity(),this._backBitmap.fillRect(a.x,a.y,a.width,a.height,b),this._backBitmap.paintOpacity=255},Window_BattleLog.prototype.backRect=function(){return{x:0,y:this.padding,width:this.width,height:this.numLines()*this.lineHeight()}},Window_BattleLog.prototype.backColor=function(){return"#000000"},Window_BattleLog.prototype.backPaintOpacity=function(){return 64},Window_BattleLog.prototype.drawLineText=function(a){var b=this.itemRectForText(a);this.contents.clearRect(b.x,b.y,b.width,b.height),this.drawTextEx(this._lines[a],b.x,b.y,b.width)},Window_BattleLog.prototype.startTurn=function(){this.push("wait")},Window_BattleLog.prototype.startAction=function(a,b,c){var d=b.item();this.push("performActionStart",a,b),this.push("waitForMovement"),this.push("performAction",a,b),this.push("showAnimation",a,c.clone(),d.animationId),this.displayAction(a,d)},Window_BattleLog.prototype.endAction=function(a){this.push("waitForNewLine"),this.push("clear"),this.push("performActionEnd",a)},Window_BattleLog.prototype.displayCurrentState=function(a){var b=a.mostImportantStateText();b&&(this.push("addText",a.name()+b),this.push("wait"),this.push("clear"))},Window_BattleLog.prototype.displayRegeneration=function(a){this.push("popupDamage",a)},Window_BattleLog.prototype.displayAction=function(a,b){var c=this._methods.length;DataManager.isSkill(b)?(b.message1&&this.push("addText",a.name()+b.message1.format(b.name)),b.message2&&this.push("addText",b.message2.format(b.name))):this.push("addText",TextManager.useItem.format(a.name(),b.name)),this._methods.length===c&&this.push("wait")},Window_BattleLog.prototype.displayCounter=function(a){this.push("performCounter",a),this.push("addText",TextManager.counterAttack.format(a.name()))},Window_BattleLog.prototype.displayReflection=function(a){this.push("performReflection",a),this.push("addText",TextManager.magicReflection.format(a.name()))},Window_BattleLog.prototype.displaySubstitute=function(a,b){var c=a.name();this.push("performSubstitute",a,b),this.push("addText",TextManager.substitute.format(c,b.name()))},Window_BattleLog.prototype.displayActionResults=function(a,b){b.result().used&&(this.push("pushBaseLine"),this.displayCritical(b),this.push("popupDamage",b),this.push("popupDamage",a),this.displayDamage(b),this.displayAffectedStatus(b),this.displayFailure(b),this.push("waitForNewLine"),this.push("popBaseLine"))},Window_BattleLog.prototype.displayFailure=function(a){a.result().isHit()&&!a.result().success&&this.push("addText",TextManager.actionFailure.format(a.name()))},Window_BattleLog.prototype.displayCritical=function(a){a.result().critical&&(a.isActor()?this.push("addText",TextManager.criticalToActor):this.push("addText",TextManager.criticalToEnemy))},Window_BattleLog.prototype.displayDamage=function(a){a.result().missed?this.displayMiss(a):a.result().evaded?this.displayEvasion(a):(this.displayHpDamage(a),this.displayMpDamage(a),this.displayTpDamage(a))},Window_BattleLog.prototype.displayMiss=function(a){var b;a.result().physical?(b=a.isActor()?TextManager.actorNoHit:TextManager.enemyNoHit,this.push("performMiss",a)):b=TextManager.actionFailure,this.push("addText",b.format(a.name()))},Window_BattleLog.prototype.displayEvasion=function(a){var b;a.result().physical?(b=TextManager.evasion,this.push("performEvasion",a)):(b=TextManager.magicEvasion,this.push("performMagicEvasion",a)),this.push("addText",b.format(a.name()))},Window_BattleLog.prototype.displayHpDamage=function(a){a.result().hpAffected&&(a.result().hpDamage>0&&!a.result().drain&&this.push("performDamage",a),a.result().hpDamage<0&&this.push("performRecovery",a),this.push("addText",this.makeHpDamageText(a)))},Window_BattleLog.prototype.displayMpDamage=function(a){a.isAlive()&&0!==a.result().mpDamage&&(a.result().mpDamage<0&&this.push("performRecovery",a),this.push("addText",this.makeMpDamageText(a)))},Window_BattleLog.prototype.displayTpDamage=function(a){a.isAlive()&&0!==a.result().tpDamage&&(a.result().tpDamage<0&&this.push("performRecovery",a),this.push("addText",this.makeTpDamageText(a)))},Window_BattleLog.prototype.displayAffectedStatus=function(a){a.result().isStatusAffected()&&(this.push("pushBaseLine"),this.displayChangedStates(a),this.displayChangedBuffs(a),this.push("waitForNewLine"),this.push("popBaseLine"))},Window_BattleLog.prototype.displayAutoAffectedStatus=function(a){a.result().isStatusAffected()&&(this.displayAffectedStatus(a,null),this.push("clear"))},Window_BattleLog.prototype.displayChangedStates=function(a){this.displayAddedStates(a),this.displayRemovedStates(a)},Window_BattleLog.prototype.displayAddedStates=function(a){a.result().addedStateObjects().forEach(function(b){var c=a.isActor()?b.message1:b.message2;b.id===a.deathStateId()&&this.push("performCollapse",a),c&&(this.push("popBaseLine"),this.push("pushBaseLine"),this.push("addText",a.name()+c),this.push("waitForEffect"))},this)},Window_BattleLog.prototype.displayRemovedStates=function(a){a.result().removedStateObjects().forEach(function(b){b.message4&&(this.push("popBaseLine"),this.push("pushBaseLine"),this.push("addText",a.name()+b.message4))},this)},Window_BattleLog.prototype.displayChangedBuffs=function(a){var b=a.result();this.displayBuffs(a,b.addedBuffs,TextManager.buffAdd),this.displayBuffs(a,b.addedDebuffs,TextManager.debuffAdd),this.displayBuffs(a,b.removedBuffs,TextManager.buffRemove)},Window_BattleLog.prototype.displayBuffs=function(a,b,c){b.forEach(function(b){this.push("popBaseLine"),this.push("pushBaseLine"),this.push("addText",c.format(a.name(),TextManager.param(b)))},this)},Window_BattleLog.prototype.makeHpDamageText=function(a){var b,c=a.result(),d=c.hpDamage,e=a.isActor();return d>0&&c.drain?(b=e?TextManager.actorDrain:TextManager.enemyDrain,b.format(a.name(),TextManager.hp,d)):d>0?(b=e?TextManager.actorDamage:TextManager.enemyDamage,b.format(a.name(),d)):0>d?(b=e?TextManager.actorRecovery:TextManager.enemyRecovery,b.format(a.name(),TextManager.hp,-d)):(b=e?TextManager.actorNoDamage:TextManager.enemyNoDamage,b.format(a.name()))},Window_BattleLog.prototype.makeMpDamageText=function(a){var b,c=a.result(),d=c.mpDamage,e=a.isActor();return d>0&&c.drain?(b=e?TextManager.actorDrain:TextManager.enemyDrain,b.format(a.name(),TextManager.mp,d)):d>0?(b=e?TextManager.actorLoss:TextManager.enemyLoss,b.format(a.name(),TextManager.mp,d)):0>d?(b=e?TextManager.actorRecovery:TextManager.enemyRecovery,b.format(a.name(),TextManager.mp,-d)):""},Window_BattleLog.prototype.makeTpDamageText=function(a){var b,c=a.result(),d=c.tpDamage,e=a.isActor();return d>0?(b=e?TextManager.actorLoss:TextManager.enemyLoss,b.format(a.name(),TextManager.tp,d)):0>d?(b=e?TextManager.actorGain:TextManager.enemyGain,b.format(a.name(),TextManager.tp,-d)):""},Window_PartyCommand.prototype=Object.create(Window_Command.prototype),Window_PartyCommand.prototype.constructor=Window_PartyCommand,Window_PartyCommand.prototype.initialize=function(){var a=Graphics.boxHeight-this.windowHeight();Window_Command.prototype.initialize.call(this,0,a),this.openness=0,this.deactivate()},Window_PartyCommand.prototype.windowWidth=function(){return 192},Window_PartyCommand.prototype.numVisibleRows=function(){return 4},Window_PartyCommand.prototype.makeCommandList=function(){this.addCommand(TextManager.fight,"fight"),this.addCommand(TextManager.escape,"escape",BattleManager.canEscape())},Window_PartyCommand.prototype.setup=function(){this.clearCommandList(),this.makeCommandList(),this.refresh(),this.select(0),this.activate(),this.open()},Window_ActorCommand.prototype=Object.create(Window_Command.prototype),Window_ActorCommand.prototype.constructor=Window_ActorCommand,Window_ActorCommand.prototype.initialize=function(){var a=Graphics.boxHeight-this.windowHeight();Window_Command.prototype.initialize.call(this,0,a),this.openness=0,this.deactivate(),this._actor=null},Window_ActorCommand.prototype.windowWidth=function(){return 192},Window_ActorCommand.prototype.numVisibleRows=function(){return 4},Window_ActorCommand.prototype.makeCommandList=function(){this._actor&&(this.addAttackCommand(),this.addSkillCommands(),this.addGuardCommand(),this.addItemCommand())},Window_ActorCommand.prototype.addAttackCommand=function(){this.addCommand(TextManager.attack,"attack",this._actor.canAttack())},Window_ActorCommand.prototype.addSkillCommands=function(){var a=this._actor.addedSkillTypes();a.sort(function(a,b){return a-b}),a.forEach(function(a){var b=$dataSystem.skillTypes[a];this.addCommand(b,"skill",!0,a)},this)},Window_ActorCommand.prototype.addGuardCommand=function(){this.addCommand(TextManager.guard,"guard",this._actor.canGuard())},Window_ActorCommand.prototype.addItemCommand=function(){this.addCommand(TextManager.item,"item")},Window_ActorCommand.prototype.setup=function(a){this._actor=a,this.clearCommandList(),this.makeCommandList(),this.refresh(),this.selectLast(),this.activate(),this.open()},Window_ActorCommand.prototype.processOk=function(){this._actor&&(ConfigManager.commandRemember?this._actor.setLastCommandSymbol(this.currentSymbol()):this._actor.setLastCommandSymbol("")),Window_Command.prototype.processOk.call(this)},Window_ActorCommand.prototype.selectLast=function(){this.select(0),this._actor&&ConfigManager.commandRemember&&this.selectSymbol(this._actor.lastCommandSymbol())},Window_BattleStatus.prototype=Object.create(Window_Selectable.prototype),Window_BattleStatus.prototype.constructor=Window_BattleStatus,Window_BattleStatus.prototype.initialize=function(){var a=this.windowWidth(),b=this.windowHeight(),c=Graphics.boxWidth-a,d=Graphics.boxHeight-b;Window_Selectable.prototype.initialize.call(this,c,d,a,b),this.refresh(),this.openness=0},Window_BattleStatus.prototype.windowWidth=function(){return Graphics.boxWidth-192},Window_BattleStatus.prototype.windowHeight=function(){return this.fittingHeight(this.numVisibleRows())},Window_BattleStatus.prototype.numVisibleRows=function(){return 4},Window_BattleStatus.prototype.maxItems=function(){return $gameParty.battleMembers().length},Window_BattleStatus.prototype.refresh=function(){this.contents.clear(),this.drawAllItems()},Window_BattleStatus.prototype.drawItem=function(a){var b=$gameParty.battleMembers()[a];this.drawBasicArea(this.basicAreaRect(a),b),this.drawGaugeArea(this.gaugeAreaRect(a),b)},Window_BattleStatus.prototype.basicAreaRect=function(a){var b=this.itemRectForText(a);return b.width-=this.gaugeAreaWidth()+15,b},Window_BattleStatus.prototype.gaugeAreaRect=function(a){var b=this.itemRectForText(a);return b.x+=b.width-this.gaugeAreaWidth(),b.width=this.gaugeAreaWidth(),b},Window_BattleStatus.prototype.gaugeAreaWidth=function(){return 330},Window_BattleStatus.prototype.drawBasicArea=function(a,b){this.drawActorName(b,a.x+0,a.y,150),this.drawActorIcons(b,a.x+156,a.y,a.width-156)},Window_BattleStatus.prototype.drawGaugeArea=function(a,b){$dataSystem.optDisplayTp?this.drawGaugeAreaWithTp(a,b):this.drawGaugeAreaWithoutTp(a,b)},Window_BattleStatus.prototype.drawGaugeAreaWithTp=function(a,b){this.drawActorHp(b,a.x+0,a.y,108),this.drawActorMp(b,a.x+123,a.y,96),this.drawActorTp(b,a.x+234,a.y,96)},Window_BattleStatus.prototype.drawGaugeAreaWithoutTp=function(a,b){this.drawActorHp(b,a.x+0,a.y,201),this.drawActorMp(b,a.x+216,a.y,114)},Window_BattleActor.prototype=Object.create(Window_BattleStatus.prototype),Window_BattleActor.prototype.constructor=Window_BattleActor,Window_BattleActor.prototype.initialize=function(a,b){Window_BattleStatus.prototype.initialize.call(this),this.x=a,this.y=b,this.openness=255,this.hide()},Window_BattleActor.prototype.show=function(){this.select(0),Window_BattleStatus.prototype.show.call(this)},Window_BattleActor.prototype.hide=function(){Window_BattleStatus.prototype.hide.call(this),$gameParty.select(null)},Window_BattleActor.prototype.select=function(a){Window_BattleStatus.prototype.select.call(this,a),$gameParty.select(this.actor())},Window_BattleActor.prototype.actor=function(){return $gameParty.members()[this.index()]},Window_BattleEnemy.prototype=Object.create(Window_Selectable.prototype),Window_BattleEnemy.prototype.constructor=Window_BattleEnemy,Window_BattleEnemy.prototype.initialize=function(a,b){this._enemies=[];var c=this.windowWidth(),d=this.windowHeight();Window_Selectable.prototype.initialize.call(this,a,b,c,d),this.refresh(),this.hide()},Window_BattleEnemy.prototype.windowWidth=function(){return Graphics.boxWidth-192},Window_BattleEnemy.prototype.windowHeight=function(){return this.fittingHeight(this.numVisibleRows())},Window_BattleEnemy.prototype.numVisibleRows=function(){return 4},Window_BattleEnemy.prototype.maxCols=function(){return 2},Window_BattleEnemy.prototype.maxItems=function(){return this._enemies.length},Window_BattleEnemy.prototype.enemy=function(){return this._enemies[this.index()]},Window_BattleEnemy.prototype.enemyIndex=function(){var a=this.enemy();return a?a.index():-1},Window_BattleEnemy.prototype.drawItem=function(a){this.resetTextColor();var b=this._enemies[a].name(),c=this.itemRectForText(a);this.drawText(b,c.x,c.y,c.width)},Window_BattleEnemy.prototype.show=function(){this.refresh(),this.select(0),Window_Selectable.prototype.show.call(this)},Window_BattleEnemy.prototype.hide=function(){Window_Selectable.prototype.hide.call(this),$gameTroop.select(null)},Window_BattleEnemy.prototype.refresh=function(){this._enemies=$gameTroop.aliveMembers(),Window_Selectable.prototype.refresh.call(this)},Window_BattleEnemy.prototype.select=function(a){Window_Selectable.prototype.select.call(this,a),$gameTroop.select(this.enemy())},Window_BattleSkill.prototype=Object.create(Window_SkillList.prototype),Window_BattleSkill.prototype.constructor=Window_BattleSkill,Window_BattleSkill.prototype.initialize=function(a,b,c,d){Window_SkillList.prototype.initialize.call(this,a,b,c,d),this.hide()},Window_BattleSkill.prototype.show=function(){this.selectLast(),this.showHelpWindow(),Window_SkillList.prototype.show.call(this)},Window_BattleSkill.prototype.hide=function(){this.hideHelpWindow(),Window_SkillList.prototype.hide.call(this)},Window_BattleItem.prototype=Object.create(Window_ItemList.prototype),Window_BattleItem.prototype.constructor=Window_BattleItem,Window_BattleItem.prototype.initialize=function(a,b,c,d){Window_ItemList.prototype.initialize.call(this,a,b,c,d),this.hide()},Window_BattleItem.prototype.includes=function(a){return $gameParty.canUse(a)},Window_BattleItem.prototype.show=function(){this.selectLast(),this.showHelpWindow(),Window_ItemList.prototype.show.call(this)},Window_BattleItem.prototype.hide=function(){this.hideHelpWindow(),Window_ItemList.prototype.hide.call(this)},Window_TitleCommand.prototype=Object.create(Window_Command.prototype),Window_TitleCommand.prototype.constructor=Window_TitleCommand,Window_TitleCommand.prototype.initialize=function(){Window_Command.prototype.initialize.call(this,0,0),this.updatePlacement(),this.openness=0,this.selectLast()},Window_TitleCommand._lastCommandSymbol=null,Window_TitleCommand.initCommandPosition=function(){this._lastCommandSymbol=null},Window_TitleCommand.prototype.windowWidth=function(){return 240},Window_TitleCommand.prototype.updatePlacement=function(){this.x=(Graphics.boxWidth-this.width)/2,this.y=Graphics.boxHeight-this.height-96},Window_TitleCommand.prototype.makeCommandList=function(){this.addCommand(TextManager.newGame,"newGame"),this.addCommand(TextManager.continue_,"continue",this.isContinueEnabled()),this.addCommand(TextManager.options,"options")},Window_TitleCommand.prototype.isContinueEnabled=function(){return DataManager.isAnySavefileExists()},Window_TitleCommand.prototype.processOk=function(){Window_TitleCommand._lastCommandSymbol=this.currentSymbol(),Window_Command.prototype.processOk.call(this)},Window_TitleCommand.prototype.selectLast=function(){Window_TitleCommand._lastCommandSymbol?this.selectSymbol(Window_TitleCommand._lastCommandSymbol):this.isContinueEnabled()&&this.selectSymbol("continue")},Window_GameEnd.prototype=Object.create(Window_Command.prototype),Window_GameEnd.prototype.constructor=Window_GameEnd,Window_GameEnd.prototype.initialize=function(){Window_Command.prototype.initialize.call(this,0,0),this.updatePlacement(),this.openness=0,this.open()},Window_GameEnd.prototype.windowWidth=function(){return 240},Window_GameEnd.prototype.updatePlacement=function(){this.x=(Graphics.boxWidth-this.width)/2,this.y=(Graphics.boxHeight-this.height)/2},Window_GameEnd.prototype.makeCommandList=function(){this.addCommand(TextManager.toTitle,"toTitle"),this.addCommand(TextManager.cancel,"cancel")},Window_DebugRange.prototype=Object.create(Window_Selectable.prototype),Window_DebugRange.prototype.constructor=Window_DebugRange,Window_DebugRange.lastTopRow=0,Window_DebugRange.lastIndex=0,Window_DebugRange.prototype.initialize=function(a,b){this._maxSwitches=Math.ceil(($dataSystem.switches.length-1)/10),this._maxVariables=Math.ceil(($dataSystem.variables.length-1)/10);var c=this.windowWidth(),d=this.windowHeight();Window_Selectable.prototype.initialize.call(this,a,b,c,d),this.refresh(),this.setTopRow(Window_DebugRange.lastTopRow),this.select(Window_DebugRange.lastIndex),this.activate()},Window_DebugRange.prototype.windowWidth=function(){return 246},Window_DebugRange.prototype.windowHeight=function(){return Graphics.boxHeight},Window_DebugRange.prototype.maxItems=function(){return this._maxSwitches+this._maxVariables},Window_DebugRange.prototype.update=function(){Window_Selectable.prototype.update.call(this),this._editWindow&&(this._editWindow.setMode(this.mode()),this._editWindow.setTopId(this.topId()))},Window_DebugRange.prototype.mode=function(){return this.index()<this._maxSwitches?"switch":"variable"},Window_DebugRange.prototype.topId=function(){var a=this.index();return a<this._maxSwitches?10*a+1:10*(a-this._maxSwitches)+1},Window_DebugRange.prototype.refresh=function(){this.createContents(),this.drawAllItems()},Window_DebugRange.prototype.drawItem=function(a){var b,c,d=this.itemRectForText(a);a<this._maxSwitches?(b=10*a+1,c="S"):(b=10*(a-this._maxSwitches)+1,c="V");var e=b+9;c+=" ["+b.padZero(4)+"-"+e.padZero(4)+"]",this.drawText(c,d.x,d.y,d.width)},Window_DebugRange.prototype.isCancelTriggered=function(){return Window_Selectable.prototype.isCancelTriggered()||Input.isTriggered("debug")},Window_DebugRange.prototype.processCancel=function(){Window_Selectable.prototype.processCancel.call(this),Window_DebugRange.lastTopRow=this.topRow(),Window_DebugRange.lastIndex=this.index()},Window_DebugRange.prototype.setEditWindow=function(a){this._editWindow=a,this.update()},Window_DebugEdit.prototype=Object.create(Window_Selectable.prototype),Window_DebugEdit.prototype.constructor=Window_DebugEdit,Window_DebugEdit.prototype.initialize=function(a,b,c){var d=this.fittingHeight(10);Window_Selectable.prototype.initialize.call(this,a,b,c,d),this._mode="switch",this._topId=1,this.refresh()},Window_DebugEdit.prototype.maxItems=function(){return 10},Window_DebugEdit.prototype.refresh=function(){this.contents.clear(),this.drawAllItems()},Window_DebugEdit.prototype.drawItem=function(a){var b=this._topId+a,c=b.padZero(4)+":",d=this.textWidth(c),e=this.textWidth("-00000000"),f=this.itemName(b),g=this.itemStatus(b),h=this.itemRectForText(a);this.resetTextColor(),this.drawText(c,h.x,h.y,h.width),h.x+=d,h.width-=d+e,this.drawText(f,h.x,h.y,h.width),this.drawText(g,h.x+h.width,h.y,e,"right")},Window_DebugEdit.prototype.itemName=function(a){return"switch"===this._mode?$dataSystem.switches[a]:$dataSystem.variables[a]},Window_DebugEdit.prototype.itemStatus=function(a){return"switch"===this._mode?$gameSwitches.value(a)?"[ON]":"[OFF]":String($gameVariables.value(a))},Window_DebugEdit.prototype.setMode=function(a){this._mode!==a&&(this._mode=a,this.refresh())},Window_DebugEdit.prototype.setTopId=function(a){this._topId!==a&&(this._topId=a,this.refresh())},Window_DebugEdit.prototype.currentId=function(){return this._topId+this.index()},Window_DebugEdit.prototype.update=function(){Window_Selectable.prototype.update.call(this),this.active&&("switch"===this._mode?this.updateSwitch():this.updateVariable())},Window_DebugEdit.prototype.updateSwitch=function(){if(Input.isRepeated("ok")){var a=this.currentId();SoundManager.playCursor(),$gameSwitches.setValue(a,!$gameSwitches.value(a)),this.redrawCurrentItem()}},Window_DebugEdit.prototype.updateVariable=function(){var a=this.currentId(),b=$gameVariables.value(a);"number"==typeof b&&(Input.isRepeated("right")&&b++,Input.isRepeated("left")&&b--,Input.isRepeated("pagedown")&&(b+=10),Input.isRepeated("pageup")&&(b-=10),$gameVariables.value(a)!==b&&($gameVariables.setValue(a,b),SoundManager.playCursor(),this.redrawCurrentItem()))};